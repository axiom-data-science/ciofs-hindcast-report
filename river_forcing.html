

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Example for why I am rolling-mean the gage data &#8212; CIOFS Hindcast Report</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'river_forcing';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="river_forcing_make_files.html">Make monthly river forcing files for 1998â€“2018</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/axiom-data-science/ciofs-hindcast-report" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/axiom-data-science/ciofs-hindcast-report/issues/new?title=Issue%20on%20page%20%2Friver_forcing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/river_forcing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Example for why I am rolling-mean the gage data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Example for why I am rolling-mean the gage data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-with-river-files">Compare with river files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#make-example-forcing-file-for-chang">Make example forcing file for Chang</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#make-monthly-forcing-files-for-1998-and-check-them">Make monthly forcing files for 1998 and check them</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrate-using-the-rating-curve">Demonstrate using the rating curve</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-two-nonzero-rivers-later-check-the-zero-rivers-too">Check the two nonzero rivers (later check the zero rivers too)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#see-if-i-can-match-the-operational-rivers-file-example-we-have">See if I can match the operational rivers file example we have</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-existing-rivers-file-to-use">Read in existing rivers file to use</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-river-data-from-usgs">Get river data from USGS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-fill-in-missing-station-data">How to fill in missing station data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">15266300</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">15239070</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">15276000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">15290000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">15281000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">15271000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">15274600</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">15292780</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-often-is-gage-data-available-but-not-discharge-data">How often is gage data available but not discharge data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#look-at-other-river-forcing-example-file-to-make-sure-assumptions-hold-up">Look at other river forcing example file to make sure assumptions hold up</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dataretrieval.nwis</span> <span class="k">as</span> <span class="nn">nwis</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">create_river_roms</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># start = &quot;2013-01-1T00:00Z&quot;</span>
<span class="c1"># end = &quot;2013-12-31T00:00Z&quot;</span>

<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2022-12-14T18:00Z&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-12-18T01:00Z&#39;</span>


<span class="c1"># discharge stations</span>
<span class="n">stations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;15276000&#39;</span><span class="p">,</span> <span class="s1">&#39;15290000&#39;</span><span class="p">,</span> <span class="s1">&#39;15271000&#39;</span><span class="p">,</span> <span class="s1">&#39;15239900&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15295700&#39;</span><span class="p">,</span>
            <span class="s1">&#39;15239070&#39;</span><span class="p">,</span> <span class="s1">&#39;15275100&#39;</span><span class="p">,</span> <span class="s1">&#39;15266300&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15292000&#39;</span><span class="p">,</span> <span class="s1">&#39;15274600&#39;</span><span class="p">]</span>

<span class="n">station_discharge</span><span class="p">,</span> <span class="n">station_temp</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="c1"># for station in temp_stations.values():</span>
<span class="c1">#     print(station)</span>
<span class="c1">#     station_temp[station] = find_temp(station, start, end)</span>

<span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">discharge_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15276000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15290000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15271000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15239900
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15281000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15295700
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15239070
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15275100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15266300
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15284000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15292000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15274600
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">discharge_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x11d1eb0d0&gt;
</pre></div>
</div>
<img alt="_images/09cb7ba373e0864613ed31ce17087d0ef0f9addd57ba5c73c5f840d55f904e94.png" src="_images/09cb7ba373e0864613ed31ce17087d0ef0f9addd57ba5c73c5f840d55f904e94.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;1998-11-1T18:00Z&#39;</span><span class="p">,</span> <span class="s1">&#39;1998-12-1T01:00Z&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15271000&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/32e1a1e4f5b93df4776289e3ee10f92719f5a51945bbe94257f98553fbbd15cf.png" src="_images/32e1a1e4f5b93df4776289e3ee10f92719f5a51945bbe94257f98553fbbd15cf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;1998-11-1T18:00Z&#39;</span><span class="p">,</span> <span class="s1">&#39;1998-12-1T01:00Z&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15271000&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/aacc1c18b1dcaba0a7141de6b44517c3c616a2e9ff6fe629da11dbb553a1a423.png" src="_images/aacc1c18b1dcaba0a7141de6b44517c3c616a2e9ff6fe629da11dbb553a1a423.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Series([], Freq: H, Name: 00060, dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">temp_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">station_temp</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">temp_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">station_temp</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="ne">KeyError</span>: &#39;15276000&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">temp_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">station_temp</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe2354b6130&gt;
</pre></div>
</div>
<img alt="_images/2cfeaa286fd061e1d24fb0e18ec074baa3f6f3f982e7fc02aa3de1f5c888feab.png" src="_images/2cfeaa286fd061e1d24fb0e18ec074baa3f6f3f982e7fc02aa3de1f5c888feab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1998-1-1T01:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;1998-12-31T23:00Z&quot;</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15266300&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fill over 8 days with function
calculating mean time series
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1998-01-01 01:00:00    57.151683
1998-01-01 02:00:00    57.151683
1998-01-01 03:00:00    57.151683
1998-01-01 04:00:00    57.151683
1998-01-01 05:00:00    57.151683
                         ...    
1998-12-31 19:00:00    59.362692
1998-12-31 20:00:00    59.362692
1998-12-31 21:00:00    59.362692
1998-12-31 22:00:00    59.362692
1998-12-31 23:00:00    59.362692
Freq: H, Name: 00060, Length: 8759, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_temp</span><span class="p">[</span><span class="s2">&quot;15292780&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/965e446e78c13d736f731ae9bb852b30af259b872fa48bbdd5e0160f69787e73.png" src="_images/965e446e78c13d736f731ae9bb852b30af259b872fa48bbdd5e0160f69787e73.png" />
</div>
</div>
<p>tests</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1998-11-1T00:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;1998-12-31T00:00Z&quot;</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15266300&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fill over 8 days with function
calculating mean time series
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/2059f45616325b8fabc64d625791388faa358ac1f6c4962b7abe4678a39e74f5.png" src="_images/2059f45616325b8fabc64d625791388faa358ac1f6c4962b7abe4678a39e74f5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1998-11-1T00:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;1998-12-31T00:00Z&quot;</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15266300&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fill over 8 days with function
calculating mean time series
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/a7c23747688a37d11895bd6a945b858423736649b12e19c1c6e642239f76629b.png" src="_images/a7c23747688a37d11895bd6a945b858423736649b12e19c1c6e642239f76629b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe28f92fdf0&gt;
</pre></div>
</div>
<img alt="_images/00843742ffc26bc7ae8f453d0d03290066bd3fc07d35e2cb9cdb2f8376a15a24.png" src="_images/00843742ffc26bc7ae8f453d0d03290066bd3fc07d35e2cb9cdb2f8376a15a24.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe274d61460&gt;
</pre></div>
</div>
<img alt="_images/1d7893ce9b795c47164477083c49bd3df8d321b81ac73c16086b5707ee05039c.png" src="_images/1d7893ce9b795c47164477083c49bd3df8d321b81ac73c16086b5707ee05039c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe274ed6a30&gt;
</pre></div>
</div>
<img alt="_images/2438feb8a63ee6eaff924d3c7759467bf405ca3d6c6f1ffda806bd451ccfbe4a.png" src="_images/2438feb8a63ee6eaff924d3c7759467bf405ca3d6c6f1ffda806bd451ccfbe4a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe3a4c8ffa0&gt;
</pre></div>
</div>
<img alt="_images/7fda2bc3adbf3ccc37fce067e09302280b1cdef5fa378ad5abaf0c9368ddd132.png" src="_images/7fda2bc3adbf3ccc37fce067e09302280b1cdef5fa378ad5abaf0c9368ddd132.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe2564aceb0&gt;
</pre></div>
</div>
<img alt="_images/e4ff2c21f350c7e02a1fa95276b355fbf95473ae26e5c6e1af98713b11ad5c97.png" src="_images/e4ff2c21f350c7e02a1fa95276b355fbf95473ae26e5c6e1af98713b11ad5c97.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe26f9e4c40&gt;
</pre></div>
</div>
<img alt="_images/aa9541b1efb730a62a330fea8b18957868ea07d802d5cbd9f7618124e3e55233.png" src="_images/aa9541b1efb730a62a330fea8b18957868ea07d802d5cbd9f7618124e3e55233.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">station</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe2f27c3850&gt;
</pre></div>
</div>
<img alt="_images/92358912fb078671b892a44e98dcc5fc6eee95aabc6c68b677e9ca59838a99bc.png" src="_images/92358912fb078671b892a44e98dcc5fc6eee95aabc6c68b677e9ca59838a99bc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># gage data used</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="s2">&quot;2009-11-1&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-4-15&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using gage data for station 15266300.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/e6623e5c13da7b4577ce3fba1c868c5930455412d25544388bf5ea374ba31adf.png" src="_images/e6623e5c13da7b4577ce3fba1c868c5930455412d25544388bf5ea374ba31adf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># no gage data used</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="s2">&quot;2009-11-1&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-4-15&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/280a954851960493df4c107260a87b2b50b2fc3aa46bff3ee9aa12289e8fc6b9.png" src="_images/280a954851960493df4c107260a87b2b50b2fc3aa46bff3ee9aa12289e8fc6b9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># after code changes counting consecutive nans</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="s2">&quot;2009-11-1&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-4-15&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using gage data for station 15266300.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/927911c14dc719d5b8cdbecb86ca215b58ee5a8fc7852c23d9dfff78603fe721.png" src="_images/927911c14dc719d5b8cdbecb86ca215b58ee5a8fc7852c23d9dfff78603fe721.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># after code changes counting consecutive nans</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="s2">&quot;2009-11-1&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-4-15&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using gage data for station 15266300.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/057b729436aa0db13a38c7954abfd1d5e834dfcc1de98b87fbe1d4284fb1e24a.png" src="_images/057b729436aa0db13a38c7954abfd1d5e834dfcc1de98b87fbe1d4284fb1e24a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2019-07-1T00:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-7-1T00:00Z&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/a47009344f9b52143eace1fe917fbff7f7b6357a15783c328e06443f9ed2b0fe.png" src="_images/a47009344f9b52143eace1fe917fbff7f7b6357a15783c328e06443f9ed2b0fe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># after code changes counting consecutive nans</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2019-07-1T00:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-7-1T00:00Z&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/960b7afc889c3ad82402860ffdb500be9190825672069918e39393eb870bc468.png" src="_images/960b7afc889c3ad82402860ffdb500be9190825672069918e39393eb870bc468.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">station_use</span> <span class="o">=</span> <span class="s2">&quot;15266300&quot;</span>
    <span class="n">data1</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station_use</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data1</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
        <span class="n">data1</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data2</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station_use</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
        <span class="n">data2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span><span class="n">data2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>    
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="c1"># import pdb; pdb.set_trace()</span>
    <span class="c1"># if data.index.dtype == &quot;O&quot;:</span>
    <span class="c1">#     data.index = pd.to_datetime(data.index, utc=True)</span>

    <span class="c1"># if data.empty:</span>
    <span class="c1">#     print(f&quot;Using stats for station {station}&quot;)</span>
    <span class="c1">#     # if data is not available at all (outside window of availability) use annual mean</span>
    <span class="c1">#     # Retrieve the statistics</span>
    <span class="c1">#     stats = nwis.get_stats(sites=station_use, parameterCd=&quot;00060&quot;, statReportType=&quot;daily&quot;, statTypeCd=&quot;mean&quot;)[0]</span>
    <span class="c1">#     dischargeh = repeat_years_return_range(stats[&quot;mean_va&quot;].values, start, end)</span>

    <span class="c1"># else:</span>
    <span class="c1">#     if &quot;00060&quot; not in data.columns:</span>
    <span class="c1">#         data[&quot;00060&quot;] = np.nan# pd.NA</span>
    <span class="c1">#     if &quot;00065&quot; not in data.columns:</span>
    <span class="c1">#         data[&quot;00065&quot;] = np.nan# pd.NA</span>
    <span class="c1">#     data = data[[&quot;00060&quot;, &quot;00065&quot;]]</span>

    <span class="c1">#     # catch all non-data values in data and make sure they are nans</span>
    <span class="c1">#     data[data == -999999.0] = np.nan# pd.NA</span>
    <span class="c1">#     # discharge is -26999.973 if iced</span>
    <span class="c1">#     data.loc[data[&quot;00060&quot;] + 26999.973 &lt; 1e-3, &quot;00060&quot;] = pd.NA</span>

    <span class="c1">#     # this will hold the final combined time series</span>
    <span class="c1">#     discharge_data = data[&quot;00060&quot;]</span>
        
    <span class="c1">#     # if some values are missing from discharge_data, try to fill in other ways</span>
    <span class="c1">#     if discharge_data.isnull().sum() &gt; 0:</span>

    <span class="c1">#         # try to use gage data instead, but need rating curve data to do so</span>
    <span class="c1">#         ratingDataOrig = nwis.get_ratings(site=station_use, file_type=&quot;exsa&quot;)[0]</span>

    <span class="c1">#         # create estimate using rating curve and gage height if discharge data not fully available</span>
    <span class="c1">#         if not ratingDataOrig.empty:</span>
                
    <span class="c1">#             print(f&quot;Using gage data for station {station}.&quot;)</span>
                
    <span class="c1">#             # see if rating curve needs to be extrapolated. Maybe have a warning to check the reasonableness of the</span>
    <span class="c1">#             # output in this case</span>
    <span class="c1">#             if data[&quot;00065&quot;].max() &gt; ratingDataOrig[&quot;INDEP&quot;].max():</span>
    <span class="c1">#                 print(f&quot;Extrapolating ratingData upward for station {station}.&quot;)</span>
    <span class="c1">#                 ratingData = extrapolate_rating_curve(ratingDataOrig, data[&quot;00065&quot;].max(), &quot;up&quot;)</span>
                    
    <span class="c1">#             else:</span>
    <span class="c1">#                 ratingData = ratingDataOrig</span>

    <span class="c1">#             if data[&quot;00065&quot;].min() &lt; ratingData[&quot;INDEP&quot;].min():</span>
    <span class="c1">#                 print(f&quot;Extrapolating ratingData downward for station {station}.&quot;)</span>

    <span class="c1">#                 ratingData2 = extrapolate_rating_curve(ratingData, data[&quot;00065&quot;].min(), &quot;down&quot;)</span>

    <span class="c1">#             else:</span>
    <span class="c1">#                 ratingData2 = ratingData</span>
    <span class="c1">#             # import pdb; pdb.set_trace()</span>
                
                    
    <span class="c1">#             # Do a little rolling mean to smooth the data â€” sometimes it&#39;s really jumpy</span>
    <span class="c1">#             data[&quot;00065&quot;] = data[&quot;00065&quot;].rolling(window=&quot;12H&quot;, center=True).mean()</span>

    <span class="c1">#             streamflow_estimate_for_gage_data = ratingData2.set_index(&quot;INDEP&quot;)[&quot;DEP&quot;].loc[data[&quot;00065&quot;][data[&quot;00065&quot;].notnull()].round(2)]</span>

    <span class="c1">#             # cap values more than twice the max measured discharge value</span>
    <span class="c1">#             # https://kacv.net/brad/nws/lesson7.html</span>
    <span class="c1">#             ind = streamflow_estimate_for_gage_data &gt; ratingDataOrig[&quot;DEP&quot;].max()*2</span>
    <span class="c1">#             streamflow_estimate_for_gage_data.loc[ind] = ratingDataOrig[&quot;DEP&quot;].max()*2</span>
                
    <span class="c1">#             # cap min values at 0</span>
    <span class="c1">#             ind = streamflow_estimate_for_gage_data &lt; 0</span>
    <span class="c1">#             streamflow_estimate_for_gage_data.loc[ind] = 0</span>

    <span class="c1">#             # combine. Use streamflow estimate anywhere discharge_data has nan&#39;s</span>
    <span class="c1">#             streamflow_estimate_for_gage_data.index = data[data[&quot;00065&quot;].notnull()].index</span>
    <span class="c1">#             discharge_data.loc[discharge_data.isnull()] = streamflow_estimate_for_gage_data.loc[discharge_data.isnull()]</span>

    <span class="c1">#     # convert any leftover nan&#39;s to 0</span>
    <span class="c1">#     discharge_data[discharge_data.isnull()] = 0.0</span>

    <span class="c1">#     # average to hourly</span>
    <span class="c1">#     dischargeh = discharge_data.groupby(pd.Grouper(freq=&#39;1H&#39;)).mean(&quot;numeric_only&quot;)</span>

    <span class="c1"># # convert from cubic feet per second to cubic meters per second</span>
    <span class="c1"># dischargeh *= 0.3048**3</span>

    <span class="c1"># # fill in nan&#39;s if less than 2 days</span>
    <span class="c1"># dischargeh = dischargeh.interpolate(method=&quot;ffill&quot;, limit=2*24)</span>

    <span class="c1"># # If there are still nan&#39;s, fill with 0s</span>
    <span class="c1"># dischargeh = dischargeh.fillna(0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">end</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;15T&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">na_groups</span><span class="p">,</span> <span class="n">lengths_consecutive_na</span><span class="p">,</span> <span class="n">times_consecutive_na</span> <span class="o">=</span> <span class="n">find_na_groups</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # characterize groups of consecutive nans</span>
<span class="c1"># na_groups, lengths_consecutive_na, times_consecutive_na = find_na_groups(data[&quot;00060&quot;])</span>

<span class="c1"># only interpolate if consecutive nan&#39;s less than 2 days</span>
<span class="k">if</span> <span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;2 days&quot;</span><span class="p">):</span>
    <span class="c1"># ind = times_consecutive_na.loc[na_groups] &lt;= pd.Timedelta(&quot;2 days&quot;)</span>
    <span class="c1"># na_groups[ind.values].index</span>
    
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">na_groups</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;2 days&quot;</span><span class="p">):</span>
            <span class="c1"># data[&quot;00060&quot;].loc[na_groups[na_groups == group].index]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">na_groups</span><span class="p">[</span><span class="n">na_groups</span> <span class="o">==</span> <span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/mf/by34w_vj643fb7dvt5skt7p40000gn/T/ipykernel_54677/1294057543.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data[&quot;00060&quot;].loc[ind] = data[&quot;00060&quot;].loc[ind].interpolate()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2009-07-01 00:00:00     9360.0
2009-07-01 00:15:00     9430.0
2009-07-01 00:30:00     9430.0
2009-07-01 00:45:00     9390.0
2009-07-01 01:00:00     9390.0
                        ...   
2010-06-30 23:00:00    11000.0
2010-06-30 23:15:00        NaN
2010-06-30 23:30:00        NaN
2010-06-30 23:45:00        NaN
2010-07-01 00:00:00        NaN
Freq: 15T, Name: 00060, Length: 35041, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2009-07-01 00:00:00        1
 2009-07-01 00:15:00        2
 2009-07-01 00:30:00        3
 2009-07-01 00:45:00        4
 2009-07-01 01:00:00        5
                        ...  
 2010-06-30 23:00:00    22941
 2010-06-30 23:15:00    22941
 2010-06-30 23:30:00    22941
 2010-06-30 23:45:00    22941
 2010-07-01 00:00:00    22941
 Freq: 15T, Name: 00060, Length: 35041, dtype: int64,
 2009-07-01 00:00:00    False
 2009-07-01 00:15:00    False
 2009-07-01 00:30:00    False
 2009-07-01 00:45:00    False
 2009-07-01 01:00:00    False
                        ...  
 2010-06-30 23:00:00    False
 2010-06-30 23:15:00     True
 2010-06-30 23:30:00     True
 2010-06-30 23:45:00     True
 2010-07-01 00:00:00     True
 Freq: 15T, Name: 00060, Length: 35041, dtype: bool)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12109
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12100
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind_wide</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()[</span><span class="n">ind_wide</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2009-10-05 23:45:00     9312
2009-10-06 00:00:00     9312
2009-10-06 00:15:00     9312
2009-10-06 00:30:00     9312
2009-10-06 00:45:00     9312
                       ...  
2010-06-30 23:00:00    22941
2010-06-30 23:15:00    22941
2010-06-30 23:30:00    22941
2010-06-30 23:45:00    22941
2010-07-01 00:00:00    22941
Name: 00060, Length: 12109, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_groups</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()[</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>  <span class="c1"># CAN I ADD HERE TO GET NEARBY VALUES?</span>
<span class="n">na_groups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2009-10-06 00:00:00     9312
2009-10-06 00:15:00     9312
2009-10-06 00:30:00     9312
2009-10-06 00:45:00     9312
2009-11-15 09:00:00    13184
                       ...  
2010-04-01 07:45:00    14240
2010-06-30 23:15:00    22941
2010-06-30 23:30:00    22941
2010-06-30 23:45:00    22941
2010-07-01 00:00:00    22941
Name: 00060, Length: 12100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_groups</span> <span class="o">==</span> <span class="n">group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2009-10-06 00:00:00    False
2009-10-06 00:15:00    False
2009-10-06 00:30:00    False
2009-10-06 00:45:00    False
2009-11-15 09:00:00    False
                       ...  
2010-04-01 07:45:00    False
2010-06-30 23:15:00     True
2010-06-30 23:30:00     True
2010-06-30 23:45:00     True
2010-07-01 00:00:00     True
Name: 00060, Length: 12100, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">na_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;2 days&quot;</span><span class="p">)</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">na_groups</span><span class="p">[</span><span class="n">na_groups</span> <span class="o">==</span> <span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="c1"># data[&quot;00060&quot;].loc[ind].interpolate()</span>
<span class="n">ind</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2010-06-30 23:15:00&#39;, &#39;2010-06-30 23:30:00&#39;,
               &#39;2010-06-30 23:45:00&#39;, &#39;2010-07-01 00:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(35037, 35040)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">istart</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">iend</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">istart</span><span class="p">:</span><span class="n">iend</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2010-06-30 23:00:00    11000.0
2010-06-30 23:15:00        NaN
2010-06-30 23:30:00        NaN
2010-06-30 23:45:00        NaN
2010-07-01 00:00:00        NaN
Freq: 15T, Name: 00060, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">na_groups</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;2 days&quot;</span><span class="p">)</span>
<span class="n">ind2</span> <span class="o">=</span> <span class="n">na_groups</span><span class="p">[</span><span class="n">ind</span><span class="o">.</span><span class="n">values</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/mf/by34w_vj643fb7dvt5skt7p40000gn/T/ipykernel_54677/607524901.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data[&quot;00060&quot;].loc[ind2] = data[&quot;00060&quot;].loc[ind2].interpolate()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind2</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2009-10-06 00:00:00&#39;, &#39;2009-10-06 00:15:00&#39;,
               &#39;2009-10-06 00:30:00&#39;, &#39;2009-10-06 00:45:00&#39;,
               &#39;2009-12-04 09:00:00&#39;, &#39;2009-12-04 09:15:00&#39;,
               &#39;2009-12-04 09:30:00&#39;, &#39;2009-12-04 09:45:00&#39;,
               &#39;2009-12-04 10:00:00&#39;, &#39;2009-12-04 10:15:00&#39;,
               &#39;2009-12-04 10:30:00&#39;, &#39;2009-12-04 10:45:00&#39;,
               &#39;2009-12-04 11:00:00&#39;, &#39;2009-12-04 11:15:00&#39;,
               &#39;2009-12-04 11:30:00&#39;, &#39;2009-12-04 11:45:00&#39;,
               &#39;2009-12-04 12:00:00&#39;, &#39;2009-12-04 12:15:00&#39;,
               &#39;2009-12-04 12:30:00&#39;, &#39;2009-12-04 12:45:00&#39;,
               &#39;2009-12-04 13:00:00&#39;, &#39;2009-12-04 13:15:00&#39;,
               &#39;2009-12-04 13:30:00&#39;, &#39;2009-12-04 13:45:00&#39;,
               &#39;2009-12-04 14:00:00&#39;, &#39;2009-12-04 14:15:00&#39;,
               &#39;2009-12-04 14:30:00&#39;, &#39;2009-12-04 14:45:00&#39;,
               &#39;2009-12-04 15:00:00&#39;, &#39;2009-12-04 15:15:00&#39;,
               &#39;2009-12-04 15:30:00&#39;, &#39;2009-12-04 15:45:00&#39;,
               &#39;2009-12-04 16:00:00&#39;, &#39;2009-12-04 16:15:00&#39;,
               &#39;2009-12-04 16:30:00&#39;, &#39;2009-12-04 16:45:00&#39;,
               &#39;2009-12-04 17:00:00&#39;, &#39;2009-12-04 17:15:00&#39;,
               &#39;2009-12-04 17:30:00&#39;, &#39;2009-12-04 17:45:00&#39;,
               &#39;2009-12-04 18:00:00&#39;, &#39;2009-12-04 18:15:00&#39;,
               &#39;2009-12-04 18:30:00&#39;, &#39;2009-12-04 18:45:00&#39;,
               &#39;2009-12-04 19:00:00&#39;, &#39;2009-12-04 19:15:00&#39;,
               &#39;2009-12-04 19:30:00&#39;, &#39;2009-12-04 19:45:00&#39;,
               &#39;2009-12-04 20:00:00&#39;, &#39;2009-12-04 20:15:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2009-12-4&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2009-12-04 09:00:00   NaN
2009-12-04 09:15:00   NaN
2009-12-04 09:30:00   NaN
2009-12-04 09:45:00   NaN
2009-12-04 10:00:00   NaN
2009-12-04 10:15:00   NaN
2009-12-04 10:30:00   NaN
2009-12-04 10:45:00   NaN
2009-12-04 11:00:00   NaN
2009-12-04 11:15:00   NaN
2009-12-04 11:30:00   NaN
2009-12-04 11:45:00   NaN
2009-12-04 12:00:00   NaN
2009-12-04 12:15:00   NaN
2009-12-04 12:30:00   NaN
2009-12-04 12:45:00   NaN
2009-12-04 13:00:00   NaN
2009-12-04 13:15:00   NaN
2009-12-04 13:30:00   NaN
2009-12-04 13:45:00   NaN
2009-12-04 14:00:00   NaN
2009-12-04 14:15:00   NaN
2009-12-04 14:30:00   NaN
2009-12-04 14:45:00   NaN
2009-12-04 15:00:00   NaN
2009-12-04 15:15:00   NaN
2009-12-04 15:30:00   NaN
2009-12-04 15:45:00   NaN
2009-12-04 16:00:00   NaN
2009-12-04 16:15:00   NaN
2009-12-04 16:30:00   NaN
2009-12-04 16:45:00   NaN
2009-12-04 17:00:00   NaN
2009-12-04 17:15:00   NaN
2009-12-04 17:30:00   NaN
2009-12-04 17:45:00   NaN
2009-12-04 18:00:00   NaN
2009-12-04 18:15:00   NaN
2009-12-04 18:30:00   NaN
2009-12-04 18:45:00   NaN
2009-12-04 19:00:00   NaN
2009-12-04 19:15:00   NaN
2009-12-04 19:30:00   NaN
2009-12-04 19:45:00   NaN
2009-12-04 20:00:00   NaN
2009-12-04 20:15:00   NaN
2009-12-04 20:30:00   NaN
2009-12-04 20:45:00   NaN
2009-12-04 21:00:00   NaN
2009-12-04 21:15:00   NaN
2009-12-04 21:30:00   NaN
2009-12-04 21:45:00   NaN
2009-12-04 22:00:00   NaN
2009-12-04 22:15:00   NaN
2009-12-04 22:30:00   NaN
2009-12-04 22:45:00   NaN
2009-12-04 23:00:00   NaN
2009-12-04 23:15:00   NaN
2009-12-04 23:30:00   NaN
2009-12-04 23:45:00   NaN
Name: 00060, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/e5e3e1df99cc7365e7bf24160e3006dcf75ca34f9499a0c5af4c268af2aed1d3.png" src="_images/e5e3e1df99cc7365e7bf24160e3006dcf75ca34f9499a0c5af4c268af2aed1d3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/e5e3e1df99cc7365e7bf24160e3006dcf75ca34f9499a0c5af4c268af2aed1d3.png" src="_images/e5e3e1df99cc7365e7bf24160e3006dcf75ca34f9499a0c5af4c268af2aed1d3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;0 days 01:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;2 days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">na_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;0 days 01:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">times_consecutive_na</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">na_groups</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;2 days&quot;</span><span class="p">)</span>
<span class="n">ind</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>00060
9312      True
9312      True
9312      True
9312      True
13184    False
         ...  
14240    False
22941     True
22941     True
22941     True
22941     True
Name: 00060, Length: 12100, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_groups</span><span class="p">[</span><span class="n">ind</span><span class="o">.</span><span class="n">values</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2009-10-06 00:00:00&#39;, &#39;2009-10-06 00:15:00&#39;,
               &#39;2009-10-06 00:30:00&#39;, &#39;2009-10-06 00:45:00&#39;,
               &#39;2009-12-04 09:00:00&#39;, &#39;2009-12-04 09:15:00&#39;,
               &#39;2009-12-04 09:30:00&#39;, &#39;2009-12-04 09:45:00&#39;,
               &#39;2009-12-04 10:00:00&#39;, &#39;2009-12-04 10:15:00&#39;,
               ...
               &#39;2009-12-06 07:30:00&#39;, &#39;2009-12-06 07:45:00&#39;,
               &#39;2009-12-06 08:00:00&#39;, &#39;2009-12-06 08:15:00&#39;,
               &#39;2009-12-06 08:30:00&#39;, &#39;2009-12-06 08:45:00&#39;,
               &#39;2010-06-30 23:15:00&#39;, &#39;2010-06-30 23:30:00&#39;,
               &#39;2010-06-30 23:45:00&#39;, &#39;2010-07-01 00:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=200, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_groups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2009-10-06 00:00:00     9312
2009-10-06 00:15:00     9312
2009-10-06 00:30:00     9312
2009-10-06 00:45:00     9312
2009-11-15 09:00:00    13184
                       ...  
2010-04-01 07:45:00    14240
2010-06-30 23:15:00    22941
2010-06-30 23:30:00    22941
2010-06-30 23:45:00    22941
2010-07-01 00:00:00    22941
Name: 00060, Length: 12100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_groups</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span><span class="c1">#.index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IndexingError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1951</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">na_groups</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span><span class="c1">#.index</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/indexing.py:1073,</span> in <span class="ni">_LocationIndexer.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1070</span> <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="ow">or</span> <span class="mi">0</span>
<span class="g g-Whitespace">   </span><span class="mi">1072</span> <span class="n">maybe_callable</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="n">apply_if_callable</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1073</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_axis</span><span class="p">(</span><span class="n">maybe_callable</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/indexing.py:1292,</span> in <span class="ni">_LocIndexer._getitem_axis</span><span class="nt">(self, key, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">1290</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slice_axis</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1291</span> <span class="k">elif</span> <span class="n">com</span><span class="o">.</span><span class="n">is_bool_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1292</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getbool_axis</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1293</span> <span class="k">elif</span> <span class="n">is_list_like_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1294</span> 
<span class="g g-Whitespace">   </span><span class="mi">1295</span>     <span class="c1"># an iterable multi-selection</span>
<span class="g g-Whitespace">   </span><span class="mi">1296</span>     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">)):</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/indexing.py:1091,</span> in <span class="ni">_LocationIndexer._getbool_axis</span><span class="nt">(self, key, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">1087</span> <span class="nd">@final</span>
<span class="g g-Whitespace">   </span><span class="mi">1088</span> <span class="k">def</span> <span class="nf">_getbool_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1089</span>     <span class="c1"># caller is responsible for ensuring non-None axis</span>
<span class="g g-Whitespace">   </span><span class="mi">1090</span>     <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1091</span>     <span class="n">key</span> <span class="o">=</span> <span class="n">check_bool_indexer</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1092</span>     <span class="n">inds</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1093</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_take_with_is_copy</span><span class="p">(</span><span class="n">inds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/indexing.py:2552,</span> in <span class="ni">check_bool_indexer</span><span class="nt">(index, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">2550</span> <span class="n">indexer</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_indexer_for</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2551</span> <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">indexer</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2552</span>     <span class="k">raise</span> <span class="n">IndexingError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2553</span>         <span class="s2">&quot;Unalignable boolean Series provided as &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2554</span>         <span class="s2">&quot;indexer (index of the boolean Series and of &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2555</span>         <span class="s2">&quot;the indexed object do not match).&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2556</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2558</span> <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indexer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2560</span> <span class="c1"># fall through for boolean</span>

<span class="ne">IndexingError</span>: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_groups</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime
2020-01-15 20:00:00    19092
2020-01-15 20:15:00    19092
2020-01-15 20:30:00    19092
2020-01-15 20:45:00    19092
2020-01-15 21:00:00    19092
2020-01-15 21:15:00    19092
2020-01-15 21:30:00    19092
2020-01-15 22:00:00    19093
2020-01-15 22:15:00    19093
2020-01-15 22:30:00    19093
2020-01-15 22:45:00    19093
2020-01-15 23:00:00    19093
2020-01-15 23:15:00    19093
2020-01-15 23:30:00    19093
2020-01-16 00:00:00    19094
Name: 00060, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lengths_consecutive_na</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>00060
19092    7
19093    7
19094    7
19095    7
19096    7
19097    7
19098    7
19099    7
19100    7
19101    7
Name: 00060, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lengths_consecutive_na</span><span class="o">*</span><span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>00060
19092   0 days 01:45:00
19093   0 days 01:45:00
19094   0 days 01:45:00
19095   0 days 01:45:00
19096   0 days 01:45:00
              ...      
23489   0 days 00:15:00
23557   0 days 00:45:00
23561   0 days 00:15:00
23568   0 days 00:15:00
24037   0 days 00:15:00
Name: 00060, Length: 511, dtype: timedelta64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;0 days 00:15:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020-2-20&quot;</span><span class="p">:</span><span class="s2">&quot;2020-3-10&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/94d426b0881e4abe968b3ddfcc00048e85e0185cebf820d2998d81c853a0fefd.png" src="_images/94d426b0881e4abe968b3ddfcc00048e85e0185cebf820d2998d81c853a0fefd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data1[&quot;00060&quot;].loc[&quot;2020-2-20&quot;:&quot;2020-3-10&quot;]#.plot(marker=&quot;.&quot;)</span>
<span class="n">data1</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020-3-1&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime
2020-03-01 00:30:00+00:00    1530.0
2020-03-01 02:30:00+00:00    1530.0
2020-03-01 04:30:00+00:00    1530.0
2020-03-01 06:30:00+00:00    1530.0
2020-03-01 08:30:00+00:00    1530.0
2020-03-01 10:30:00+00:00    1530.0
2020-03-01 12:30:00+00:00    1530.0
2020-03-01 14:30:00+00:00    1530.0
2020-03-01 16:30:00+00:00    1520.0
2020-03-01 18:30:00+00:00    1520.0
2020-03-01 20:30:00+00:00    1520.0
2020-03-01 22:30:00+00:00    1520.0
Name: 00060, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s2">&quot;2022-1-1T00:15&quot;</span><span class="p">,</span><span class="s2">&quot;2022-1-1T00:45&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;15T&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py:1008,</span> in <span class="ni">DatetimeLikeArrayMixin._validate_frequency</span><span class="nt">(cls, index, freq, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1007</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">asi8</span><span class="p">,</span> <span class="n">on_freq</span><span class="o">.</span><span class="n">asi8</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1008</span>         <span class="k">raise</span> <span class="ne">ValueError</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span> <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="ne">ValueError</span>: 

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1873</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s2">&quot;2022-1-1T00:15&quot;</span><span class="p">,</span><span class="s2">&quot;2022-1-1T00:45&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;15T&quot;</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/indexes/extension.py:81,</span> in <span class="ni">_inherit_from_data.&lt;locals&gt;.fset</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="k">def</span> <span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">81</span>     <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py:937,</span> in <span class="ni">DatetimeLikeArrayMixin.freq</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">value</span> <span class="o">=</span> <span class="n">to_offset</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">937</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_validate_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">939</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">940</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set freq with ndim &gt; 1&quot;</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py:1019,</span> in <span class="ni">DatetimeLikeArrayMixin._validate_frequency</span><span class="nt">(cls, index, freq, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span>     <span class="k">raise</span> <span class="n">e</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span> <span class="c1"># GH#11587 the main way this is reached is if the `np.array_equal`</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span> <span class="c1">#  check above is False.  This can also be reached if index[0]</span>
<span class="g g-Whitespace">   </span><span class="mi">1016</span> <span class="c1">#  is `NaT`, in which case the call to `cls._generate_range` will</span>
<span class="g g-Whitespace">   </span><span class="mi">1017</span> <span class="c1">#  raise a ValueError, which we re-raise with a more targeted</span>
<span class="g g-Whitespace">   </span><span class="mi">1018</span> <span class="c1">#  message.</span>
<span class="ne">-&gt; </span><span class="mi">1019</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1020</span>     <span class="sa">f</span><span class="s2">&quot;Inferred frequency </span><span class="si">{</span><span class="n">inferred</span><span class="si">}</span><span class="s2"> from passed values &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1021</span>     <span class="sa">f</span><span class="s2">&quot;does not conform to passed frequency </span><span class="si">{</span><span class="n">freq</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span> <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

<span class="ne">ValueError</span>: Inferred frequency None from passed values does not conform to passed frequency 15T
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;15T&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py:1008,</span> in <span class="ni">DatetimeLikeArrayMixin._validate_frequency</span><span class="nt">(cls, index, freq, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1007</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">asi8</span><span class="p">,</span> <span class="n">on_freq</span><span class="o">.</span><span class="n">asi8</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1008</span>         <span class="k">raise</span> <span class="ne">ValueError</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span> <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="ne">ValueError</span>: 

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1866</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;15T&quot;</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/indexes/extension.py:81,</span> in <span class="ni">_inherit_from_data.&lt;locals&gt;.fset</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="k">def</span> <span class="nf">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">81</span>     <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py:937,</span> in <span class="ni">DatetimeLikeArrayMixin.freq</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">value</span> <span class="o">=</span> <span class="n">to_offset</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">937</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_validate_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">939</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">940</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set freq with ndim &gt; 1&quot;</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py:1019,</span> in <span class="ni">DatetimeLikeArrayMixin._validate_frequency</span><span class="nt">(cls, index, freq, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span>     <span class="k">raise</span> <span class="n">e</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span> <span class="c1"># GH#11587 the main way this is reached is if the `np.array_equal`</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span> <span class="c1">#  check above is False.  This can also be reached if index[0]</span>
<span class="g g-Whitespace">   </span><span class="mi">1016</span> <span class="c1">#  is `NaT`, in which case the call to `cls._generate_range` will</span>
<span class="g g-Whitespace">   </span><span class="mi">1017</span> <span class="c1">#  raise a ValueError, which we re-raise with a more targeted</span>
<span class="g g-Whitespace">   </span><span class="mi">1018</span> <span class="c1">#  message.</span>
<span class="ne">-&gt; </span><span class="mi">1019</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1020</span>     <span class="sa">f</span><span class="s2">&quot;Inferred frequency </span><span class="si">{</span><span class="n">inferred</span><span class="si">}</span><span class="s2"> from passed values &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1021</span>     <span class="sa">f</span><span class="s2">&quot;does not conform to passed frequency </span><span class="si">{</span><span class="n">freq</span><span class="o">.</span><span class="n">freqstr</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span> <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

<span class="ne">ValueError</span>: Inferred frequency None from passed values does not conform to passed frequency 15T
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge_data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/50e2f007c9ba670a108817c27f9a4a6d5db2fa6798ccf032058a064687089890.png" src="_images/50e2f007c9ba670a108817c27f9a4a6d5db2fa6798ccf032058a064687089890.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15284000&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-7-1&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-7-31&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/463719cab29705904b014d8602c636ef774fe1f812c1a5d086b2f43fc6e9a933.png" src="_images/463719cab29705904b014d8602c636ef774fe1f812c1a5d086b2f43fc6e9a933.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="s2">&quot;15284000&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-7-1&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-7-31&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/841658f0287de7ff3596f1295490b99e7a384971fb0989359fc237a86d828f98.png" src="_images/841658f0287de7ff3596f1295490b99e7a384971fb0989359fc237a86d828f98.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2000-7-10&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/dad9af6400e20cdad2557f55fae54ca4222270ea0e5163cc643cff12aae948f7.png" src="_images/dad9af6400e20cdad2557f55fae54ca4222270ea0e5163cc643cff12aae948f7.png" />
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="example-for-why-i-am-rolling-mean-the-gage-data">
<h1>Example for why I am rolling-mean the gage data<a class="headerlink" href="#example-for-why-i-am-rolling-mean-the-gage-data" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2010-12-1T00:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2011-2-1T00:00Z&quot;</span>

<span class="n">station_discharge</span><span class="p">,</span> <span class="n">station_temp</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    <span class="c1"># station_temp[station] = find_temp(station, start, end)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15276000
Using gage data for station 15276000.
Extrapolating ratingData upward for station 15276000.
15290000
Using gage data for station 15290000.
15271000
Using gage data for station 15271000.
15239900
Using stats for station 15239900
15281000
Using stats for station 15281000
15295700
Using gage data for station 15295700.
15239070
Using gage data for station 15239070.
15275100
Using gage data for station 15275100.
Extrapolating ratingData downward for station 15275100.
min data value: 1.6, min INDEP value is 1.75
15266300
Using gage data for station 15266300.
15284000
Using gage data for station 15284000.
15292780
Using stats for station 15292780
15274600
Using gage data for station 15274600.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15276000
15290000
15271000
15239900
15281000
15295700
15239070
15275100
15266300
15284000
15292780
15274600
</pre></div>
</div>
<img alt="_images/503132d149e7b85f063a00fb107b75144553a9ebb2a1ffd48ba54761b390d1ac.png" src="_images/503132d149e7b85f063a00fb107b75144553a9ebb2a1ffd48ba54761b390d1ac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15276000
15290000
15271000
15239900
15281000
15295700
15239070
15275100
15266300
15284000
15292780
15274600
</pre></div>
</div>
<img alt="_images/4c6047b5cd51e52105c4fa6e1a1389df6652d66b7272d9dd38a4aaa1c0899ed8.png" src="_images/4c6047b5cd51e52105c4fa6e1a1389df6652d66b7272d9dd38a4aaa1c0899ed8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15276000
15290000
15271000
15239900
15281000
15295700
15239070
15275100
15266300
15284000
15292780
15274600
</pre></div>
</div>
<img alt="_images/369c1053750688ab031eaa4020a60b4026590be004535bf9280a15dbca506082.png" src="_images/369c1053750688ab031eaa4020a60b4026590be004535bf9280a15dbca506082.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="compare-with-river-files">
<h1>Compare with river files<a class="headerlink" href="#compare-with-river-files" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># found these by visual inspection of the `river_transport` variable which has negative signs on the</span>
<span class="c1"># 0s so I could read them off there.</span>
<span class="n">river_sign</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> 
              <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
              <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
              <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">stations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;15276000&#39;</span><span class="p">,</span> <span class="s1">&#39;15290000&#39;</span><span class="p">,</span> <span class="s1">&#39;15271000&#39;</span><span class="p">,</span> <span class="s1">&#39;15239900&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15295700&#39;</span><span class="p">,</span>
            <span class="s1">&#39;15239070&#39;</span><span class="p">,</span> <span class="s1">&#39;15275100&#39;</span><span class="p">,</span> <span class="s1">&#39;15266300&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15292780&#39;</span><span class="p">,</span> <span class="s1">&#39;15274600&#39;</span><span class="p">]</span>

<span class="n">station_list_file</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;15295700&#39;</span><span class="p">,</span> <span class="s1">&#39;15239070&#39;</span><span class="p">,</span> <span class="s1">&#39;15239900&#39;</span><span class="p">,</span> <span class="s1">&#39;15266300&#39;</span><span class="p">,</span> <span class="s1">&#39;15266300&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;15271000&#39;</span><span class="p">,</span> <span class="s1">&#39;15274600&#39;</span><span class="p">,</span> <span class="s1">&#39;15275100&#39;</span><span class="p">,</span> <span class="s1">&#39;15276000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15281000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">,</span> <span class="s1">&#39;15290000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;15290000&#39;</span><span class="p">,</span> <span class="s1">&#39;15292780&#39;</span><span class="p">,</span> <span class="s1">&#39;15292780&#39;</span><span class="p">,</span> <span class="s1">&#39;15292780&#39;</span><span class="p">,</span> <span class="s1">&#39;15292780&#39;</span><span class="p">,</span> <span class="s1">&#39;15292780&#39;</span><span class="p">]</span>

<span class="c1"># station &quot;in model&quot;: station actually used</span>
<span class="n">discharge_stations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;15276000&#39;</span><span class="p">:</span> <span class="s2">&quot;15276000&quot;</span><span class="p">,</span> <span class="s1">&#39;15290000&#39;</span><span class="p">:</span> <span class="s2">&quot;15290000&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15271000&#39;</span><span class="p">:</span> <span class="s2">&quot;15271000&quot;</span><span class="p">,</span> <span class="s1">&#39;15239900&#39;</span><span class="p">:</span> <span class="s2">&quot;15239900&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15281000&#39;</span><span class="p">:</span> <span class="s2">&quot;15281000&quot;</span><span class="p">,</span> <span class="s1">&#39;15295700&#39;</span><span class="p">:</span> <span class="s2">&quot;15295700&quot;</span><span class="p">,</span>
                      <span class="s1">&#39;15239070&#39;</span><span class="p">:</span> <span class="s2">&quot;15239070&quot;</span><span class="p">,</span> <span class="s1">&#39;15275100&#39;</span><span class="p">:</span> <span class="s2">&quot;15275100&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15266300&#39;</span><span class="p">:</span> <span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">:</span> <span class="s2">&quot;15284000&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15292780&#39;</span><span class="p">:</span> <span class="s2">&quot;15292000&quot;</span><span class="p">,</span> <span class="s1">&#39;15274600&#39;</span><span class="p">:</span> <span class="s2">&quot;15274600&quot;</span><span class="p">}</span>

<span class="c1"># station &quot;in model&quot;: station actually used</span>
<span class="n">temp_stations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;15276000&#39;</span><span class="p">:</span> <span class="s2">&quot;15276000&quot;</span><span class="p">,</span> <span class="s1">&#39;15290000&#39;</span><span class="p">:</span> <span class="s2">&quot;15290000&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15271000&#39;</span><span class="p">:</span> <span class="s2">&quot;15258000&quot;</span><span class="p">,</span> <span class="s1">&#39;15239900&#39;</span><span class="p">:</span> <span class="s2">&quot;15239900&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15281000&#39;</span><span class="p">:</span> <span class="s2">&quot;15284000&quot;</span><span class="p">,</span> <span class="s1">&#39;15295700&#39;</span><span class="p">:</span> <span class="s2">&quot;15295700&quot;</span><span class="p">,</span>
                      <span class="s1">&#39;15239070&#39;</span><span class="p">:</span> <span class="s2">&quot;15239070&quot;</span><span class="p">,</span> <span class="s1">&#39;15275100&#39;</span><span class="p">:</span> <span class="s2">&quot;15276000&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15266300&#39;</span><span class="p">:</span> <span class="s2">&quot;15266300&quot;</span><span class="p">,</span> <span class="s1">&#39;15284000&#39;</span><span class="p">:</span> <span class="s2">&quot;15284000&quot;</span><span class="p">,</span> 
                      <span class="s1">&#39;15292780&#39;</span><span class="p">:</span> <span class="s2">&quot;15292780&quot;</span><span class="p">,</span> <span class="s1">&#39;15274600&#39;</span><span class="p">:</span> <span class="s2">&quot;15276000&quot;</span><span class="p">}</span>

<span class="n">nsrho</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># number depths</span>
<span class="n">nrivers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_river_forcing_file</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">skip_last</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
    <span class="c1"># create arrays to input in the netcdf files</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">end</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1H&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">skip_last</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()[:</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># get river data for the time period</span>
    <span class="n">station_discharge</span><span class="p">,</span> <span class="n">station_temp</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">discharge_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">temp_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">station_temp</span><span class="p">[</span><span class="n">station</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_temp</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span>

    <span class="n">river_transport</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ntimes</span><span class="p">,</span> <span class="n">nrivers</span><span class="p">))</span>
    <span class="n">river_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ntimes</span><span class="p">,</span> <span class="n">nsrho</span><span class="p">,</span> <span class="n">nrivers</span><span class="p">))</span>

    <span class="c1"># stations are repeated in a certain order in station_list_file</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">station_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">discharge_stations</span><span class="p">[</span><span class="n">station_file</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;15292780&quot;</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">nrepeats</span> <span class="o">=</span> <span class="n">station_list_file</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">station_file</span><span class="p">)</span>
        <span class="n">river_transport</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="n">river_sign</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">station_discharge</span><span class="p">[</span><span class="n">discharge_stations</span><span class="p">[</span><span class="n">station_file</span><span class="p">]]</span><span class="o">/</span><span class="n">nrepeats</span>
        <span class="n">river_temp</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">station_temp</span><span class="p">[</span><span class="n">temp_stations</span><span class="p">[</span><span class="n">station_file</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">nsrho</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># create netcdf files starting from the acquired data</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;nos.ciofs.river.20221216.t00z (1).nc&#39;</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    
    <span class="n">vars_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;river_names&quot;</span><span class="p">,</span> <span class="s2">&quot;river_Xposition&quot;</span><span class="p">,</span> <span class="s2">&quot;river_Eposition&quot;</span><span class="p">,</span> <span class="s2">&quot;river_direction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;river_flag&quot;</span><span class="p">,</span> <span class="s2">&quot;river_sign&quot;</span><span class="p">,</span> <span class="s2">&quot;river_Vshape&quot;</span><span class="p">]</span>
    <span class="n">dsnew</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">vars_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># add new variables that include time</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="s2">&quot;river&quot;</span><span class="p">),</span> <span class="n">river_transport</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="s2">&quot;s_rho&quot;</span><span class="p">,</span><span class="s2">&quot;river&quot;</span><span class="p">),</span> <span class="n">river_temp</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_salt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">],</span> <span class="mf">0.005</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_pass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">],</span> <span class="mf">9.96921e+36</span><span class="p">)</span>
    <span class="n">new_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">,</span> <span class="s2">&quot;river_transport&quot;</span><span class="p">,</span> <span class="s2">&quot;river_temp&quot;</span><span class="p">,</span> <span class="s2">&quot;river_salt&quot;</span><span class="p">,</span> <span class="s2">&quot;river_pass&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">new_vars</span><span class="p">:</span>
        <span class="n">dsnew</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    
    <span class="c1"># Update global attributes</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;data_source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;River discharge from USGS real time, estimated using gage height and rating curve, or from daily statistical mean.&quot;</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;Temp_source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;River T from USGS real time or daily statistical mean.&quot;</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;Salt_source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Always 0.005&quot;</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;institution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Axiom Data Science&quot;</span>
    <span class="n">now</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2">. Run using `dataretrieval-python` package and code from Axiom Data Science.&quot;</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;axiom.ciofs.river.%Y%m</span><span class="si">%d</span><span class="s2">.nc&quot;</span><span class="p">)</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;output_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;River Forcing file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;source_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Created using create_river_roms.py.&quot;</span>
    <span class="n">dsnew</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;reference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Created by Kristen M. Thyng, Axiom Data Science.&quot;</span>

    <span class="k">return</span> <span class="n">dsnew</span><span class="p">,</span> <span class="n">fname</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2008-11-1T00:00Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2008-11-7T00:00Z&quot;</span>


<span class="c1"># get river data for the time period</span>
<span class="n">station_discharge</span><span class="p">,</span> <span class="n">station_temp</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">discharge_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">station_discharge</span><span class="p">[</span><span class="n">station</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_discharge</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">temp_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">station_temp</span><span class="p">[</span><span class="n">station</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_temp</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    
<span class="c1"># create arrays to input in the netcdf files</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1H&quot;</span><span class="p">)</span>
<span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">nsrho</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">nrivers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">)</span>

<span class="n">river_transport</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ntimes</span><span class="p">,</span> <span class="n">nrivers</span><span class="p">))</span>
<span class="n">river_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ntimes</span><span class="p">,</span> <span class="n">nsrho</span><span class="p">,</span> <span class="n">nrivers</span><span class="p">))</span>

<span class="c1"># stations are repeated in a certain order in station_list_file</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">station_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">):</span>
    <span class="n">nrepeats</span> <span class="o">=</span> <span class="n">station_list_file</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">station_file</span><span class="p">)</span>
    <span class="n">river_transport</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">river_sign</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">station_discharge</span><span class="p">[</span><span class="n">discharge_stations</span><span class="p">[</span><span class="n">station_file</span><span class="p">]]</span><span class="o">/</span><span class="n">nrepeats</span>
    <span class="n">river_temp</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">station_temp</span><span class="p">[</span><span class="n">temp_stations</span><span class="p">[</span><span class="n">station_file</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">nsrho</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="c1"># create netcdf files from the acquired data</span>
<span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;nos.ciofs.river.20221216.t00z (1).nc&#39;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using gage data for station 15276000.
Extrapolating ratingData upward for station 15276000.
max data value: 7.86, max INDEP value is 7.15
Using gage data for station 15290000.
Using gage data for station 15271000.
calculating mean time series
calculating mean time series
Using gage data for station 15284000.
calculating mean time series
Using gage data for station 15274600.
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vars_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;river_names&quot;</span><span class="p">,</span> <span class="s2">&quot;river_Xposition&quot;</span><span class="p">,</span> <span class="s2">&quot;river_Eposition&quot;</span><span class="p">,</span> <span class="s2">&quot;river_direction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;river_flag&quot;</span><span class="p">,</span> <span class="s2">&quot;river_sign&quot;</span><span class="p">,</span> <span class="s2">&quot;river_Vshape&quot;</span><span class="p">]</span>
<span class="n">dsnew</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">vars_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># add new variables that include time</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="s2">&quot;river&quot;</span><span class="p">),</span> <span class="n">river_transport</span><span class="p">)</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="s2">&quot;s_rho&quot;</span><span class="p">,</span><span class="s2">&quot;river&quot;</span><span class="p">),</span> <span class="n">river_temp</span><span class="p">)</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_salt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">],</span> <span class="mf">0.005</span><span class="p">)</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_pass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">],</span> <span class="mf">9.96921e+36</span><span class="p">)</span>
<span class="n">new_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">,</span> <span class="s2">&quot;river_transport&quot;</span><span class="p">,</span> <span class="s2">&quot;river_temp&quot;</span><span class="p">,</span> <span class="s2">&quot;river_salt&quot;</span><span class="p">,</span> <span class="s2">&quot;river_pass&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">new_vars</span><span class="p">:</span>
    <span class="n">dsnew</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
<span class="n">dsnew</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (river: 36, s_rho: 30, river_time: 145, time: 145)
Coordinates:
  * river            (river) int32 1 2 3 4 5 6 7 8 9 ... 29 30 31 32 33 34 35 36
  * river_time       (river_time) object 1225497600000000000 ... 122601600000...
Dimensions without coordinates: s_rho, time
Data variables:
    river_names      (river) |S46 ...
    river_Xposition  (river) int32 ...
    river_Eposition  (river) int32 ...
    river_direction  (river) int32 ...
    river_flag       (river) int32 ...
    river_sign       (river) float32 ...
    river_Vshape     (s_rho, river) float32 ...
    river_transport  (time, river) float32 -4.147 2.056 -5.991 ... 17.93 17.93
    river_temp       (time, s_rho, river) float32 3.584 2.477 1.353 ... 1.0 1.0
    river_salt       (time, s_rho, river) float32 0.005 0.005 ... 0.005 0.005
    river_pass       (time, s_rho, river) float32 9.969e+36 ... 9.969e+36
Attributes:
    type:             ROMS river forcing netCDF file
    title:            ciofs River forcing netCDF file
    data_source:      River discharge from USGS real time or daily mean
    Temp_source:      River T from USGS real time or daily mean, Salt=0
    model_grid_file:  GRID file: nos.ciofs.romsgrid.nc
    output_file:      River Forcing file: nos.ciofs.river.20221216.t00z.nc
    source_code:      Created using nos_ofs_create_river_ROMS.sh
    history:          Created at time 00:52  12/16/2022
    reference:        Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-88c9c0aa-630a-4444-b590-855040c4205c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-88c9c0aa-630a-4444-b590-855040c4205c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>river</span>: 36</li><li><span>s_rho</span>: 30</li><li><span class='xr-has-index'>river_time</span>: 145</li><li><span>time</span>: 145</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e5d90b70-3697-4167-90e9-7d6338bfc185' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e5d90b70-3697-4167-90e9-7d6338bfc185' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>river</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 31 32 33 34 35 36</div><input id='attrs-7c089e55-ce95-474a-b130-4d9cdc642f65' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c089e55-ce95-474a-b130-4d9cdc642f65' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b49bb12-f349-4ca9-a4b6-a1923af0dbca' class='xr-var-data-in' type='checkbox'><label for='data-5b49bb12-f349-4ca9-a4b6-a1923af0dbca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>river_time</span></div><div class='xr-var-dims'>(river_time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1225497600000000000 ... 12260160...</div><input id='attrs-ed8fc683-9398-4a1c-b184-73b76764f57c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ed8fc683-9398-4a1c-b184-73b76764f57c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-677c5b3d-63bc-428f-9117-c6149ca0216b' class='xr-var-data-in' type='checkbox'><label for='data-677c5b3d-63bc-428f-9117-c6149ca0216b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff time</dd><dt><span>field :</span></dt><dd>river_time, scalar, series</dd></dl></div><div class='xr-var-data'><pre>array([1225497600000000000, 1225501200000000000, 1225504800000000000,
       1225508400000000000, 1225512000000000000, 1225515600000000000,
       1225519200000000000, 1225522800000000000, 1225526400000000000,
       1225530000000000000, 1225533600000000000, 1225537200000000000,
       1225540800000000000, 1225544400000000000, 1225548000000000000,
       1225551600000000000, 1225555200000000000, 1225558800000000000,
       1225562400000000000, 1225566000000000000, 1225569600000000000,
       1225573200000000000, 1225576800000000000, 1225580400000000000,
       1225584000000000000, 1225587600000000000, 1225591200000000000,
       1225594800000000000, 1225598400000000000, 1225602000000000000,
       1225605600000000000, 1225609200000000000, 1225612800000000000,
       1225616400000000000, 1225620000000000000, 1225623600000000000,
       1225627200000000000, 1225630800000000000, 1225634400000000000,
       1225638000000000000, 1225641600000000000, 1225645200000000000,
       1225648800000000000, 1225652400000000000, 1225656000000000000,
       1225659600000000000, 1225663200000000000, 1225666800000000000,
       1225670400000000000, 1225674000000000000, 1225677600000000000,
       1225681200000000000, 1225684800000000000, 1225688400000000000,
       1225692000000000000, 1225695600000000000, 1225699200000000000,
       1225702800000000000, 1225706400000000000, 1225710000000000000,
       1225713600000000000, 1225717200000000000, 1225720800000000000,
       1225724400000000000, 1225728000000000000, 1225731600000000000,
       1225735200000000000, 1225738800000000000, 1225742400000000000,
       1225746000000000000, 1225749600000000000, 1225753200000000000,
       1225756800000000000, 1225760400000000000, 1225764000000000000,
       1225767600000000000, 1225771200000000000, 1225774800000000000,
       1225778400000000000, 1225782000000000000, 1225785600000000000,
       1225789200000000000, 1225792800000000000, 1225796400000000000,
       1225800000000000000, 1225803600000000000, 1225807200000000000,
       1225810800000000000, 1225814400000000000, 1225818000000000000,
       1225821600000000000, 1225825200000000000, 1225828800000000000,
       1225832400000000000, 1225836000000000000, 1225839600000000000,
       1225843200000000000, 1225846800000000000, 1225850400000000000,
       1225854000000000000, 1225857600000000000, 1225861200000000000,
       1225864800000000000, 1225868400000000000, 1225872000000000000,
       1225875600000000000, 1225879200000000000, 1225882800000000000,
       1225886400000000000, 1225890000000000000, 1225893600000000000,
       1225897200000000000, 1225900800000000000, 1225904400000000000,
       1225908000000000000, 1225911600000000000, 1225915200000000000,
       1225918800000000000, 1225922400000000000, 1225926000000000000,
       1225929600000000000, 1225933200000000000, 1225936800000000000,
       1225940400000000000, 1225944000000000000, 1225947600000000000,
       1225951200000000000, 1225954800000000000, 1225958400000000000,
       1225962000000000000, 1225965600000000000, 1225969200000000000,
       1225972800000000000, 1225976400000000000, 1225980000000000000,
       1225983600000000000, 1225987200000000000, 1225990800000000000,
       1225994400000000000, 1225998000000000000, 1226001600000000000,
       1226005200000000000, 1226008800000000000, 1226012400000000000,
       1226016000000000000], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-83088b99-4ed0-4e4b-bcad-34121ab4c80c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-83088b99-4ed0-4e4b-bcad-34121ab4c80c' class='xr-section-summary' >Data variables: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>river_names</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>|S46</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a49a77d2-84cb-4a27-bd77-b02108700e6f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a49a77d2-84cb-4a27-bd77-b02108700e6f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ea13add-6a69-4f4c-8e61-d4424f8fc586' class='xr-var-data-in' type='checkbox'><label for='data-2ea13add-6a69-4f4c-8e61-d4424f8fc586' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River Names</dd><dt><span>units :</span></dt><dd>char*46</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=|S46]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Xposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2642fc3e-9348-407a-8747-95936d788b9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2642fc3e-9348-407a-8747-95936d788b9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d213d8ba-d3de-4b44-8a55-bda8d17f9644' class='xr-var-data-in' type='checkbox'><label for='data-d213d8ba-d3de-4b44-8a55-bda8d17f9644' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river XI-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>723</dd><dt><span>field :</span></dt><dd>river_Xposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Eposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-14f8ba25-8dea-44d7-bfa9-9e80b26b1a59' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-14f8ba25-8dea-44d7-bfa9-9e80b26b1a59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-65b25155-f953-4f2b-8e19-e6b5d94fe5fa' class='xr-var-data-in' type='checkbox'><label for='data-65b25155-f953-4f2b-8e19-e6b5d94fe5fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river ETA-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>1043</dd><dt><span>field :</span></dt><dd>river_Eposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_direction</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1472af48-d753-4a79-82ee-c38a2d3122c5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1472af48-d753-4a79-82ee-c38a2d3122c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db28d3be-071c-458b-bd97-f6ff857b8f96' class='xr-var-data-in' type='checkbox'><label for='data-db28d3be-071c-458b-bd97-f6ff857b8f96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff direction</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_direction, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_flag</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-38308a10-3c77-4265-a52c-f8cf01aab8bd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38308a10-3c77-4265-a52c-f8cf01aab8bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-569096f4-bcd4-4abe-b512-98e708fba46e' class='xr-var-data-in' type='checkbox'><label for='data-569096f4-bcd4-4abe-b512-98e708fba46e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff tracer flag</dd><dt><span>option_0 :</span></dt><dd>all tracers are off</dd><dt><span>option_1 :</span></dt><dd>only temperature is on</dd><dt><span>option_2 :</span></dt><dd>only salinity is on</dd><dt><span>option_3 :</span></dt><dd>both temperature and salinity are on</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_flag, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_sign</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-00b79d32-c305-45b9-bdcc-44e6d3934892' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-00b79d32-c305-45b9-bdcc-44e6d3934892' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49c8ef6b-0316-4195-853b-223710153c1d' class='xr-var-data-in' type='checkbox'><label for='data-49c8ef6b-0316-4195-853b-223710153c1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River mass transport ambient sign</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_sign, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Vshape</span></div><div class='xr-var-dims'>(s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-20ae0ccb-2482-4cd9-a1b6-4f6c77ac76c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20ae0ccb-2482-4cd9-a1b6-4f6c77ac76c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b431e0a-c73c-4d14-922a-4d09afd7cf05' class='xr-var-data-in' type='checkbox'><label for='data-2b431e0a-c73c-4d14-922a-4d09afd7cf05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff mass transport vertical profile</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_Vshape, scalar</dd></dl></div><div class='xr-var-data'><pre>[1080 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_transport</span></div><div class='xr-var-dims'>(time, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-4.147 2.056 -5.991 ... 17.93 17.93</div><input id='attrs-36afdca5-f1b3-48fc-a1e4-3d49ec83ae0f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36afdca5-f1b3-48fc-a1e4-3d49ec83ae0f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e60025c-ccf7-449e-a20f-bfd10f1f21d5' class='xr-var-data-in' type='checkbox'><label for='data-4e60025c-ccf7-449e-a20f-bfd10f1f21d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff vertically integrated mass transport</dd><dt><span>units :</span></dt><dd>meter3 second-1</dd><dt><span>field :</span></dt><dd>river_transport, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>array([[-4.1466484,  2.0557735, -5.9912252, ..., 20.56216  , 20.56216  ,
        20.56216  ],
       [-4.1466484,  2.0557735, -5.9912252, ..., 20.56216  , 20.56216  ,
        20.56216  ],
       [-4.1466484,  2.0557735, -5.9912252, ..., 20.56216  , 20.56216  ,
        20.56216  ],
       ...,
       [-3.3012724,  1.8338698, -4.816039 , ..., 17.932602 , 17.932602 ,
        17.932602 ],
       [-3.3012724,  1.8338698, -4.816039 , ..., 17.932602 , 17.932602 ,
        17.932602 ],
       [-3.3012724,  1.8338698, -4.816039 , ..., 17.932602 , 17.932602 ,
        17.932602 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_temp</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>3.584 2.477 1.353 ... 1.0 1.0 1.0</div><input id='attrs-37ae0b69-72d8-4d9c-b933-cb80a56164dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-37ae0b69-72d8-4d9c-b933-cb80a56164dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dda8262d-4de3-4f30-b20d-89855e69af75' class='xr-var-data-in' type='checkbox'><label for='data-dda8262d-4de3-4f30-b20d-89855e69af75' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff potential temperature</dd><dt><span>units :</span></dt><dd>Celsius</dd><dt><span>field :</span></dt><dd>river_temp, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>array([[[3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        ...,
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125]],

       [[3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
        [3.584375 , 2.4765625, 1.3527343, ..., 1.0078125, 1.0078125,
         1.0078125],
...
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ]],

       [[3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        ...,
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ],
        [3.005078 , 1.9      , 1.       , ..., 1.       , 1.       ,
         1.       ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_salt</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005 0.005 0.005 ... 0.005 0.005</div><input id='attrs-6c2a19a1-8e8e-46a8-96b4-bd2b15a46f7a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c2a19a1-8e8e-46a8-96b4-bd2b15a46f7a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3ba30b8-7974-42f5-bd06-4ed0f032f2c6' class='xr-var-data-in' type='checkbox'><label for='data-f3ba30b8-7974-42f5-bd06-4ed0f032f2c6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff salinity</dd><dt><span>units :</span></dt><dd>PSU</dd><dt><span>field :</span></dt><dd>river_salt, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>array([[[0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        ...,
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005]],

       [[0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        ...,
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005]],

       [[0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        ...,
...
        ...,
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005]],

       [[0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        ...,
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005]],

       [[0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        ...,
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005],
        [0.005, 0.005, 0.005, ..., 0.005, 0.005, 0.005]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_pass</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>9.969e+36 9.969e+36 ... 9.969e+36</div><input id='attrs-247fd62c-2673-44ce-b673-7d52e0e07976' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-247fd62c-2673-44ce-b673-7d52e0e07976' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37d016ac-d35c-45c5-aa18-5b881f32d283' class='xr-var-data-in' type='checkbox'><label for='data-37d016ac-d35c-45c5-aa18-5b881f32d283' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River runoff passive tracer</dd><dt><span>units :</span></dt><dd>PPM</dd><dt><span>field :</span></dt><dd>river_pass, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>array([[[9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        ...,
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36]],

       [[9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
...
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36]],

       [[9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        ...,
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36],
        [9.96921e+36, 9.96921e+36, 9.96921e+36, ..., 9.96921e+36,
         9.96921e+36, 9.96921e+36]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-124d4ef3-0855-4032-9276-955b2db6eb7e' class='xr-section-summary-in' type='checkbox'  ><label for='section-124d4ef3-0855-4032-9276-955b2db6eb7e' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>river</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-76e300f5-ee14-4618-b2dc-a31133ab49ad' class='xr-index-data-in' type='checkbox'/><label for='index-76e300f5-ee14-4618-b2dc-a31133ab49ad' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
            18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36],
           dtype=&#x27;int64&#x27;, name=&#x27;river&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>river_time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-605fadea-a535-4d88-a767-472c42529956' class='xr-index-data-in' type='checkbox'/><label for='index-605fadea-a535-4d88-a767-472c42529956' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2008-11-01 00:00:00+00:00&#x27;, &#x27;2008-11-01 01:00:00+00:00&#x27;,
               &#x27;2008-11-01 02:00:00+00:00&#x27;, &#x27;2008-11-01 03:00:00+00:00&#x27;,
               &#x27;2008-11-01 04:00:00+00:00&#x27;, &#x27;2008-11-01 05:00:00+00:00&#x27;,
               &#x27;2008-11-01 06:00:00+00:00&#x27;, &#x27;2008-11-01 07:00:00+00:00&#x27;,
               &#x27;2008-11-01 08:00:00+00:00&#x27;, &#x27;2008-11-01 09:00:00+00:00&#x27;,
               ...
               &#x27;2008-11-06 15:00:00+00:00&#x27;, &#x27;2008-11-06 16:00:00+00:00&#x27;,
               &#x27;2008-11-06 17:00:00+00:00&#x27;, &#x27;2008-11-06 18:00:00+00:00&#x27;,
               &#x27;2008-11-06 19:00:00+00:00&#x27;, &#x27;2008-11-06 20:00:00+00:00&#x27;,
               &#x27;2008-11-06 21:00:00+00:00&#x27;, &#x27;2008-11-06 22:00:00+00:00&#x27;,
               &#x27;2008-11-06 23:00:00+00:00&#x27;, &#x27;2008-11-07 00:00:00+00:00&#x27;],
              dtype=&#x27;datetime64[ns, UTC]&#x27;, name=&#x27;river_time&#x27;, length=145, freq=&#x27;H&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bf5fee2b-b726-4776-b31c-4bde8c703758' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bf5fee2b-b726-4776-b31c-4bde8c703758' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>ROMS river forcing netCDF file</dd><dt><span>title :</span></dt><dd>ciofs River forcing netCDF file</dd><dt><span>data_source :</span></dt><dd>River discharge from USGS real time or daily mean</dd><dt><span>Temp_source :</span></dt><dd>River T from USGS real time or daily mean, Salt=0</dd><dt><span>model_grid_file :</span></dt><dd>GRID file: nos.ciofs.romsgrid.nc</dd><dt><span>output_file :</span></dt><dd>River Forcing file: nos.ciofs.river.20221216.t00z.nc</dd><dt><span>source_code :</span></dt><dd>Created using nos_ofs_create_river_ROMS.sh</dd><dt><span>history :</span></dt><dd>Created at time 00:52  12/16/2022</dd><dt><span>reference :</span></dt><dd>Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Compare with one file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;nos.ciofs.river.20221216.t00z (1).nc&#39;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%MZ&quot;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%MZ&quot;</span><span class="p">)</span>

<span class="n">dscompare</span> <span class="o">=</span> <span class="n">create_river_forcing_file</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;river_time&quot;</span><span class="p">})</span>
<span class="n">dscompare</span> <span class="o">=</span> <span class="n">dscompare</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;river_time&quot;</span><span class="p">})</span>

<span class="n">plot_comparison</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">dscompare</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fill over 2 days with function
Using gage data for station 15276000.
Extrapolating ratingData upward for station 15276000.
max data value: 8.91, max INDEP value is 7.15
fill over 2 days with function
Using gage data for station 15290000.
fill over 2 days with function
Using gage data for station 15271000.
fill over 2 days with function
calculating mean time series
calculating mean time series
fill over 2 days with function
Using gage data for station 15239070.
fill over 2 days with function
Using gage data for station 15275100.
fill over 2 days with function
Using gage data for station 15266300.
fill over 2 days with function
Using gage data for station 15284000.
Extrapolating ratingData downward for station 15284000.
min data value: 0.0, min INDEP value is 0.1
fill over 2 days with function
Using gage data for station 15292000.
Extrapolating ratingData downward for station 15292000.
min data value: 0.0, min INDEP value is 4.5
fill over 2 days with function
Using gage data for station 15274600.
calculating mean time series
calculating mean time series
</pre></div>
</div>
<img alt="_images/864b2942cfc174379dd33690c5530de54e4b6a904b257d9a6c6fffbe5de564ba.png" src="_images/864b2942cfc174379dd33690c5530de54e4b6a904b257d9a6c6fffbe5de564ba.png" />
<img alt="_images/40a97aff7ee5c6701f1a5ef2c6a11a4ca387e7a4c9ab4243be96464fbd97e27b.png" src="_images/40a97aff7ee5c6701f1a5ef2c6a11a4ca387e7a4c9ab4243be96464fbd97e27b.png" />
<img alt="_images/ebce4ac56af985d25f3386c45a19d3811dd441e5d37d05bf1448bdf837c293c5.png" src="_images/ebce4ac56af985d25f3386c45a19d3811dd441e5d37d05bf1448bdf837c293c5.png" />
<img alt="_images/2c37fc49c98f016818c121b04a5b98554dfe61562f97d57fc29ef4c7c1ec46e9.png" src="_images/2c37fc49c98f016818c121b04a5b98554dfe61562f97d57fc29ef4c7c1ec46e9.png" />
<img alt="_images/2d29148eea2c1cf7acf3806b5472c8fb0d7976a395e4716f77da3e588abdd4db.png" src="_images/2d29148eea2c1cf7acf3806b5472c8fb0d7976a395e4716f77da3e588abdd4db.png" />
<img alt="_images/0065e07e41c1a97d858d7d334aaa62a908b037c551c31bf5c7915a6ff44fa3c0.png" src="_images/0065e07e41c1a97d858d7d334aaa62a908b037c551c31bf5c7915a6ff44fa3c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;nos.ciofs.river.20230201.t00z.nc&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%MZ&quot;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%MZ&quot;</span><span class="p">)</span>

<span class="n">dscompare</span> <span class="o">=</span> <span class="n">create_river_forcing_file</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;river_time&quot;</span><span class="p">})</span>
<span class="n">dscompare</span> <span class="o">=</span> <span class="n">dscompare</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;river_time&quot;</span><span class="p">})</span>

<span class="n">plot_comparison</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">dscompare</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fill over 2 days with function
Using gage data for station 15276000.
fill over 2 days with function
Using gage data for station 15290000.
fill over 2 days with function
Using gage data for station 15271000.
fill over 2 days with function
calculating mean time series
calculating mean time series
fill over 2 days with function
Using gage data for station 15266300.
fill over 2 days with function
Using gage data for station 15284000.
Extrapolating ratingData downward for station 15284000.
min data value: 0.0, min INDEP value is 0.1
fill over 2 days with function
Using gage data for station 15292000.
Extrapolating ratingData downward for station 15292000.
min data value: 0.0, min INDEP value is 4.5
fill over 2 days with function
Using gage data for station 15274600.
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
</pre></div>
</div>
<img alt="_images/c80f44ee4bf6ea93ab700570ca7046f70eca939428241816db6d91e99115e80d.png" src="_images/c80f44ee4bf6ea93ab700570ca7046f70eca939428241816db6d91e99115e80d.png" />
<img alt="_images/3fb7d7e4ec7c41ece59367715859f9f0b976362b1926877e51bd2d1cf0554808.png" src="_images/3fb7d7e4ec7c41ece59367715859f9f0b976362b1926877e51bd2d1cf0554808.png" />
<img alt="_images/026eca8d44fc3e8658f0684f3290529b1dcf78019d1aa1b85e3935ac6f96f91d.png" src="_images/026eca8d44fc3e8658f0684f3290529b1dcf78019d1aa1b85e3935ac6f96f91d.png" />
<img alt="_images/f2ed636c133c48a895f2144024bc44329ff7ccda6a200b1a00b031a37d80527f.png" src="_images/f2ed636c133c48a895f2144024bc44329ff7ccda6a200b1a00b031a37d80527f.png" />
<img alt="_images/23eab301f75eb9d7cb0381bfcbc871f3aa66aa8fc03214b8556f0924aa568d42.png" src="_images/23eab301f75eb9d7cb0381bfcbc871f3aa66aa8fc03214b8556f0924aa568d42.png" />
<img alt="_images/d17a462d764e654f3ddbe81546f40b2feb1d2d2f0c6023d8139f047c2fc31eed.png" src="_images/d17a462d764e654f3ddbe81546f40b2feb1d2d2f0c6023d8139f047c2fc31eed.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_comparison</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">dscompare</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    
    <span class="n">color_noaa</span> <span class="o">=</span> <span class="s2">&quot;cornflowerblue&quot;</span>
    <span class="n">color_axiom</span> <span class="o">=</span> <span class="s2">&quot;hotpink&quot;</span>
    <span class="n">kwargs_line</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;river_time&quot;</span><span class="p">,</span> <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
    <span class="n">kwargs_noaa</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color_noaa</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;NOAA&quot;</span><span class="p">}</span>
    <span class="n">kwargs_axiom</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color_axiom</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Axiom&quot;</span><span class="p">,</span> <span class="s2">&quot;ls&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">}</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
    <span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
    <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;NOAA forcing file&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Axiom recreation&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;NOAA-Axiom&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;River discharge&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="n">noaa_discharge</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;river_transport&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">3600</span><span class="o">/</span><span class="mi">1000</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># m^3/s * 3600 s for hour * (1km/1000m)^3</span>
    <span class="n">axiom_discharge</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dscompare</span><span class="p">[</span><span class="s1">&#39;river_transport&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">3600</span><span class="o">/</span><span class="mi">1000</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># m^3/s * 3600 s for hour</span>

    <span class="n">unique_inds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">station_list_file</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrivers</span><span class="p">)]))</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">river</span><span class="o">=</span><span class="n">unique_inds</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_line</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NOAA forcing file: all unique river transport. Total discharge: </span><span class="si">{</span><span class="n">noaa_discharge</span><span class="si">}</span><span class="s2"> km^3.&quot;</span><span class="p">)</span>
    <span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">river</span><span class="o">=</span><span class="n">unique_inds</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_line</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axiom forcing file: all unique river transport. Total discharge: </span><span class="si">{</span><span class="n">axiom_discharge</span><span class="si">}</span><span class="s2"> km^3.&quot;</span><span class="p">)</span>

    <span class="c1"># print(f&quot;NOAA forcing file total freshwater: {}&quot;)</span>
    <span class="c1"># print(f&quot;Axiom forcing file total freshwater: {abs(dscompare[&#39;river_transport&#39;]).sum()*3600}&quot;)</span>

    <span class="c1"># pull over rivers that have nonzero transport from original file</span>
    <span class="n">ibool</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;river_time&quot;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river&quot;</span><span class="p">][</span><span class="n">ibool</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;river_transport&quot;</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">river</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_line</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_noaa</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span>
    <span class="n">dscompare</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">river</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_line</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_axiom</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;River discharge for nonzero NOAA rivers.&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">s_rho</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
    <span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">s_rho</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
    <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">s_rho</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;NOAA forcing file&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Axiom recreation&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;NOAA-Axiom&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;River temperature&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="c1"># pull over rivers that have non-one temp from Axiom file</span>
    <span class="n">ibool</span> <span class="o">=</span> <span class="p">(</span><span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">s_rho</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;river_time&quot;</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">dscompare</span><span class="p">[</span><span class="s2">&quot;river&quot;</span><span class="p">][</span><span class="n">ibool</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;river_temp&quot;</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">s_rho</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">river</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_line</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_noaa</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span>
    <span class="n">dscompare</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">s_rho</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">river</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_line</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_axiom</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;River temps for Axiom rivers above 1Ëš C.&quot;</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="make-example-forcing-file-for-chang">
<h1>Make example forcing file for Chang<a class="headerlink" href="#make-example-forcing-file-for-chang" title="Permalink to this headline">#</a></h1>
<p>to test with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;1998-1-1T00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;1998-1-5T00:00&quot;</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">create_river_forcing_file</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s2">&quot;test_river_forcing_file.nc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
calculating mean time series
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="make-monthly-forcing-files-for-1998-and-check-them">
<h1>Make monthly forcing files for 1998 and check them<a class="headerlink" href="#make-monthly-forcing-files-for-1998-and-check-them" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;hide-output&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># start_overall, end_overall = &quot;1998-1-1T00:00&quot;, &quot;1998-12-31T23:00&quot;</span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">1998</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">-1T00&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="mi">1</span><span class="si">}</span><span class="s2">-1T00&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">-1T00&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">-1T00&quot;</span>

    <span class="n">ds</span><span class="p">,</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">create_river_forcing_file</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">ndays</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">skip_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing discharge for station 15276000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-01-01 00:00:00&#39;, &#39;1998-01-01 00:15:00&#39;,
               &#39;1998-01-01 00:30:00&#39;, &#39;1998-01-01 00:45:00&#39;,
               &#39;1998-01-01 01:00:00&#39;, &#39;1998-01-01 01:15:00&#39;,
               &#39;1998-01-01 01:30:00&#39;, &#39;1998-01-01 01:45:00&#39;,
               &#39;1998-01-01 02:00:00&#39;, &#39;1998-01-01 02:15:00&#39;,
               ...
               &#39;1998-01-30 06:30:00&#39;, &#39;1998-01-30 06:45:00&#39;,
               &#39;1998-01-30 07:00:00&#39;, &#39;1998-01-30 07:15:00&#39;,
               &#39;1998-01-30 07:30:00&#39;, &#39;1998-01-30 07:45:00&#39;,
               &#39;1998-01-30 08:00:00&#39;, &#39;1998-01-30 08:15:00&#39;,
               &#39;1998-01-30 08:30:00&#39;, &#39;1998-01-30 08:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2820, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15271000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15239900 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-01-01 00:00:00&#39;, &#39;1998-01-01 00:15:00&#39;,
               &#39;1998-01-01 00:30:00&#39;, &#39;1998-01-01 00:45:00&#39;,
               &#39;1998-01-01 01:00:00&#39;, &#39;1998-01-01 01:15:00&#39;,
               &#39;1998-01-01 01:30:00&#39;, &#39;1998-01-01 01:45:00&#39;,
               &#39;1998-01-01 02:00:00&#39;, &#39;1998-01-01 02:15:00&#39;,
               &#39;1998-01-01 02:30:00&#39;, &#39;1998-01-01 02:45:00&#39;,
               &#39;1998-01-01 03:00:00&#39;, &#39;1998-01-01 03:15:00&#39;,
               &#39;1998-01-01 03:30:00&#39;, &#39;1998-01-01 03:45:00&#39;,
               &#39;1998-01-01 04:00:00&#39;, &#39;1998-01-01 04:15:00&#39;,
               &#39;1998-01-01 04:30:00&#39;, &#39;1998-01-01 04:45:00&#39;,
               &#39;1998-01-01 05:00:00&#39;, &#39;1998-01-01 05:15:00&#39;,
               &#39;1998-01-01 05:30:00&#39;, &#39;1998-01-01 05:45:00&#39;,
               &#39;1998-01-01 06:00:00&#39;, &#39;1998-01-01 06:15:00&#39;,
               &#39;1998-01-01 06:30:00&#39;, &#39;1998-01-01 06:45:00&#39;,
               &#39;1998-01-01 07:00:00&#39;, &#39;1998-01-01 07:15:00&#39;,
               &#39;1998-01-01 07:30:00&#39;, &#39;1998-01-01 07:45:00&#39;,
               &#39;1998-01-01 08:00:00&#39;, &#39;1998-01-01 08:15:00&#39;,
               &#39;1998-01-01 08:30:00&#39;, &#39;1998-01-01 08:45:00&#39;,
               &#39;1998-01-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15275100 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15284000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-1-1T00 to 1998-01-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-02-08 09:00:00&#39;, &#39;1998-02-08 09:15:00&#39;,
               &#39;1998-02-08 09:30:00&#39;, &#39;1998-02-08 09:45:00&#39;,
               &#39;1998-02-08 10:00:00&#39;, &#39;1998-02-08 10:15:00&#39;,
               &#39;1998-02-08 10:30:00&#39;, &#39;1998-02-08 10:45:00&#39;,
               &#39;1998-02-08 11:00:00&#39;, &#39;1998-02-08 11:15:00&#39;,
               ...
               &#39;1998-02-19 06:30:00&#39;, &#39;1998-02-19 06:45:00&#39;,
               &#39;1998-02-19 07:00:00&#39;, &#39;1998-02-19 07:15:00&#39;,
               &#39;1998-02-19 07:30:00&#39;, &#39;1998-02-19 07:45:00&#39;,
               &#39;1998-02-19 08:00:00&#39;, &#39;1998-02-19 08:15:00&#39;,
               &#39;1998-02-19 08:30:00&#39;, &#39;1998-02-19 08:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=1056, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-02-01 00:00:00&#39;, &#39;1998-02-01 00:15:00&#39;,
               &#39;1998-02-01 00:30:00&#39;, &#39;1998-02-01 00:45:00&#39;,
               &#39;1998-02-01 01:00:00&#39;, &#39;1998-02-01 01:15:00&#39;,
               &#39;1998-02-01 01:30:00&#39;, &#39;1998-02-01 01:45:00&#39;,
               &#39;1998-02-01 02:00:00&#39;, &#39;1998-02-01 02:15:00&#39;,
               &#39;1998-02-01 02:30:00&#39;, &#39;1998-02-01 02:45:00&#39;,
               &#39;1998-02-01 03:00:00&#39;, &#39;1998-02-01 03:15:00&#39;,
               &#39;1998-02-01 03:30:00&#39;, &#39;1998-02-01 03:45:00&#39;,
               &#39;1998-02-01 04:00:00&#39;, &#39;1998-02-01 04:15:00&#39;,
               &#39;1998-02-01 04:30:00&#39;, &#39;1998-02-01 04:45:00&#39;,
               &#39;1998-02-01 05:00:00&#39;, &#39;1998-02-01 05:15:00&#39;,
               &#39;1998-02-01 05:30:00&#39;, &#39;1998-02-01 05:45:00&#39;,
               &#39;1998-02-01 06:00:00&#39;, &#39;1998-02-01 06:15:00&#39;,
               &#39;1998-02-01 06:30:00&#39;, &#39;1998-02-01 06:45:00&#39;,
               &#39;1998-02-01 07:00:00&#39;, &#39;1998-02-01 07:15:00&#39;,
               &#39;1998-02-01 07:30:00&#39;, &#39;1998-02-01 07:45:00&#39;,
               &#39;1998-02-01 08:00:00&#39;, &#39;1998-02-01 08:15:00&#39;,
               &#39;1998-02-01 08:30:00&#39;, &#39;1998-02-01 08:45:00&#39;,
               &#39;1998-02-01 09:00:00&#39;, &#39;1998-02-28 08:45:00&#39;,
               &#39;1998-02-28 09:00:00&#39;, &#39;1998-02-28 09:15:00&#39;,
               &#39;1998-02-28 09:30:00&#39;, &#39;1998-02-28 09:45:00&#39;,
               &#39;1998-02-28 10:00:00&#39;, &#39;1998-02-28 10:15:00&#39;,
               &#39;1998-02-28 10:30:00&#39;, &#39;1998-02-28 10:45:00&#39;,
               &#39;1998-02-28 11:00:00&#39;, &#39;1998-02-28 11:15:00&#39;,
               &#39;1998-02-28 11:30:00&#39;, &#39;1998-02-28 11:45:00&#39;,
               &#39;1998-02-28 12:00:00&#39;, &#39;1998-02-28 12:15:00&#39;,
               &#39;1998-02-28 12:30:00&#39;, &#39;1998-02-28 12:45:00&#39;,
               &#39;1998-02-28 13:00:00&#39;, &#39;1998-02-28 13:15:00&#39;,
               &#39;1998-02-28 13:30:00&#39;, &#39;1998-02-28 13:45:00&#39;,
               &#39;1998-02-28 14:00:00&#39;, &#39;1998-02-28 14:15:00&#39;,
               &#39;1998-02-28 14:30:00&#39;, &#39;1998-02-28 14:45:00&#39;,
               &#39;1998-02-28 15:00:00&#39;, &#39;1998-02-28 15:15:00&#39;,
               &#39;1998-02-28 15:30:00&#39;, &#39;1998-02-28 15:45:00&#39;,
               &#39;1998-02-28 16:00:00&#39;, &#39;1998-02-28 16:15:00&#39;,
               &#39;1998-02-28 16:30:00&#39;, &#39;1998-02-28 16:45:00&#39;,
               &#39;1998-02-28 17:00:00&#39;, &#39;1998-02-28 17:15:00&#39;,
               &#39;1998-02-28 17:30:00&#39;, &#39;1998-02-28 17:45:00&#39;,
               &#39;1998-02-28 18:00:00&#39;, &#39;1998-02-28 18:15:00&#39;,
               &#39;1998-02-28 18:30:00&#39;, &#39;1998-02-28 18:45:00&#39;,
               &#39;1998-02-28 19:00:00&#39;, &#39;1998-02-28 19:15:00&#39;,
               &#39;1998-02-28 19:30:00&#39;, &#39;1998-02-28 19:45:00&#39;,
               &#39;1998-02-28 20:00:00&#39;, &#39;1998-02-28 20:15:00&#39;,
               &#39;1998-02-28 20:30:00&#39;, &#39;1998-02-28 20:45:00&#39;,
               &#39;1998-02-28 21:00:00&#39;, &#39;1998-02-28 21:15:00&#39;,
               &#39;1998-02-28 21:30:00&#39;, &#39;1998-02-28 21:45:00&#39;,
               &#39;1998-02-28 22:00:00&#39;, &#39;1998-02-28 22:15:00&#39;,
               &#39;1998-02-28 22:30:00&#39;, &#39;1998-02-28 22:45:00&#39;,
               &#39;1998-02-28 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15290000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15271000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15239900 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-02-01 00:00:00&#39;, &#39;1998-02-01 00:15:00&#39;,
               &#39;1998-02-01 00:30:00&#39;, &#39;1998-02-01 00:45:00&#39;,
               &#39;1998-02-01 01:00:00&#39;, &#39;1998-02-01 01:15:00&#39;,
               &#39;1998-02-01 01:30:00&#39;, &#39;1998-02-01 01:45:00&#39;,
               &#39;1998-02-01 02:00:00&#39;, &#39;1998-02-01 02:15:00&#39;,
               &#39;1998-02-01 02:30:00&#39;, &#39;1998-02-01 02:45:00&#39;,
               &#39;1998-02-01 03:00:00&#39;, &#39;1998-02-01 03:15:00&#39;,
               &#39;1998-02-01 03:30:00&#39;, &#39;1998-02-01 03:45:00&#39;,
               &#39;1998-02-01 04:00:00&#39;, &#39;1998-02-01 04:15:00&#39;,
               &#39;1998-02-01 04:30:00&#39;, &#39;1998-02-01 04:45:00&#39;,
               &#39;1998-02-01 05:00:00&#39;, &#39;1998-02-01 05:15:00&#39;,
               &#39;1998-02-01 05:30:00&#39;, &#39;1998-02-01 05:45:00&#39;,
               &#39;1998-02-01 06:00:00&#39;, &#39;1998-02-01 06:15:00&#39;,
               &#39;1998-02-01 06:30:00&#39;, &#39;1998-02-01 06:45:00&#39;,
               &#39;1998-02-01 07:00:00&#39;, &#39;1998-02-01 07:15:00&#39;,
               &#39;1998-02-01 07:30:00&#39;, &#39;1998-02-01 07:45:00&#39;,
               &#39;1998-02-01 08:00:00&#39;, &#39;1998-02-01 08:15:00&#39;,
               &#39;1998-02-01 08:30:00&#39;, &#39;1998-02-01 08:45:00&#39;,
               &#39;1998-02-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-02-11 08:45:00&#39;, &#39;1998-02-11 09:00:00&#39;,
               &#39;1998-02-11 09:15:00&#39;, &#39;1998-02-11 09:30:00&#39;,
               &#39;1998-02-11 09:45:00&#39;, &#39;1998-02-11 10:00:00&#39;,
               &#39;1998-02-11 10:15:00&#39;, &#39;1998-02-11 10:30:00&#39;,
               &#39;1998-02-11 10:45:00&#39;, &#39;1998-02-11 11:00:00&#39;,
               ...
               &#39;1998-02-21 06:30:00&#39;, &#39;1998-02-21 06:45:00&#39;,
               &#39;1998-02-21 07:00:00&#39;, &#39;1998-02-21 07:15:00&#39;,
               &#39;1998-02-21 07:30:00&#39;, &#39;1998-02-21 07:45:00&#39;,
               &#39;1998-02-21 08:00:00&#39;, &#39;1998-02-21 08:15:00&#39;,
               &#39;1998-02-21 08:30:00&#39;, &#39;1998-02-21 08:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=961, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-02-01 00:00:00&#39;, &#39;1998-02-01 00:15:00&#39;,
               &#39;1998-02-01 00:30:00&#39;, &#39;1998-02-01 00:45:00&#39;,
               &#39;1998-02-01 01:00:00&#39;, &#39;1998-02-01 01:15:00&#39;,
               &#39;1998-02-01 01:30:00&#39;, &#39;1998-02-01 01:45:00&#39;,
               &#39;1998-02-01 02:00:00&#39;, &#39;1998-02-01 02:15:00&#39;,
               ...
               &#39;1998-02-28 20:45:00&#39;, &#39;1998-02-28 21:00:00&#39;,
               &#39;1998-02-28 21:15:00&#39;, &#39;1998-02-28 21:30:00&#39;,
               &#39;1998-02-28 21:45:00&#39;, &#39;1998-02-28 22:00:00&#39;,
               &#39;1998-02-28 22:15:00&#39;, &#39;1998-02-28 22:30:00&#39;,
               &#39;1998-02-28 22:45:00&#39;, &#39;1998-02-28 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=1724, freq=None).
processing final discharge data

Processing discharge for station 15275100 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15284000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-2-1T00 to 1998-02-28T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-03-01 00:00:00&#39;, &#39;1998-03-01 00:15:00&#39;,
               &#39;1998-03-01 00:30:00&#39;, &#39;1998-03-01 00:45:00&#39;,
               &#39;1998-03-01 01:00:00&#39;, &#39;1998-03-01 01:15:00&#39;,
               &#39;1998-03-01 01:30:00&#39;, &#39;1998-03-01 01:45:00&#39;,
               &#39;1998-03-01 02:00:00&#39;, &#39;1998-03-01 02:15:00&#39;,
               ...
               &#39;1998-03-30 06:30:00&#39;, &#39;1998-03-30 06:45:00&#39;,
               &#39;1998-03-30 07:00:00&#39;, &#39;1998-03-30 07:15:00&#39;,
               &#39;1998-03-30 07:30:00&#39;, &#39;1998-03-30 07:45:00&#39;,
               &#39;1998-03-30 08:00:00&#39;, &#39;1998-03-30 08:15:00&#39;,
               &#39;1998-03-30 08:30:00&#39;, &#39;1998-03-30 08:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2820, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15271000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-03-02 09:00:00&#39;, &#39;1998-03-02 09:15:00&#39;,
               &#39;1998-03-02 09:30:00&#39;, &#39;1998-03-02 09:45:00&#39;,
               &#39;1998-03-02 10:00:00&#39;, &#39;1998-03-02 10:15:00&#39;,
               &#39;1998-03-02 10:30:00&#39;, &#39;1998-03-02 10:45:00&#39;,
               &#39;1998-03-02 11:00:00&#39;, &#39;1998-03-02 11:15:00&#39;,
               ...
               &#39;1998-03-13 06:30:00&#39;, &#39;1998-03-13 06:45:00&#39;,
               &#39;1998-03-13 07:00:00&#39;, &#39;1998-03-13 07:15:00&#39;,
               &#39;1998-03-13 07:30:00&#39;, &#39;1998-03-13 07:45:00&#39;,
               &#39;1998-03-13 08:00:00&#39;, &#39;1998-03-13 08:15:00&#39;,
               &#39;1998-03-13 08:30:00&#39;, &#39;1998-03-13 08:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=1056, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-03-01 00:00:00&#39;, &#39;1998-03-01 00:15:00&#39;,
               &#39;1998-03-01 00:30:00&#39;, &#39;1998-03-01 00:45:00&#39;,
               &#39;1998-03-01 01:00:00&#39;, &#39;1998-03-01 01:15:00&#39;,
               &#39;1998-03-01 01:30:00&#39;, &#39;1998-03-01 01:45:00&#39;,
               &#39;1998-03-01 02:00:00&#39;, &#39;1998-03-01 02:15:00&#39;,
               &#39;1998-03-01 02:30:00&#39;, &#39;1998-03-01 02:45:00&#39;,
               &#39;1998-03-01 03:00:00&#39;, &#39;1998-03-01 03:15:00&#39;,
               &#39;1998-03-01 03:30:00&#39;, &#39;1998-03-01 03:45:00&#39;,
               &#39;1998-03-01 04:00:00&#39;, &#39;1998-03-01 04:15:00&#39;,
               &#39;1998-03-01 04:30:00&#39;, &#39;1998-03-01 04:45:00&#39;,
               &#39;1998-03-01 05:00:00&#39;, &#39;1998-03-01 05:15:00&#39;,
               &#39;1998-03-01 05:30:00&#39;, &#39;1998-03-01 05:45:00&#39;,
               &#39;1998-03-01 06:00:00&#39;, &#39;1998-03-01 06:15:00&#39;,
               &#39;1998-03-01 06:30:00&#39;, &#39;1998-03-01 06:45:00&#39;,
               &#39;1998-03-01 07:00:00&#39;, &#39;1998-03-01 07:15:00&#39;,
               &#39;1998-03-01 07:30:00&#39;, &#39;1998-03-01 07:45:00&#39;,
               &#39;1998-03-01 08:00:00&#39;, &#39;1998-03-01 08:15:00&#39;,
               &#39;1998-03-01 08:30:00&#39;, &#39;1998-03-01 08:45:00&#39;,
               &#39;1998-03-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239900 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-03-01 00:00:00&#39;, &#39;1998-03-01 00:15:00&#39;,
               &#39;1998-03-01 00:30:00&#39;, &#39;1998-03-01 00:45:00&#39;,
               &#39;1998-03-01 01:00:00&#39;, &#39;1998-03-01 01:15:00&#39;,
               &#39;1998-03-01 01:30:00&#39;, &#39;1998-03-01 01:45:00&#39;,
               &#39;1998-03-01 02:00:00&#39;, &#39;1998-03-01 02:15:00&#39;,
               &#39;1998-03-01 02:30:00&#39;, &#39;1998-03-01 02:45:00&#39;,
               &#39;1998-03-01 03:00:00&#39;, &#39;1998-03-01 03:15:00&#39;,
               &#39;1998-03-01 03:30:00&#39;, &#39;1998-03-01 03:45:00&#39;,
               &#39;1998-03-01 04:00:00&#39;, &#39;1998-03-01 04:15:00&#39;,
               &#39;1998-03-01 04:30:00&#39;, &#39;1998-03-01 04:45:00&#39;,
               &#39;1998-03-01 05:00:00&#39;, &#39;1998-03-01 05:15:00&#39;,
               &#39;1998-03-01 05:30:00&#39;, &#39;1998-03-01 05:45:00&#39;,
               &#39;1998-03-01 06:00:00&#39;, &#39;1998-03-01 06:15:00&#39;,
               &#39;1998-03-01 06:30:00&#39;, &#39;1998-03-01 06:45:00&#39;,
               &#39;1998-03-01 07:00:00&#39;, &#39;1998-03-01 07:15:00&#39;,
               &#39;1998-03-01 07:30:00&#39;, &#39;1998-03-01 07:45:00&#39;,
               &#39;1998-03-01 08:00:00&#39;, &#39;1998-03-01 08:15:00&#39;,
               &#39;1998-03-01 08:30:00&#39;, &#39;1998-03-01 08:45:00&#39;,
               &#39;1998-03-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-03-01 00:00:00&#39;, &#39;1998-03-01 00:15:00&#39;,
               &#39;1998-03-01 00:30:00&#39;, &#39;1998-03-01 00:45:00&#39;,
               &#39;1998-03-01 01:00:00&#39;, &#39;1998-03-01 01:15:00&#39;,
               &#39;1998-03-01 01:30:00&#39;, &#39;1998-03-01 01:45:00&#39;,
               &#39;1998-03-01 02:00:00&#39;, &#39;1998-03-01 02:15:00&#39;,
               ...
               &#39;1998-03-09 06:30:00&#39;, &#39;1998-03-09 06:45:00&#39;,
               &#39;1998-03-09 07:00:00&#39;, &#39;1998-03-09 07:15:00&#39;,
               &#39;1998-03-09 07:30:00&#39;, &#39;1998-03-09 07:45:00&#39;,
               &#39;1998-03-09 08:00:00&#39;, &#39;1998-03-09 08:15:00&#39;,
               &#39;1998-03-09 08:30:00&#39;, &#39;1998-03-09 08:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=804, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-03-09 09:00:00&#39;, &#39;1998-03-09 09:15:00&#39;,
               &#39;1998-03-09 09:30:00&#39;, &#39;1998-03-09 09:45:00&#39;,
               &#39;1998-03-09 10:00:00&#39;, &#39;1998-03-09 10:15:00&#39;,
               &#39;1998-03-09 10:30:00&#39;, &#39;1998-03-09 10:45:00&#39;,
               &#39;1998-03-09 11:00:00&#39;, &#39;1998-03-09 11:15:00&#39;,
               ...
               &#39;1998-03-31 20:45:00&#39;, &#39;1998-03-31 21:00:00&#39;,
               &#39;1998-03-31 21:15:00&#39;, &#39;1998-03-31 21:30:00&#39;,
               &#39;1998-03-31 21:45:00&#39;, &#39;1998-03-31 22:00:00&#39;,
               &#39;1998-03-31 22:15:00&#39;, &#39;1998-03-31 22:30:00&#39;,
               &#39;1998-03-31 22:45:00&#39;, &#39;1998-03-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2169, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15275100 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15284000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-3-1T00 to 1998-03-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-04-01 00:00:00&#39;, &#39;1998-04-01 00:15:00&#39;,
               &#39;1998-04-01 00:30:00&#39;, &#39;1998-04-01 00:45:00&#39;,
               &#39;1998-04-01 01:00:00&#39;, &#39;1998-04-01 01:15:00&#39;,
               &#39;1998-04-01 01:30:00&#39;, &#39;1998-04-01 01:45:00&#39;,
               &#39;1998-04-01 02:00:00&#39;, &#39;1998-04-01 02:15:00&#39;,
               &#39;1998-04-01 02:30:00&#39;, &#39;1998-04-01 02:45:00&#39;,
               &#39;1998-04-01 03:00:00&#39;, &#39;1998-04-01 03:15:00&#39;,
               &#39;1998-04-01 03:30:00&#39;, &#39;1998-04-01 03:45:00&#39;,
               &#39;1998-04-01 04:00:00&#39;, &#39;1998-04-01 04:15:00&#39;,
               &#39;1998-04-01 04:30:00&#39;, &#39;1998-04-01 04:45:00&#39;,
               &#39;1998-04-01 05:00:00&#39;, &#39;1998-04-01 05:15:00&#39;,
               &#39;1998-04-01 05:30:00&#39;, &#39;1998-04-01 05:45:00&#39;,
               &#39;1998-04-01 06:00:00&#39;, &#39;1998-04-01 06:15:00&#39;,
               &#39;1998-04-01 06:30:00&#39;, &#39;1998-04-01 06:45:00&#39;,
               &#39;1998-04-01 07:00:00&#39;, &#39;1998-04-01 07:15:00&#39;,
               &#39;1998-04-01 07:30:00&#39;, &#39;1998-04-01 07:45:00&#39;,
               &#39;1998-04-01 08:00:00&#39;, &#39;1998-04-01 08:15:00&#39;,
               &#39;1998-04-01 08:30:00&#39;, &#39;1998-04-01 08:45:00&#39;,
               &#39;1998-04-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15271000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-04-01 00:00:00&#39;, &#39;1998-04-01 00:15:00&#39;,
               &#39;1998-04-01 00:30:00&#39;, &#39;1998-04-01 00:45:00&#39;,
               &#39;1998-04-01 01:00:00&#39;, &#39;1998-04-01 01:15:00&#39;,
               &#39;1998-04-01 01:30:00&#39;, &#39;1998-04-01 01:45:00&#39;,
               &#39;1998-04-01 02:00:00&#39;, &#39;1998-04-01 02:15:00&#39;,
               &#39;1998-04-01 02:30:00&#39;, &#39;1998-04-01 02:45:00&#39;,
               &#39;1998-04-01 03:00:00&#39;, &#39;1998-04-01 03:15:00&#39;,
               &#39;1998-04-01 03:30:00&#39;, &#39;1998-04-01 03:45:00&#39;,
               &#39;1998-04-01 04:00:00&#39;, &#39;1998-04-01 04:15:00&#39;,
               &#39;1998-04-01 04:30:00&#39;, &#39;1998-04-01 04:45:00&#39;,
               &#39;1998-04-01 05:00:00&#39;, &#39;1998-04-01 05:15:00&#39;,
               &#39;1998-04-01 05:30:00&#39;, &#39;1998-04-01 05:45:00&#39;,
               &#39;1998-04-01 06:00:00&#39;, &#39;1998-04-01 06:15:00&#39;,
               &#39;1998-04-01 06:30:00&#39;, &#39;1998-04-01 06:45:00&#39;,
               &#39;1998-04-01 07:00:00&#39;, &#39;1998-04-01 07:15:00&#39;,
               &#39;1998-04-01 07:30:00&#39;, &#39;1998-04-01 07:45:00&#39;,
               &#39;1998-04-01 08:00:00&#39;, &#39;1998-04-01 08:15:00&#39;,
               &#39;1998-04-01 08:30:00&#39;, &#39;1998-04-01 08:45:00&#39;,
               &#39;1998-04-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239900 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-04-01 00:00:00&#39;, &#39;1998-04-01 00:15:00&#39;,
               &#39;1998-04-01 00:30:00&#39;, &#39;1998-04-01 00:45:00&#39;,
               &#39;1998-04-01 01:00:00&#39;, &#39;1998-04-01 01:15:00&#39;,
               &#39;1998-04-01 01:30:00&#39;, &#39;1998-04-01 01:45:00&#39;,
               &#39;1998-04-01 02:00:00&#39;, &#39;1998-04-01 02:15:00&#39;,
               &#39;1998-04-01 02:30:00&#39;, &#39;1998-04-01 02:45:00&#39;,
               &#39;1998-04-01 03:00:00&#39;, &#39;1998-04-01 03:15:00&#39;,
               &#39;1998-04-01 03:30:00&#39;, &#39;1998-04-01 03:45:00&#39;,
               &#39;1998-04-01 04:00:00&#39;, &#39;1998-04-01 04:15:00&#39;,
               &#39;1998-04-01 04:30:00&#39;, &#39;1998-04-01 04:45:00&#39;,
               &#39;1998-04-01 05:00:00&#39;, &#39;1998-04-01 05:15:00&#39;,
               &#39;1998-04-01 05:30:00&#39;, &#39;1998-04-01 05:45:00&#39;,
               &#39;1998-04-01 06:00:00&#39;, &#39;1998-04-01 06:15:00&#39;,
               &#39;1998-04-01 06:30:00&#39;, &#39;1998-04-01 06:45:00&#39;,
               &#39;1998-04-01 07:00:00&#39;, &#39;1998-04-01 07:15:00&#39;,
               &#39;1998-04-01 07:30:00&#39;, &#39;1998-04-01 07:45:00&#39;,
               &#39;1998-04-01 08:00:00&#39;, &#39;1998-04-01 08:15:00&#39;,
               &#39;1998-04-01 08:30:00&#39;, &#39;1998-04-01 08:45:00&#39;,
               &#39;1998-04-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-04-01 00:00:00&#39;, &#39;1998-04-01 00:15:00&#39;,
               &#39;1998-04-01 00:30:00&#39;, &#39;1998-04-01 00:45:00&#39;,
               &#39;1998-04-01 01:00:00&#39;, &#39;1998-04-01 01:15:00&#39;,
               &#39;1998-04-01 01:30:00&#39;, &#39;1998-04-01 01:45:00&#39;,
               &#39;1998-04-01 02:00:00&#39;, &#39;1998-04-01 02:15:00&#39;,
               ...
               &#39;1998-04-30 20:45:00&#39;, &#39;1998-04-30 21:00:00&#39;,
               &#39;1998-04-30 21:15:00&#39;, &#39;1998-04-30 21:30:00&#39;,
               &#39;1998-04-30 21:45:00&#39;, &#39;1998-04-30 22:00:00&#39;,
               &#39;1998-04-30 22:15:00&#39;, &#39;1998-04-30 22:30:00&#39;,
               &#39;1998-04-30 22:45:00&#39;, &#39;1998-04-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2877, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15275100 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-04-01 00:00:00&#39;, &#39;1998-04-01 00:15:00&#39;,
               &#39;1998-04-01 00:30:00&#39;, &#39;1998-04-01 00:45:00&#39;,
               &#39;1998-04-01 01:00:00&#39;, &#39;1998-04-01 01:15:00&#39;,
               &#39;1998-04-01 01:30:00&#39;, &#39;1998-04-01 01:45:00&#39;,
               &#39;1998-04-01 02:00:00&#39;, &#39;1998-04-01 02:15:00&#39;,
               ...
               &#39;1998-04-02 08:15:00&#39;, &#39;1998-04-02 08:30:00&#39;,
               &#39;1998-04-02 08:45:00&#39;, &#39;1998-04-02 09:00:00&#39;,
               &#39;1998-04-05 02:00:00&#39;, &#39;1998-04-05 02:15:00&#39;,
               &#39;1998-04-05 02:30:00&#39;, &#39;1998-04-05 02:45:00&#39;,
               &#39;1998-04-05 03:00:00&#39;, &#39;1998-04-05 03:15:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=139, freq=None).
processing final discharge data

Processing discharge for station 15284000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-4-1T00 to 1998-04-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-05-01 00:00:00&#39;, &#39;1998-05-01 00:15:00&#39;,
               &#39;1998-05-01 00:30:00&#39;, &#39;1998-05-01 00:45:00&#39;,
               &#39;1998-05-01 01:00:00&#39;, &#39;1998-05-01 01:15:00&#39;,
               &#39;1998-05-01 01:30:00&#39;, &#39;1998-05-01 01:45:00&#39;,
               &#39;1998-05-01 02:00:00&#39;, &#39;1998-05-01 02:15:00&#39;,
               &#39;1998-05-01 02:30:00&#39;, &#39;1998-05-01 02:45:00&#39;,
               &#39;1998-05-01 03:00:00&#39;, &#39;1998-05-01 03:15:00&#39;,
               &#39;1998-05-01 03:30:00&#39;, &#39;1998-05-01 03:45:00&#39;,
               &#39;1998-05-01 04:00:00&#39;, &#39;1998-05-01 04:15:00&#39;,
               &#39;1998-05-01 04:30:00&#39;, &#39;1998-05-01 04:45:00&#39;,
               &#39;1998-05-01 05:00:00&#39;, &#39;1998-05-01 05:15:00&#39;,
               &#39;1998-05-01 05:30:00&#39;, &#39;1998-05-01 05:45:00&#39;,
               &#39;1998-05-01 06:00:00&#39;, &#39;1998-05-01 06:15:00&#39;,
               &#39;1998-05-01 06:30:00&#39;, &#39;1998-05-01 06:45:00&#39;,
               &#39;1998-05-01 07:00:00&#39;, &#39;1998-05-01 07:15:00&#39;,
               &#39;1998-05-01 07:30:00&#39;, &#39;1998-05-01 07:45:00&#39;,
               &#39;1998-05-01 08:00:00&#39;, &#39;1998-05-01 16:30:00&#39;,
               &#39;1998-05-01 16:45:00&#39;, &#39;1998-05-01 17:00:00&#39;,
               &#39;1998-05-01 17:15:00&#39;, &#39;1998-05-01 17:30:00&#39;,
               &#39;1998-05-01 17:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15290000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-05-01 00:00:00&#39;, &#39;1998-05-01 00:15:00&#39;,
               &#39;1998-05-01 00:30:00&#39;, &#39;1998-05-01 00:45:00&#39;,
               &#39;1998-05-01 01:00:00&#39;, &#39;1998-05-01 01:15:00&#39;,
               &#39;1998-05-01 01:30:00&#39;, &#39;1998-05-01 01:45:00&#39;,
               &#39;1998-05-01 02:00:00&#39;, &#39;1998-05-01 02:15:00&#39;,
               &#39;1998-05-01 02:30:00&#39;, &#39;1998-05-01 02:45:00&#39;,
               &#39;1998-05-01 03:00:00&#39;, &#39;1998-05-01 03:15:00&#39;,
               &#39;1998-05-01 03:30:00&#39;, &#39;1998-05-01 03:45:00&#39;,
               &#39;1998-05-01 04:00:00&#39;, &#39;1998-05-01 04:15:00&#39;,
               &#39;1998-05-01 04:30:00&#39;, &#39;1998-05-01 04:45:00&#39;,
               &#39;1998-05-01 05:00:00&#39;, &#39;1998-05-01 05:15:00&#39;,
               &#39;1998-05-01 05:30:00&#39;, &#39;1998-05-01 05:45:00&#39;,
               &#39;1998-05-01 06:00:00&#39;, &#39;1998-05-01 06:15:00&#39;,
               &#39;1998-05-01 06:30:00&#39;, &#39;1998-05-01 06:45:00&#39;,
               &#39;1998-05-01 07:00:00&#39;, &#39;1998-05-01 07:15:00&#39;,
               &#39;1998-05-01 07:30:00&#39;, &#39;1998-05-01 07:45:00&#39;,
               &#39;1998-05-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15271000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-05-01 00:00:00&#39;, &#39;1998-05-01 00:15:00&#39;,
               &#39;1998-05-01 00:30:00&#39;, &#39;1998-05-01 00:45:00&#39;,
               &#39;1998-05-01 01:00:00&#39;, &#39;1998-05-01 01:15:00&#39;,
               &#39;1998-05-01 01:30:00&#39;, &#39;1998-05-01 01:45:00&#39;,
               &#39;1998-05-01 02:00:00&#39;, &#39;1998-05-01 02:15:00&#39;,
               &#39;1998-05-01 02:30:00&#39;, &#39;1998-05-01 02:45:00&#39;,
               &#39;1998-05-01 03:00:00&#39;, &#39;1998-05-01 03:15:00&#39;,
               &#39;1998-05-01 03:30:00&#39;, &#39;1998-05-01 03:45:00&#39;,
               &#39;1998-05-01 04:00:00&#39;, &#39;1998-05-01 04:15:00&#39;,
               &#39;1998-05-01 04:30:00&#39;, &#39;1998-05-01 04:45:00&#39;,
               &#39;1998-05-01 05:00:00&#39;, &#39;1998-05-01 05:15:00&#39;,
               &#39;1998-05-01 05:30:00&#39;, &#39;1998-05-01 05:45:00&#39;,
               &#39;1998-05-01 06:00:00&#39;, &#39;1998-05-01 06:15:00&#39;,
               &#39;1998-05-01 06:30:00&#39;, &#39;1998-05-01 06:45:00&#39;,
               &#39;1998-05-01 07:00:00&#39;, &#39;1998-05-01 07:15:00&#39;,
               &#39;1998-05-01 07:30:00&#39;, &#39;1998-05-01 07:45:00&#39;,
               &#39;1998-05-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239900 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-05-01 00:00:00&#39;, &#39;1998-05-01 00:15:00&#39;,
               &#39;1998-05-01 00:30:00&#39;, &#39;1998-05-01 00:45:00&#39;,
               &#39;1998-05-01 01:00:00&#39;, &#39;1998-05-01 01:15:00&#39;,
               &#39;1998-05-01 01:30:00&#39;, &#39;1998-05-01 01:45:00&#39;,
               &#39;1998-05-01 02:00:00&#39;, &#39;1998-05-01 02:15:00&#39;,
               &#39;1998-05-01 02:30:00&#39;, &#39;1998-05-01 02:45:00&#39;,
               &#39;1998-05-01 03:00:00&#39;, &#39;1998-05-01 03:15:00&#39;,
               &#39;1998-05-01 03:30:00&#39;, &#39;1998-05-01 03:45:00&#39;,
               &#39;1998-05-01 04:00:00&#39;, &#39;1998-05-01 04:15:00&#39;,
               &#39;1998-05-01 04:30:00&#39;, &#39;1998-05-01 04:45:00&#39;,
               &#39;1998-05-01 05:00:00&#39;, &#39;1998-05-01 05:15:00&#39;,
               &#39;1998-05-01 05:30:00&#39;, &#39;1998-05-01 05:45:00&#39;,
               &#39;1998-05-01 06:00:00&#39;, &#39;1998-05-01 06:15:00&#39;,
               &#39;1998-05-01 06:30:00&#39;, &#39;1998-05-01 06:45:00&#39;,
               &#39;1998-05-01 07:00:00&#39;, &#39;1998-05-01 07:15:00&#39;,
               &#39;1998-05-01 07:30:00&#39;, &#39;1998-05-01 07:45:00&#39;,
               &#39;1998-05-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-05-01 00:00:00&#39;, &#39;1998-05-01 00:15:00&#39;,
               &#39;1998-05-01 00:30:00&#39;, &#39;1998-05-01 00:45:00&#39;,
               &#39;1998-05-01 01:00:00&#39;, &#39;1998-05-01 01:15:00&#39;,
               &#39;1998-05-01 01:30:00&#39;, &#39;1998-05-01 01:45:00&#39;,
               &#39;1998-05-01 02:00:00&#39;, &#39;1998-05-01 02:15:00&#39;,
               ...
               &#39;1998-05-31 20:45:00&#39;, &#39;1998-05-31 21:00:00&#39;,
               &#39;1998-05-31 21:15:00&#39;, &#39;1998-05-31 21:30:00&#39;,
               &#39;1998-05-31 21:45:00&#39;, &#39;1998-05-31 22:00:00&#39;,
               &#39;1998-05-31 22:15:00&#39;, &#39;1998-05-31 22:30:00&#39;,
               &#39;1998-05-31 22:45:00&#39;, &#39;1998-05-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2973, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15275100 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-05-01 00:00:00&#39;, &#39;1998-05-01 00:15:00&#39;,
               &#39;1998-05-01 00:30:00&#39;, &#39;1998-05-01 00:45:00&#39;,
               &#39;1998-05-01 01:00:00&#39;, &#39;1998-05-01 01:15:00&#39;,
               &#39;1998-05-01 01:30:00&#39;, &#39;1998-05-01 01:45:00&#39;,
               &#39;1998-05-01 02:00:00&#39;, &#39;1998-05-01 02:15:00&#39;,
               &#39;1998-05-01 02:30:00&#39;, &#39;1998-05-01 02:45:00&#39;,
               &#39;1998-05-01 03:00:00&#39;, &#39;1998-05-01 03:15:00&#39;,
               &#39;1998-05-01 03:30:00&#39;, &#39;1998-05-01 03:45:00&#39;,
               &#39;1998-05-01 04:00:00&#39;, &#39;1998-05-01 04:15:00&#39;,
               &#39;1998-05-01 04:30:00&#39;, &#39;1998-05-01 04:45:00&#39;,
               &#39;1998-05-01 05:00:00&#39;, &#39;1998-05-01 05:15:00&#39;,
               &#39;1998-05-01 05:30:00&#39;, &#39;1998-05-01 05:45:00&#39;,
               &#39;1998-05-01 06:00:00&#39;, &#39;1998-05-01 06:15:00&#39;,
               &#39;1998-05-01 06:30:00&#39;, &#39;1998-05-01 06:45:00&#39;,
               &#39;1998-05-01 07:00:00&#39;, &#39;1998-05-01 07:15:00&#39;,
               &#39;1998-05-01 07:30:00&#39;, &#39;1998-05-01 07:45:00&#39;,
               &#39;1998-05-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15284000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-5-1T00 to 1998-05-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-06-01 00:00:00&#39;, &#39;1998-06-01 00:15:00&#39;,
               &#39;1998-06-01 00:30:00&#39;, &#39;1998-06-01 00:45:00&#39;,
               &#39;1998-06-01 01:00:00&#39;, &#39;1998-06-01 01:15:00&#39;,
               &#39;1998-06-01 01:30:00&#39;, &#39;1998-06-01 01:45:00&#39;,
               &#39;1998-06-01 02:00:00&#39;, &#39;1998-06-01 02:15:00&#39;,
               &#39;1998-06-01 02:30:00&#39;, &#39;1998-06-01 02:45:00&#39;,
               &#39;1998-06-01 03:00:00&#39;, &#39;1998-06-01 03:15:00&#39;,
               &#39;1998-06-01 03:30:00&#39;, &#39;1998-06-01 03:45:00&#39;,
               &#39;1998-06-01 04:00:00&#39;, &#39;1998-06-01 04:15:00&#39;,
               &#39;1998-06-01 04:30:00&#39;, &#39;1998-06-01 04:45:00&#39;,
               &#39;1998-06-01 05:00:00&#39;, &#39;1998-06-01 05:15:00&#39;,
               &#39;1998-06-01 05:30:00&#39;, &#39;1998-06-01 05:45:00&#39;,
               &#39;1998-06-01 06:00:00&#39;, &#39;1998-06-01 06:15:00&#39;,
               &#39;1998-06-01 06:30:00&#39;, &#39;1998-06-01 06:45:00&#39;,
               &#39;1998-06-01 07:00:00&#39;, &#39;1998-06-01 07:15:00&#39;,
               &#39;1998-06-01 07:30:00&#39;, &#39;1998-06-01 07:45:00&#39;,
               &#39;1998-06-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-06-01 00:00:00&#39;, &#39;1998-06-01 00:15:00&#39;,
               &#39;1998-06-01 00:30:00&#39;, &#39;1998-06-01 00:45:00&#39;,
               &#39;1998-06-01 01:00:00&#39;, &#39;1998-06-01 01:15:00&#39;,
               &#39;1998-06-01 01:30:00&#39;, &#39;1998-06-01 01:45:00&#39;,
               &#39;1998-06-01 02:00:00&#39;, &#39;1998-06-01 02:15:00&#39;,
               &#39;1998-06-01 02:30:00&#39;, &#39;1998-06-01 02:45:00&#39;,
               &#39;1998-06-01 03:00:00&#39;, &#39;1998-06-01 03:15:00&#39;,
               &#39;1998-06-01 03:30:00&#39;, &#39;1998-06-01 03:45:00&#39;,
               &#39;1998-06-01 04:00:00&#39;, &#39;1998-06-01 04:15:00&#39;,
               &#39;1998-06-01 04:30:00&#39;, &#39;1998-06-01 04:45:00&#39;,
               &#39;1998-06-01 05:00:00&#39;, &#39;1998-06-01 05:15:00&#39;,
               &#39;1998-06-01 05:30:00&#39;, &#39;1998-06-01 05:45:00&#39;,
               &#39;1998-06-01 06:00:00&#39;, &#39;1998-06-01 06:15:00&#39;,
               &#39;1998-06-01 06:30:00&#39;, &#39;1998-06-01 06:45:00&#39;,
               &#39;1998-06-01 07:00:00&#39;, &#39;1998-06-01 07:15:00&#39;,
               &#39;1998-06-01 07:30:00&#39;, &#39;1998-06-01 07:45:00&#39;,
               &#39;1998-06-01 08:00:00&#39;, &#39;1998-06-16 11:15:00&#39;,
               &#39;1998-06-16 11:30:00&#39;, &#39;1998-06-16 11:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15271000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-06-01 00:00:00&#39;, &#39;1998-06-01 00:15:00&#39;,
               &#39;1998-06-01 00:30:00&#39;, &#39;1998-06-01 00:45:00&#39;,
               &#39;1998-06-01 01:00:00&#39;, &#39;1998-06-01 01:15:00&#39;,
               &#39;1998-06-01 01:30:00&#39;, &#39;1998-06-01 01:45:00&#39;,
               &#39;1998-06-01 02:00:00&#39;, &#39;1998-06-01 02:15:00&#39;,
               &#39;1998-06-01 02:30:00&#39;, &#39;1998-06-01 02:45:00&#39;,
               &#39;1998-06-01 03:00:00&#39;, &#39;1998-06-01 03:15:00&#39;,
               &#39;1998-06-01 03:30:00&#39;, &#39;1998-06-01 03:45:00&#39;,
               &#39;1998-06-01 04:00:00&#39;, &#39;1998-06-01 04:15:00&#39;,
               &#39;1998-06-01 04:30:00&#39;, &#39;1998-06-01 04:45:00&#39;,
               &#39;1998-06-01 05:00:00&#39;, &#39;1998-06-01 05:15:00&#39;,
               &#39;1998-06-01 05:30:00&#39;, &#39;1998-06-01 05:45:00&#39;,
               &#39;1998-06-01 06:00:00&#39;, &#39;1998-06-01 06:15:00&#39;,
               &#39;1998-06-01 06:30:00&#39;, &#39;1998-06-01 06:45:00&#39;,
               &#39;1998-06-01 07:00:00&#39;, &#39;1998-06-01 07:15:00&#39;,
               &#39;1998-06-01 07:30:00&#39;, &#39;1998-06-01 07:45:00&#39;,
               &#39;1998-06-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239900 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-06-01 00:00:00&#39;, &#39;1998-06-01 00:15:00&#39;,
               &#39;1998-06-01 00:30:00&#39;, &#39;1998-06-01 00:45:00&#39;,
               &#39;1998-06-01 01:00:00&#39;, &#39;1998-06-01 01:15:00&#39;,
               &#39;1998-06-01 01:30:00&#39;, &#39;1998-06-01 01:45:00&#39;,
               &#39;1998-06-01 02:00:00&#39;, &#39;1998-06-01 02:15:00&#39;,
               &#39;1998-06-01 02:30:00&#39;, &#39;1998-06-01 02:45:00&#39;,
               &#39;1998-06-01 03:00:00&#39;, &#39;1998-06-01 03:15:00&#39;,
               &#39;1998-06-01 03:30:00&#39;, &#39;1998-06-01 03:45:00&#39;,
               &#39;1998-06-01 04:00:00&#39;, &#39;1998-06-01 04:15:00&#39;,
               &#39;1998-06-01 04:30:00&#39;, &#39;1998-06-01 04:45:00&#39;,
               &#39;1998-06-01 05:00:00&#39;, &#39;1998-06-01 05:15:00&#39;,
               &#39;1998-06-01 05:30:00&#39;, &#39;1998-06-01 05:45:00&#39;,
               &#39;1998-06-01 06:00:00&#39;, &#39;1998-06-01 06:15:00&#39;,
               &#39;1998-06-01 06:30:00&#39;, &#39;1998-06-01 06:45:00&#39;,
               &#39;1998-06-01 07:00:00&#39;, &#39;1998-06-01 07:15:00&#39;,
               &#39;1998-06-01 07:30:00&#39;, &#39;1998-06-01 07:45:00&#39;,
               &#39;1998-06-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-06-01 00:00:00&#39;, &#39;1998-06-01 00:15:00&#39;,
               &#39;1998-06-01 00:30:00&#39;, &#39;1998-06-01 00:45:00&#39;,
               &#39;1998-06-01 01:00:00&#39;, &#39;1998-06-01 01:15:00&#39;,
               &#39;1998-06-01 01:30:00&#39;, &#39;1998-06-01 01:45:00&#39;,
               &#39;1998-06-01 02:00:00&#39;, &#39;1998-06-01 02:15:00&#39;,
               ...
               &#39;1998-06-30 20:45:00&#39;, &#39;1998-06-30 21:00:00&#39;,
               &#39;1998-06-30 21:15:00&#39;, &#39;1998-06-30 21:30:00&#39;,
               &#39;1998-06-30 21:45:00&#39;, &#39;1998-06-30 22:00:00&#39;,
               &#39;1998-06-30 22:15:00&#39;, &#39;1998-06-30 22:30:00&#39;,
               &#39;1998-06-30 22:45:00&#39;, &#39;1998-06-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2877, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15275100 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-06-01 00:00:00&#39;, &#39;1998-06-01 00:15:00&#39;,
               &#39;1998-06-01 00:30:00&#39;, &#39;1998-06-01 00:45:00&#39;,
               &#39;1998-06-01 01:00:00&#39;, &#39;1998-06-01 01:15:00&#39;,
               &#39;1998-06-01 01:30:00&#39;, &#39;1998-06-01 01:45:00&#39;,
               &#39;1998-06-01 02:00:00&#39;, &#39;1998-06-01 02:15:00&#39;,
               &#39;1998-06-01 02:30:00&#39;, &#39;1998-06-01 02:45:00&#39;,
               &#39;1998-06-01 03:00:00&#39;, &#39;1998-06-01 03:15:00&#39;,
               &#39;1998-06-01 03:30:00&#39;, &#39;1998-06-01 03:45:00&#39;,
               &#39;1998-06-01 04:00:00&#39;, &#39;1998-06-01 04:15:00&#39;,
               &#39;1998-06-01 04:30:00&#39;, &#39;1998-06-01 04:45:00&#39;,
               &#39;1998-06-01 05:00:00&#39;, &#39;1998-06-01 05:15:00&#39;,
               &#39;1998-06-01 05:30:00&#39;, &#39;1998-06-01 05:45:00&#39;,
               &#39;1998-06-01 06:00:00&#39;, &#39;1998-06-01 06:15:00&#39;,
               &#39;1998-06-01 06:30:00&#39;, &#39;1998-06-01 06:45:00&#39;,
               &#39;1998-06-01 07:00:00&#39;, &#39;1998-06-01 07:15:00&#39;,
               &#39;1998-06-01 07:30:00&#39;, &#39;1998-06-01 07:45:00&#39;,
               &#39;1998-06-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15284000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-6-1T00 to 1998-06-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-07-01 00:00:00&#39;, &#39;1998-07-01 00:15:00&#39;,
               &#39;1998-07-01 00:30:00&#39;, &#39;1998-07-01 00:45:00&#39;,
               &#39;1998-07-01 01:00:00&#39;, &#39;1998-07-01 01:15:00&#39;,
               &#39;1998-07-01 01:30:00&#39;, &#39;1998-07-01 01:45:00&#39;,
               &#39;1998-07-01 02:00:00&#39;, &#39;1998-07-01 02:15:00&#39;,
               &#39;1998-07-01 02:30:00&#39;, &#39;1998-07-01 02:45:00&#39;,
               &#39;1998-07-01 03:00:00&#39;, &#39;1998-07-01 03:15:00&#39;,
               &#39;1998-07-01 03:30:00&#39;, &#39;1998-07-01 03:45:00&#39;,
               &#39;1998-07-01 04:00:00&#39;, &#39;1998-07-01 04:15:00&#39;,
               &#39;1998-07-01 04:30:00&#39;, &#39;1998-07-01 04:45:00&#39;,
               &#39;1998-07-01 05:00:00&#39;, &#39;1998-07-01 05:15:00&#39;,
               &#39;1998-07-01 05:30:00&#39;, &#39;1998-07-01 05:45:00&#39;,
               &#39;1998-07-01 06:00:00&#39;, &#39;1998-07-01 06:15:00&#39;,
               &#39;1998-07-01 06:30:00&#39;, &#39;1998-07-01 06:45:00&#39;,
               &#39;1998-07-01 07:00:00&#39;, &#39;1998-07-01 07:15:00&#39;,
               &#39;1998-07-01 07:30:00&#39;, &#39;1998-07-01 07:45:00&#39;,
               &#39;1998-07-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-07-01 00:00:00&#39;, &#39;1998-07-01 00:15:00&#39;,
               &#39;1998-07-01 00:30:00&#39;, &#39;1998-07-01 00:45:00&#39;,
               &#39;1998-07-01 01:00:00&#39;, &#39;1998-07-01 01:15:00&#39;,
               &#39;1998-07-01 01:30:00&#39;, &#39;1998-07-01 01:45:00&#39;,
               &#39;1998-07-01 02:00:00&#39;, &#39;1998-07-01 02:15:00&#39;,
               &#39;1998-07-01 02:30:00&#39;, &#39;1998-07-01 02:45:00&#39;,
               &#39;1998-07-01 03:00:00&#39;, &#39;1998-07-01 03:15:00&#39;,
               &#39;1998-07-01 03:30:00&#39;, &#39;1998-07-01 03:45:00&#39;,
               &#39;1998-07-01 04:00:00&#39;, &#39;1998-07-01 04:15:00&#39;,
               &#39;1998-07-01 04:30:00&#39;, &#39;1998-07-01 04:45:00&#39;,
               &#39;1998-07-01 05:00:00&#39;, &#39;1998-07-01 05:15:00&#39;,
               &#39;1998-07-01 05:30:00&#39;, &#39;1998-07-01 05:45:00&#39;,
               &#39;1998-07-01 06:00:00&#39;, &#39;1998-07-01 06:15:00&#39;,
               &#39;1998-07-01 06:30:00&#39;, &#39;1998-07-01 06:45:00&#39;,
               &#39;1998-07-01 07:00:00&#39;, &#39;1998-07-01 07:15:00&#39;,
               &#39;1998-07-01 07:30:00&#39;, &#39;1998-07-01 07:45:00&#39;,
               &#39;1998-07-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15271000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-07-01 00:00:00&#39;, &#39;1998-07-01 00:15:00&#39;,
               &#39;1998-07-01 00:30:00&#39;, &#39;1998-07-01 00:45:00&#39;,
               &#39;1998-07-01 01:00:00&#39;, &#39;1998-07-01 01:15:00&#39;,
               &#39;1998-07-01 01:30:00&#39;, &#39;1998-07-01 01:45:00&#39;,
               &#39;1998-07-01 02:00:00&#39;, &#39;1998-07-01 02:15:00&#39;,
               ...
               &#39;1998-07-31 05:45:00&#39;, &#39;1998-07-31 06:00:00&#39;,
               &#39;1998-07-31 06:15:00&#39;, &#39;1998-07-31 06:30:00&#39;,
               &#39;1998-07-31 06:45:00&#39;, &#39;1998-07-31 07:00:00&#39;,
               &#39;1998-07-31 07:15:00&#39;, &#39;1998-07-31 07:30:00&#39;,
               &#39;1998-07-31 07:45:00&#39;, &#39;1998-07-31 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=131, freq=None).
processing final discharge data

Processing discharge for station 15239900 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-07-01 00:00:00&#39;, &#39;1998-07-01 00:15:00&#39;,
               &#39;1998-07-01 00:30:00&#39;, &#39;1998-07-01 00:45:00&#39;,
               &#39;1998-07-01 01:00:00&#39;, &#39;1998-07-01 01:15:00&#39;,
               &#39;1998-07-01 01:30:00&#39;, &#39;1998-07-01 01:45:00&#39;,
               &#39;1998-07-01 02:00:00&#39;, &#39;1998-07-01 02:15:00&#39;,
               &#39;1998-07-01 02:30:00&#39;, &#39;1998-07-01 02:45:00&#39;,
               &#39;1998-07-01 03:00:00&#39;, &#39;1998-07-01 03:15:00&#39;,
               &#39;1998-07-01 03:30:00&#39;, &#39;1998-07-01 03:45:00&#39;,
               &#39;1998-07-01 04:00:00&#39;, &#39;1998-07-01 04:15:00&#39;,
               &#39;1998-07-01 04:30:00&#39;, &#39;1998-07-01 04:45:00&#39;,
               &#39;1998-07-01 05:00:00&#39;, &#39;1998-07-01 05:15:00&#39;,
               &#39;1998-07-01 05:30:00&#39;, &#39;1998-07-01 05:45:00&#39;,
               &#39;1998-07-01 06:00:00&#39;, &#39;1998-07-01 06:15:00&#39;,
               &#39;1998-07-01 06:30:00&#39;, &#39;1998-07-01 06:45:00&#39;,
               &#39;1998-07-01 07:00:00&#39;, &#39;1998-07-01 07:15:00&#39;,
               &#39;1998-07-01 07:30:00&#39;, &#39;1998-07-01 07:45:00&#39;,
               &#39;1998-07-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-07-01 00:00:00&#39;, &#39;1998-07-01 00:15:00&#39;,
               &#39;1998-07-01 00:30:00&#39;, &#39;1998-07-01 00:45:00&#39;,
               &#39;1998-07-01 01:00:00&#39;, &#39;1998-07-01 01:15:00&#39;,
               &#39;1998-07-01 01:30:00&#39;, &#39;1998-07-01 01:45:00&#39;,
               &#39;1998-07-01 02:00:00&#39;, &#39;1998-07-01 02:15:00&#39;,
               ...
               &#39;1998-07-31 20:45:00&#39;, &#39;1998-07-31 21:00:00&#39;,
               &#39;1998-07-31 21:15:00&#39;, &#39;1998-07-31 21:30:00&#39;,
               &#39;1998-07-31 21:45:00&#39;, &#39;1998-07-31 22:00:00&#39;,
               &#39;1998-07-31 22:15:00&#39;, &#39;1998-07-31 22:30:00&#39;,
               &#39;1998-07-31 22:45:00&#39;, &#39;1998-07-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2973, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15275100 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-07-01 00:00:00&#39;, &#39;1998-07-01 00:15:00&#39;,
               &#39;1998-07-01 00:30:00&#39;, &#39;1998-07-01 00:45:00&#39;,
               &#39;1998-07-01 01:00:00&#39;, &#39;1998-07-01 01:15:00&#39;,
               &#39;1998-07-01 01:30:00&#39;, &#39;1998-07-01 01:45:00&#39;,
               &#39;1998-07-01 02:00:00&#39;, &#39;1998-07-01 02:15:00&#39;,
               &#39;1998-07-01 02:30:00&#39;, &#39;1998-07-01 02:45:00&#39;,
               &#39;1998-07-01 03:00:00&#39;, &#39;1998-07-01 03:15:00&#39;,
               &#39;1998-07-01 03:30:00&#39;, &#39;1998-07-01 03:45:00&#39;,
               &#39;1998-07-01 04:00:00&#39;, &#39;1998-07-01 04:15:00&#39;,
               &#39;1998-07-01 04:30:00&#39;, &#39;1998-07-01 04:45:00&#39;,
               &#39;1998-07-01 05:00:00&#39;, &#39;1998-07-01 05:15:00&#39;,
               &#39;1998-07-01 05:30:00&#39;, &#39;1998-07-01 05:45:00&#39;,
               &#39;1998-07-01 06:00:00&#39;, &#39;1998-07-01 06:15:00&#39;,
               &#39;1998-07-01 06:30:00&#39;, &#39;1998-07-01 06:45:00&#39;,
               &#39;1998-07-01 07:00:00&#39;, &#39;1998-07-01 07:15:00&#39;,
               &#39;1998-07-01 07:30:00&#39;, &#39;1998-07-01 07:45:00&#39;,
               &#39;1998-07-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15284000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-7-1T00 to 1998-07-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-08-01 00:00:00&#39;, &#39;1998-08-01 00:15:00&#39;,
               &#39;1998-08-01 00:30:00&#39;, &#39;1998-08-01 00:45:00&#39;,
               &#39;1998-08-01 01:00:00&#39;, &#39;1998-08-01 01:15:00&#39;,
               &#39;1998-08-01 01:30:00&#39;, &#39;1998-08-01 01:45:00&#39;,
               &#39;1998-08-01 02:00:00&#39;, &#39;1998-08-01 02:15:00&#39;,
               &#39;1998-08-01 02:30:00&#39;, &#39;1998-08-01 02:45:00&#39;,
               &#39;1998-08-01 03:00:00&#39;, &#39;1998-08-01 03:15:00&#39;,
               &#39;1998-08-01 03:30:00&#39;, &#39;1998-08-01 03:45:00&#39;,
               &#39;1998-08-01 04:00:00&#39;, &#39;1998-08-01 04:15:00&#39;,
               &#39;1998-08-01 04:30:00&#39;, &#39;1998-08-01 04:45:00&#39;,
               &#39;1998-08-01 05:00:00&#39;, &#39;1998-08-01 05:15:00&#39;,
               &#39;1998-08-01 05:30:00&#39;, &#39;1998-08-01 05:45:00&#39;,
               &#39;1998-08-01 06:00:00&#39;, &#39;1998-08-01 06:15:00&#39;,
               &#39;1998-08-01 06:30:00&#39;, &#39;1998-08-01 06:45:00&#39;,
               &#39;1998-08-01 07:00:00&#39;, &#39;1998-08-01 07:15:00&#39;,
               &#39;1998-08-01 07:30:00&#39;, &#39;1998-08-01 07:45:00&#39;,
               &#39;1998-08-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-08-01 00:00:00&#39;, &#39;1998-08-01 00:15:00&#39;,
               &#39;1998-08-01 00:30:00&#39;, &#39;1998-08-01 00:45:00&#39;,
               &#39;1998-08-01 01:00:00&#39;, &#39;1998-08-01 01:15:00&#39;,
               &#39;1998-08-01 01:30:00&#39;, &#39;1998-08-01 01:45:00&#39;,
               &#39;1998-08-01 02:00:00&#39;, &#39;1998-08-01 02:15:00&#39;,
               &#39;1998-08-01 02:30:00&#39;, &#39;1998-08-01 02:45:00&#39;,
               &#39;1998-08-01 03:00:00&#39;, &#39;1998-08-01 03:15:00&#39;,
               &#39;1998-08-01 03:30:00&#39;, &#39;1998-08-01 03:45:00&#39;,
               &#39;1998-08-01 04:00:00&#39;, &#39;1998-08-01 04:15:00&#39;,
               &#39;1998-08-01 04:30:00&#39;, &#39;1998-08-01 04:45:00&#39;,
               &#39;1998-08-01 05:00:00&#39;, &#39;1998-08-01 05:15:00&#39;,
               &#39;1998-08-01 05:30:00&#39;, &#39;1998-08-01 05:45:00&#39;,
               &#39;1998-08-01 06:00:00&#39;, &#39;1998-08-01 06:15:00&#39;,
               &#39;1998-08-01 06:30:00&#39;, &#39;1998-08-01 06:45:00&#39;,
               &#39;1998-08-01 07:00:00&#39;, &#39;1998-08-01 07:15:00&#39;,
               &#39;1998-08-01 07:30:00&#39;, &#39;1998-08-01 07:45:00&#39;,
               &#39;1998-08-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15271000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-08-01 00:00:00&#39;, &#39;1998-08-01 00:15:00&#39;,
               &#39;1998-08-01 00:30:00&#39;, &#39;1998-08-01 00:45:00&#39;,
               &#39;1998-08-01 01:00:00&#39;, &#39;1998-08-01 01:15:00&#39;,
               &#39;1998-08-01 01:30:00&#39;, &#39;1998-08-01 01:45:00&#39;,
               &#39;1998-08-01 02:00:00&#39;, &#39;1998-08-01 02:15:00&#39;,
               &#39;1998-08-01 02:30:00&#39;, &#39;1998-08-01 02:45:00&#39;,
               &#39;1998-08-01 03:00:00&#39;, &#39;1998-08-01 03:15:00&#39;,
               &#39;1998-08-01 03:30:00&#39;, &#39;1998-08-01 03:45:00&#39;,
               &#39;1998-08-01 04:00:00&#39;, &#39;1998-08-01 04:15:00&#39;,
               &#39;1998-08-01 04:30:00&#39;, &#39;1998-08-01 04:45:00&#39;,
               &#39;1998-08-01 05:00:00&#39;, &#39;1998-08-01 05:15:00&#39;,
               &#39;1998-08-01 05:30:00&#39;, &#39;1998-08-01 05:45:00&#39;,
               &#39;1998-08-01 06:00:00&#39;, &#39;1998-08-01 06:15:00&#39;,
               &#39;1998-08-01 06:30:00&#39;, &#39;1998-08-01 06:45:00&#39;,
               &#39;1998-08-01 07:00:00&#39;, &#39;1998-08-01 07:15:00&#39;,
               &#39;1998-08-01 07:30:00&#39;, &#39;1998-08-01 07:45:00&#39;,
               &#39;1998-08-01 08:00:00&#39;, &#39;1998-08-19 19:30:00&#39;,
               &#39;1998-08-19 19:45:00&#39;, &#39;1998-08-19 20:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15239900 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-08-01 00:00:00&#39;, &#39;1998-08-01 00:15:00&#39;,
               &#39;1998-08-01 00:30:00&#39;, &#39;1998-08-01 00:45:00&#39;,
               &#39;1998-08-01 01:00:00&#39;, &#39;1998-08-01 01:15:00&#39;,
               &#39;1998-08-01 01:30:00&#39;, &#39;1998-08-01 01:45:00&#39;,
               &#39;1998-08-01 02:00:00&#39;, &#39;1998-08-01 02:15:00&#39;,
               ...
               &#39;1998-08-15 05:45:00&#39;, &#39;1998-08-15 06:00:00&#39;,
               &#39;1998-08-15 06:15:00&#39;, &#39;1998-08-15 06:30:00&#39;,
               &#39;1998-08-15 06:45:00&#39;, &#39;1998-08-15 07:00:00&#39;,
               &#39;1998-08-15 07:15:00&#39;, &#39;1998-08-15 07:30:00&#39;,
               &#39;1998-08-15 07:45:00&#39;, &#39;1998-08-15 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=131, freq=None).
processing final discharge data

Processing discharge for station 15239070 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-08-01 00:00:00&#39;, &#39;1998-08-01 00:15:00&#39;,
               &#39;1998-08-01 00:30:00&#39;, &#39;1998-08-01 00:45:00&#39;,
               &#39;1998-08-01 01:00:00&#39;, &#39;1998-08-01 01:15:00&#39;,
               &#39;1998-08-01 01:30:00&#39;, &#39;1998-08-01 01:45:00&#39;,
               &#39;1998-08-01 02:00:00&#39;, &#39;1998-08-01 02:15:00&#39;,
               ...
               &#39;1998-08-31 20:45:00&#39;, &#39;1998-08-31 21:00:00&#39;,
               &#39;1998-08-31 21:15:00&#39;, &#39;1998-08-31 21:30:00&#39;,
               &#39;1998-08-31 21:45:00&#39;, &#39;1998-08-31 22:00:00&#39;,
               &#39;1998-08-31 22:15:00&#39;, &#39;1998-08-31 22:30:00&#39;,
               &#39;1998-08-31 22:45:00&#39;, &#39;1998-08-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2973, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15275100 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-08-01 00:00:00&#39;, &#39;1998-08-01 00:15:00&#39;,
               &#39;1998-08-01 00:30:00&#39;, &#39;1998-08-01 00:45:00&#39;,
               &#39;1998-08-01 01:00:00&#39;, &#39;1998-08-01 01:15:00&#39;,
               &#39;1998-08-01 01:30:00&#39;, &#39;1998-08-01 01:45:00&#39;,
               &#39;1998-08-01 02:00:00&#39;, &#39;1998-08-01 02:15:00&#39;,
               &#39;1998-08-01 02:30:00&#39;, &#39;1998-08-01 02:45:00&#39;,
               &#39;1998-08-01 03:00:00&#39;, &#39;1998-08-01 03:15:00&#39;,
               &#39;1998-08-01 03:30:00&#39;, &#39;1998-08-01 03:45:00&#39;,
               &#39;1998-08-01 04:00:00&#39;, &#39;1998-08-01 04:15:00&#39;,
               &#39;1998-08-01 04:30:00&#39;, &#39;1998-08-01 04:45:00&#39;,
               &#39;1998-08-01 05:00:00&#39;, &#39;1998-08-01 05:15:00&#39;,
               &#39;1998-08-01 05:30:00&#39;, &#39;1998-08-01 05:45:00&#39;,
               &#39;1998-08-01 06:00:00&#39;, &#39;1998-08-01 06:15:00&#39;,
               &#39;1998-08-01 06:30:00&#39;, &#39;1998-08-01 06:45:00&#39;,
               &#39;1998-08-01 07:00:00&#39;, &#39;1998-08-01 07:15:00&#39;,
               &#39;1998-08-01 07:30:00&#39;, &#39;1998-08-01 07:45:00&#39;,
               &#39;1998-08-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15284000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-8-1T00 to 1998-08-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-09-01 00:00:00&#39;, &#39;1998-09-01 00:15:00&#39;,
               &#39;1998-09-01 00:30:00&#39;, &#39;1998-09-01 00:45:00&#39;,
               &#39;1998-09-01 01:00:00&#39;, &#39;1998-09-01 01:15:00&#39;,
               &#39;1998-09-01 01:30:00&#39;, &#39;1998-09-01 01:45:00&#39;,
               &#39;1998-09-01 02:00:00&#39;, &#39;1998-09-01 02:15:00&#39;,
               &#39;1998-09-01 02:30:00&#39;, &#39;1998-09-01 02:45:00&#39;,
               &#39;1998-09-01 03:00:00&#39;, &#39;1998-09-01 03:15:00&#39;,
               &#39;1998-09-01 03:30:00&#39;, &#39;1998-09-01 03:45:00&#39;,
               &#39;1998-09-01 04:00:00&#39;, &#39;1998-09-01 04:15:00&#39;,
               &#39;1998-09-01 04:30:00&#39;, &#39;1998-09-01 04:45:00&#39;,
               &#39;1998-09-01 05:00:00&#39;, &#39;1998-09-01 05:15:00&#39;,
               &#39;1998-09-01 05:30:00&#39;, &#39;1998-09-01 05:45:00&#39;,
               &#39;1998-09-01 06:00:00&#39;, &#39;1998-09-01 06:15:00&#39;,
               &#39;1998-09-01 06:30:00&#39;, &#39;1998-09-01 06:45:00&#39;,
               &#39;1998-09-01 07:00:00&#39;, &#39;1998-09-01 07:15:00&#39;,
               &#39;1998-09-01 07:30:00&#39;, &#39;1998-09-01 07:45:00&#39;,
               &#39;1998-09-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15290000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-09-01 00:00:00&#39;, &#39;1998-09-01 00:15:00&#39;,
               &#39;1998-09-01 00:30:00&#39;, &#39;1998-09-01 00:45:00&#39;,
               &#39;1998-09-01 01:00:00&#39;, &#39;1998-09-01 01:15:00&#39;,
               &#39;1998-09-01 01:30:00&#39;, &#39;1998-09-01 01:45:00&#39;,
               &#39;1998-09-01 02:00:00&#39;, &#39;1998-09-01 02:15:00&#39;,
               &#39;1998-09-01 02:30:00&#39;, &#39;1998-09-01 02:45:00&#39;,
               &#39;1998-09-01 03:00:00&#39;, &#39;1998-09-01 03:15:00&#39;,
               &#39;1998-09-01 03:30:00&#39;, &#39;1998-09-01 03:45:00&#39;,
               &#39;1998-09-01 04:00:00&#39;, &#39;1998-09-01 04:15:00&#39;,
               &#39;1998-09-01 04:30:00&#39;, &#39;1998-09-01 04:45:00&#39;,
               &#39;1998-09-01 05:00:00&#39;, &#39;1998-09-01 05:15:00&#39;,
               &#39;1998-09-01 05:30:00&#39;, &#39;1998-09-01 05:45:00&#39;,
               &#39;1998-09-01 06:00:00&#39;, &#39;1998-09-01 06:15:00&#39;,
               &#39;1998-09-01 06:30:00&#39;, &#39;1998-09-01 06:45:00&#39;,
               &#39;1998-09-01 07:00:00&#39;, &#39;1998-09-01 07:15:00&#39;,
               &#39;1998-09-01 07:30:00&#39;, &#39;1998-09-01 07:45:00&#39;,
               &#39;1998-09-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15271000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-09-01 00:00:00&#39;, &#39;1998-09-01 00:15:00&#39;,
               &#39;1998-09-01 00:30:00&#39;, &#39;1998-09-01 00:45:00&#39;,
               &#39;1998-09-01 01:00:00&#39;, &#39;1998-09-01 01:15:00&#39;,
               &#39;1998-09-01 01:30:00&#39;, &#39;1998-09-01 01:45:00&#39;,
               &#39;1998-09-01 02:00:00&#39;, &#39;1998-09-01 02:15:00&#39;,
               &#39;1998-09-01 02:30:00&#39;, &#39;1998-09-01 02:45:00&#39;,
               &#39;1998-09-01 03:00:00&#39;, &#39;1998-09-01 03:15:00&#39;,
               &#39;1998-09-01 03:30:00&#39;, &#39;1998-09-01 03:45:00&#39;,
               &#39;1998-09-01 04:00:00&#39;, &#39;1998-09-01 04:15:00&#39;,
               &#39;1998-09-01 04:30:00&#39;, &#39;1998-09-01 04:45:00&#39;,
               &#39;1998-09-01 05:00:00&#39;, &#39;1998-09-01 05:15:00&#39;,
               &#39;1998-09-01 05:30:00&#39;, &#39;1998-09-01 05:45:00&#39;,
               &#39;1998-09-01 06:00:00&#39;, &#39;1998-09-01 06:15:00&#39;,
               &#39;1998-09-01 06:30:00&#39;, &#39;1998-09-01 06:45:00&#39;,
               &#39;1998-09-01 07:00:00&#39;, &#39;1998-09-01 07:15:00&#39;,
               &#39;1998-09-01 07:30:00&#39;, &#39;1998-09-01 07:45:00&#39;,
               &#39;1998-09-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239900 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-09-01 00:00:00&#39;, &#39;1998-09-01 00:15:00&#39;,
               &#39;1998-09-01 00:30:00&#39;, &#39;1998-09-01 00:45:00&#39;,
               &#39;1998-09-01 01:00:00&#39;, &#39;1998-09-01 01:15:00&#39;,
               &#39;1998-09-01 01:30:00&#39;, &#39;1998-09-01 01:45:00&#39;,
               &#39;1998-09-01 02:00:00&#39;, &#39;1998-09-01 02:15:00&#39;,
               &#39;1998-09-01 02:30:00&#39;, &#39;1998-09-01 02:45:00&#39;,
               &#39;1998-09-01 03:00:00&#39;, &#39;1998-09-01 03:15:00&#39;,
               &#39;1998-09-01 03:30:00&#39;, &#39;1998-09-01 03:45:00&#39;,
               &#39;1998-09-01 04:00:00&#39;, &#39;1998-09-01 04:15:00&#39;,
               &#39;1998-09-01 04:30:00&#39;, &#39;1998-09-01 04:45:00&#39;,
               &#39;1998-09-01 05:00:00&#39;, &#39;1998-09-01 05:15:00&#39;,
               &#39;1998-09-01 05:30:00&#39;, &#39;1998-09-01 05:45:00&#39;,
               &#39;1998-09-01 06:00:00&#39;, &#39;1998-09-01 06:15:00&#39;,
               &#39;1998-09-01 06:30:00&#39;, &#39;1998-09-01 06:45:00&#39;,
               &#39;1998-09-01 07:00:00&#39;, &#39;1998-09-01 07:15:00&#39;,
               &#39;1998-09-01 07:30:00&#39;, &#39;1998-09-01 07:45:00&#39;,
               &#39;1998-09-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-09-01 00:00:00&#39;, &#39;1998-09-01 00:15:00&#39;,
               &#39;1998-09-01 00:30:00&#39;, &#39;1998-09-01 00:45:00&#39;,
               &#39;1998-09-01 01:00:00&#39;, &#39;1998-09-01 01:15:00&#39;,
               &#39;1998-09-01 01:30:00&#39;, &#39;1998-09-01 01:45:00&#39;,
               &#39;1998-09-01 02:00:00&#39;, &#39;1998-09-01 02:15:00&#39;,
               ...
               &#39;1998-09-29 13:30:00&#39;, &#39;1998-09-29 15:00:00&#39;,
               &#39;1998-09-29 15:15:00&#39;, &#39;1998-09-29 15:30:00&#39;,
               &#39;1998-09-30 08:30:00&#39;, &#39;1998-09-30 08:45:00&#39;,
               &#39;1998-09-30 09:00:00&#39;, &#39;1998-09-30 19:15:00&#39;,
               &#39;1998-09-30 19:30:00&#39;, &#39;1998-09-30 19:45:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=768, freq=None).
processing final discharge data

Processing discharge for station 15275100 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15266300 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-09-01 00:00:00&#39;, &#39;1998-09-01 00:15:00&#39;,
               &#39;1998-09-01 00:30:00&#39;, &#39;1998-09-01 00:45:00&#39;,
               &#39;1998-09-01 01:00:00&#39;, &#39;1998-09-01 01:15:00&#39;,
               &#39;1998-09-01 01:30:00&#39;, &#39;1998-09-01 01:45:00&#39;,
               &#39;1998-09-01 02:00:00&#39;, &#39;1998-09-01 02:15:00&#39;,
               &#39;1998-09-01 02:30:00&#39;, &#39;1998-09-01 02:45:00&#39;,
               &#39;1998-09-01 03:00:00&#39;, &#39;1998-09-01 03:15:00&#39;,
               &#39;1998-09-01 03:30:00&#39;, &#39;1998-09-01 03:45:00&#39;,
               &#39;1998-09-01 04:00:00&#39;, &#39;1998-09-01 04:15:00&#39;,
               &#39;1998-09-01 04:30:00&#39;, &#39;1998-09-01 04:45:00&#39;,
               &#39;1998-09-01 05:00:00&#39;, &#39;1998-09-01 05:15:00&#39;,
               &#39;1998-09-01 05:30:00&#39;, &#39;1998-09-01 05:45:00&#39;,
               &#39;1998-09-01 06:00:00&#39;, &#39;1998-09-01 06:15:00&#39;,
               &#39;1998-09-01 06:30:00&#39;, &#39;1998-09-01 06:45:00&#39;,
               &#39;1998-09-01 07:00:00&#39;, &#39;1998-09-01 07:15:00&#39;,
               &#39;1998-09-01 07:30:00&#39;, &#39;1998-09-01 07:45:00&#39;,
               &#39;1998-09-01 08:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15284000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-9-1T00 to 1998-09-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               &#39;1998-10-01 02:30:00&#39;, &#39;1998-10-01 02:45:00&#39;,
               &#39;1998-10-01 03:00:00&#39;, &#39;1998-10-01 03:15:00&#39;,
               &#39;1998-10-01 03:30:00&#39;, &#39;1998-10-01 03:45:00&#39;,
               &#39;1998-10-01 04:00:00&#39;, &#39;1998-10-01 04:15:00&#39;,
               &#39;1998-10-01 04:30:00&#39;, &#39;1998-10-01 04:45:00&#39;,
               &#39;1998-10-01 05:00:00&#39;, &#39;1998-10-01 05:15:00&#39;,
               &#39;1998-10-01 05:30:00&#39;, &#39;1998-10-01 05:45:00&#39;,
               &#39;1998-10-01 06:00:00&#39;, &#39;1998-10-01 06:15:00&#39;,
               &#39;1998-10-01 06:30:00&#39;, &#39;1998-10-01 06:45:00&#39;,
               &#39;1998-10-01 07:00:00&#39;, &#39;1998-10-01 07:15:00&#39;,
               &#39;1998-10-01 07:30:00&#39;, &#39;1998-10-01 07:45:00&#39;,
               &#39;1998-10-01 08:00:00&#39;, &#39;1998-10-25 08:45:00&#39;,
               &#39;1998-10-25 09:00:00&#39;, &#39;1998-10-25 09:15:00&#39;,
               &#39;1998-10-25 09:30:00&#39;, &#39;1998-10-25 09:45:00&#39;,
               &#39;1998-10-25 10:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15290000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               &#39;1998-10-01 02:30:00&#39;, &#39;1998-10-01 02:45:00&#39;,
               &#39;1998-10-01 03:00:00&#39;, &#39;1998-10-01 03:15:00&#39;,
               &#39;1998-10-01 03:30:00&#39;, &#39;1998-10-01 03:45:00&#39;,
               &#39;1998-10-01 04:00:00&#39;, &#39;1998-10-01 04:15:00&#39;,
               &#39;1998-10-01 04:30:00&#39;, &#39;1998-10-01 04:45:00&#39;,
               &#39;1998-10-01 05:00:00&#39;, &#39;1998-10-01 05:15:00&#39;,
               &#39;1998-10-01 05:30:00&#39;, &#39;1998-10-01 05:45:00&#39;,
               &#39;1998-10-01 06:00:00&#39;, &#39;1998-10-01 06:15:00&#39;,
               &#39;1998-10-01 06:30:00&#39;, &#39;1998-10-01 06:45:00&#39;,
               &#39;1998-10-01 07:00:00&#39;, &#39;1998-10-01 07:15:00&#39;,
               &#39;1998-10-01 07:30:00&#39;, &#39;1998-10-01 07:45:00&#39;,
               &#39;1998-10-01 08:00:00&#39;, &#39;1998-10-25 08:45:00&#39;,
               &#39;1998-10-25 09:00:00&#39;, &#39;1998-10-25 09:15:00&#39;,
               &#39;1998-10-25 09:30:00&#39;, &#39;1998-10-25 09:45:00&#39;,
               &#39;1998-10-25 10:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15271000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               &#39;1998-10-01 02:30:00&#39;, &#39;1998-10-01 02:45:00&#39;,
               &#39;1998-10-01 03:00:00&#39;, &#39;1998-10-01 03:15:00&#39;,
               &#39;1998-10-01 03:30:00&#39;, &#39;1998-10-01 03:45:00&#39;,
               &#39;1998-10-01 04:00:00&#39;, &#39;1998-10-01 04:15:00&#39;,
               &#39;1998-10-01 04:30:00&#39;, &#39;1998-10-01 04:45:00&#39;,
               &#39;1998-10-01 05:00:00&#39;, &#39;1998-10-01 05:15:00&#39;,
               &#39;1998-10-01 05:30:00&#39;, &#39;1998-10-01 05:45:00&#39;,
               &#39;1998-10-01 06:00:00&#39;, &#39;1998-10-01 06:15:00&#39;,
               &#39;1998-10-01 06:30:00&#39;, &#39;1998-10-01 06:45:00&#39;,
               &#39;1998-10-01 07:00:00&#39;, &#39;1998-10-01 07:15:00&#39;,
               &#39;1998-10-01 07:30:00&#39;, &#39;1998-10-01 07:45:00&#39;,
               &#39;1998-10-01 08:00:00&#39;, &#39;1998-10-01 08:15:00&#39;,
               &#39;1998-10-25 08:45:00&#39;, &#39;1998-10-25 09:00:00&#39;,
               &#39;1998-10-25 09:15:00&#39;, &#39;1998-10-25 09:30:00&#39;,
               &#39;1998-10-25 09:45:00&#39;, &#39;1998-10-25 10:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15239900 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               &#39;1998-10-01 02:30:00&#39;, &#39;1998-10-01 02:45:00&#39;,
               &#39;1998-10-01 03:00:00&#39;, &#39;1998-10-01 03:15:00&#39;,
               &#39;1998-10-01 03:30:00&#39;, &#39;1998-10-01 03:45:00&#39;,
               &#39;1998-10-01 04:00:00&#39;, &#39;1998-10-01 04:15:00&#39;,
               &#39;1998-10-01 04:30:00&#39;, &#39;1998-10-01 04:45:00&#39;,
               &#39;1998-10-01 05:00:00&#39;, &#39;1998-10-01 05:15:00&#39;,
               &#39;1998-10-01 05:30:00&#39;, &#39;1998-10-01 05:45:00&#39;,
               &#39;1998-10-01 06:00:00&#39;, &#39;1998-10-01 06:15:00&#39;,
               &#39;1998-10-01 06:30:00&#39;, &#39;1998-10-01 06:45:00&#39;,
               &#39;1998-10-01 07:00:00&#39;, &#39;1998-10-01 07:15:00&#39;,
               &#39;1998-10-01 07:30:00&#39;, &#39;1998-10-01 07:45:00&#39;,
               &#39;1998-10-01 08:00:00&#39;, &#39;1998-10-25 08:45:00&#39;,
               &#39;1998-10-25 09:00:00&#39;, &#39;1998-10-25 09:15:00&#39;,
               &#39;1998-10-25 09:30:00&#39;, &#39;1998-10-25 09:45:00&#39;,
               &#39;1998-10-25 10:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15239070 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               ...
               &#39;1998-10-30 11:30:00&#39;, &#39;1998-10-31 04:45:00&#39;,
               &#39;1998-10-31 05:00:00&#39;, &#39;1998-10-31 05:15:00&#39;,
               &#39;1998-10-31 18:30:00&#39;, &#39;1998-10-31 18:45:00&#39;,
               &#39;1998-10-31 19:00:00&#39;, &#39;1998-10-31 20:30:00&#39;,
               &#39;1998-10-31 20:45:00&#39;, &#39;1998-10-31 21:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=727, freq=None).
processing final discharge data

Processing discharge for station 15275100 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               &#39;1998-10-01 02:30:00&#39;, &#39;1998-10-01 02:45:00&#39;,
               &#39;1998-10-01 03:00:00&#39;, &#39;1998-10-01 03:15:00&#39;,
               &#39;1998-10-01 03:30:00&#39;, &#39;1998-10-01 03:45:00&#39;,
               &#39;1998-10-01 04:00:00&#39;, &#39;1998-10-01 04:15:00&#39;,
               &#39;1998-10-01 04:30:00&#39;, &#39;1998-10-01 04:45:00&#39;,
               &#39;1998-10-01 05:00:00&#39;, &#39;1998-10-01 05:15:00&#39;,
               &#39;1998-10-01 05:30:00&#39;, &#39;1998-10-01 05:45:00&#39;,
               &#39;1998-10-01 06:00:00&#39;, &#39;1998-10-01 06:15:00&#39;,
               &#39;1998-10-01 06:30:00&#39;, &#39;1998-10-01 06:45:00&#39;,
               &#39;1998-10-01 07:00:00&#39;, &#39;1998-10-01 07:15:00&#39;,
               &#39;1998-10-01 07:30:00&#39;, &#39;1998-10-01 07:45:00&#39;,
               &#39;1998-10-01 08:00:00&#39;, &#39;1998-10-25 08:45:00&#39;,
               &#39;1998-10-25 09:00:00&#39;, &#39;1998-10-25 09:15:00&#39;,
               &#39;1998-10-25 09:30:00&#39;, &#39;1998-10-25 09:45:00&#39;,
               &#39;1998-10-25 10:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15266300 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-10-01 00:00:00&#39;, &#39;1998-10-01 00:15:00&#39;,
               &#39;1998-10-01 00:30:00&#39;, &#39;1998-10-01 00:45:00&#39;,
               &#39;1998-10-01 01:00:00&#39;, &#39;1998-10-01 01:15:00&#39;,
               &#39;1998-10-01 01:30:00&#39;, &#39;1998-10-01 01:45:00&#39;,
               &#39;1998-10-01 02:00:00&#39;, &#39;1998-10-01 02:15:00&#39;,
               ...
               &#39;1998-10-09 07:15:00&#39;, &#39;1998-10-09 07:30:00&#39;,
               &#39;1998-10-09 07:45:00&#39;, &#39;1998-10-09 08:00:00&#39;,
               &#39;1998-10-25 08:45:00&#39;, &#39;1998-10-25 09:00:00&#39;,
               &#39;1998-10-25 09:15:00&#39;, &#39;1998-10-25 09:30:00&#39;,
               &#39;1998-10-25 09:45:00&#39;, &#39;1998-10-25 10:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=233, freq=None).
processing final discharge data

Processing discharge for station 15284000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-10-1T00 to 1998-10-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-11-14 09:00:00&#39;, &#39;1998-11-14 09:15:00&#39;,
               &#39;1998-11-14 09:30:00&#39;, &#39;1998-11-14 09:45:00&#39;,
               &#39;1998-11-14 10:00:00&#39;, &#39;1998-11-14 10:15:00&#39;,
               &#39;1998-11-14 10:30:00&#39;, &#39;1998-11-14 10:45:00&#39;,
               &#39;1998-11-14 11:00:00&#39;, &#39;1998-11-14 11:15:00&#39;,
               ...
               &#39;1998-11-30 20:45:00&#39;, &#39;1998-11-30 21:00:00&#39;,
               &#39;1998-11-30 21:15:00&#39;, &#39;1998-11-30 21:30:00&#39;,
               &#39;1998-11-30 21:45:00&#39;, &#39;1998-11-30 22:00:00&#39;,
               &#39;1998-11-30 22:15:00&#39;, &#39;1998-11-30 22:30:00&#39;,
               &#39;1998-11-30 22:45:00&#39;, &#39;1998-11-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=1593, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               ...
               &#39;1998-11-12 06:45:00&#39;, &#39;1998-11-12 07:00:00&#39;,
               &#39;1998-11-12 07:15:00&#39;, &#39;1998-11-12 07:30:00&#39;,
               &#39;1998-11-12 07:45:00&#39;, &#39;1998-11-12 08:00:00&#39;,
               &#39;1998-11-12 08:15:00&#39;, &#39;1998-11-12 08:30:00&#39;,
               &#39;1998-11-12 08:45:00&#39;, &#39;1998-11-12 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=425, freq=None).
processing final discharge data

Processing discharge for station 15290000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-11-08 09:00:00&#39;, &#39;1998-11-08 09:15:00&#39;,
               &#39;1998-11-08 09:30:00&#39;, &#39;1998-11-08 09:45:00&#39;,
               &#39;1998-11-08 10:00:00&#39;, &#39;1998-11-08 10:15:00&#39;,
               &#39;1998-11-08 10:30:00&#39;, &#39;1998-11-08 10:45:00&#39;,
               &#39;1998-11-08 11:00:00&#39;, &#39;1998-11-08 11:15:00&#39;,
               ...
               &#39;1998-11-30 20:45:00&#39;, &#39;1998-11-30 21:00:00&#39;,
               &#39;1998-11-30 21:15:00&#39;, &#39;1998-11-30 21:30:00&#39;,
               &#39;1998-11-30 21:45:00&#39;, &#39;1998-11-30 22:00:00&#39;,
               &#39;1998-11-30 22:15:00&#39;, &#39;1998-11-30 22:30:00&#39;,
               &#39;1998-11-30 22:45:00&#39;, &#39;1998-11-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2169, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               &#39;1998-11-01 02:30:00&#39;, &#39;1998-11-01 02:45:00&#39;,
               &#39;1998-11-01 03:00:00&#39;, &#39;1998-11-01 03:15:00&#39;,
               &#39;1998-11-01 03:30:00&#39;, &#39;1998-11-01 03:45:00&#39;,
               &#39;1998-11-01 04:00:00&#39;, &#39;1998-11-01 04:15:00&#39;,
               &#39;1998-11-01 04:30:00&#39;, &#39;1998-11-01 04:45:00&#39;,
               &#39;1998-11-01 05:00:00&#39;, &#39;1998-11-01 05:15:00&#39;,
               &#39;1998-11-01 05:30:00&#39;, &#39;1998-11-01 05:45:00&#39;,
               &#39;1998-11-01 06:00:00&#39;, &#39;1998-11-01 06:15:00&#39;,
               &#39;1998-11-01 06:30:00&#39;, &#39;1998-11-01 06:45:00&#39;,
               &#39;1998-11-01 07:00:00&#39;, &#39;1998-11-01 07:15:00&#39;,
               &#39;1998-11-01 07:30:00&#39;, &#39;1998-11-01 07:45:00&#39;,
               &#39;1998-11-01 08:00:00&#39;, &#39;1998-11-01 08:15:00&#39;,
               &#39;1998-11-01 08:30:00&#39;, &#39;1998-11-01 08:45:00&#39;,
               &#39;1998-11-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15271000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               ...
               &#39;1998-11-30 20:45:00&#39;, &#39;1998-11-30 21:00:00&#39;,
               &#39;1998-11-30 21:15:00&#39;, &#39;1998-11-30 21:30:00&#39;,
               &#39;1998-11-30 21:45:00&#39;, &#39;1998-11-30 22:00:00&#39;,
               &#39;1998-11-30 22:15:00&#39;, &#39;1998-11-30 22:30:00&#39;,
               &#39;1998-11-30 22:45:00&#39;, &#39;1998-11-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=1923, freq=None).
processing final discharge data

Processing discharge for station 15239900 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               &#39;1998-11-01 02:30:00&#39;, &#39;1998-11-01 02:45:00&#39;,
               &#39;1998-11-01 03:00:00&#39;, &#39;1998-11-01 03:15:00&#39;,
               &#39;1998-11-01 03:30:00&#39;, &#39;1998-11-01 03:45:00&#39;,
               &#39;1998-11-01 04:00:00&#39;, &#39;1998-11-01 04:15:00&#39;,
               &#39;1998-11-01 04:30:00&#39;, &#39;1998-11-01 04:45:00&#39;,
               &#39;1998-11-01 05:00:00&#39;, &#39;1998-11-01 05:15:00&#39;,
               &#39;1998-11-01 05:30:00&#39;, &#39;1998-11-01 05:45:00&#39;,
               &#39;1998-11-01 06:00:00&#39;, &#39;1998-11-01 06:15:00&#39;,
               &#39;1998-11-01 06:30:00&#39;, &#39;1998-11-01 06:45:00&#39;,
               &#39;1998-11-01 07:00:00&#39;, &#39;1998-11-01 07:15:00&#39;,
               &#39;1998-11-01 07:30:00&#39;, &#39;1998-11-01 07:45:00&#39;,
               &#39;1998-11-01 08:00:00&#39;, &#39;1998-11-01 08:15:00&#39;,
               &#39;1998-11-01 08:30:00&#39;, &#39;1998-11-01 08:45:00&#39;,
               &#39;1998-11-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               ...
               &#39;1998-11-30 20:45:00&#39;, &#39;1998-11-30 21:00:00&#39;,
               &#39;1998-11-30 21:15:00&#39;, &#39;1998-11-30 21:30:00&#39;,
               &#39;1998-11-30 21:45:00&#39;, &#39;1998-11-30 22:00:00&#39;,
               &#39;1998-11-30 22:15:00&#39;, &#39;1998-11-30 22:30:00&#39;,
               &#39;1998-11-30 22:45:00&#39;, &#39;1998-11-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=1355, freq=None).
processing final discharge data

Processing discharge for station 15275100 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               ...
               &#39;1998-11-30 20:45:00&#39;, &#39;1998-11-30 21:00:00&#39;,
               &#39;1998-11-30 21:15:00&#39;, &#39;1998-11-30 21:30:00&#39;,
               &#39;1998-11-30 21:45:00&#39;, &#39;1998-11-30 22:00:00&#39;,
               &#39;1998-11-30 22:15:00&#39;, &#39;1998-11-30 22:30:00&#39;,
               &#39;1998-11-30 22:45:00&#39;, &#39;1998-11-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=673, freq=None).
processing final discharge data

Processing discharge for station 15266300 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-11-01 00:00:00&#39;, &#39;1998-11-01 00:15:00&#39;,
               &#39;1998-11-01 00:30:00&#39;, &#39;1998-11-01 00:45:00&#39;,
               &#39;1998-11-01 01:00:00&#39;, &#39;1998-11-01 01:15:00&#39;,
               &#39;1998-11-01 01:30:00&#39;, &#39;1998-11-01 01:45:00&#39;,
               &#39;1998-11-01 02:00:00&#39;, &#39;1998-11-01 02:15:00&#39;,
               ...
               &#39;1998-11-30 20:45:00&#39;, &#39;1998-11-30 21:00:00&#39;,
               &#39;1998-11-30 21:15:00&#39;, &#39;1998-11-30 21:30:00&#39;,
               &#39;1998-11-30 21:45:00&#39;, &#39;1998-11-30 22:00:00&#39;,
               &#39;1998-11-30 22:15:00&#39;, &#39;1998-11-30 22:30:00&#39;,
               &#39;1998-11-30 22:45:00&#39;, &#39;1998-11-30 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=383, freq=None).
processing final discharge data

Processing discharge for station 15284000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-11-1T00 to 1998-11-30T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing discharge for station 15276000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15290000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15271000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-12-04 09:00:00&#39;, &#39;1998-12-04 09:15:00&#39;,
               &#39;1998-12-04 09:30:00&#39;, &#39;1998-12-04 09:45:00&#39;,
               &#39;1998-12-04 10:00:00&#39;, &#39;1998-12-04 10:15:00&#39;,
               &#39;1998-12-04 10:30:00&#39;, &#39;1998-12-04 10:45:00&#39;,
               &#39;1998-12-04 11:00:00&#39;, &#39;1998-12-04 11:15:00&#39;,
               ...
               &#39;1998-12-31 20:45:00&#39;, &#39;1998-12-31 21:00:00&#39;,
               &#39;1998-12-31 21:15:00&#39;, &#39;1998-12-31 21:30:00&#39;,
               &#39;1998-12-31 21:45:00&#39;, &#39;1998-12-31 22:00:00&#39;,
               &#39;1998-12-31 22:15:00&#39;, &#39;1998-12-31 22:30:00&#39;,
               &#39;1998-12-31 22:45:00&#39;, &#39;1998-12-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2649, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-12-01 00:00:00&#39;, &#39;1998-12-01 00:15:00&#39;,
               &#39;1998-12-01 00:30:00&#39;, &#39;1998-12-01 00:45:00&#39;,
               &#39;1998-12-01 01:00:00&#39;, &#39;1998-12-01 01:15:00&#39;,
               &#39;1998-12-01 01:30:00&#39;, &#39;1998-12-01 01:45:00&#39;,
               &#39;1998-12-01 02:00:00&#39;, &#39;1998-12-01 02:15:00&#39;,
               &#39;1998-12-01 02:30:00&#39;, &#39;1998-12-01 02:45:00&#39;,
               &#39;1998-12-01 03:00:00&#39;, &#39;1998-12-01 03:15:00&#39;,
               &#39;1998-12-01 03:30:00&#39;, &#39;1998-12-01 03:45:00&#39;,
               &#39;1998-12-01 04:00:00&#39;, &#39;1998-12-01 04:15:00&#39;,
               &#39;1998-12-01 04:30:00&#39;, &#39;1998-12-01 04:45:00&#39;,
               &#39;1998-12-01 05:00:00&#39;, &#39;1998-12-01 05:15:00&#39;,
               &#39;1998-12-01 05:30:00&#39;, &#39;1998-12-01 05:45:00&#39;,
               &#39;1998-12-01 06:00:00&#39;, &#39;1998-12-01 06:15:00&#39;,
               &#39;1998-12-01 06:30:00&#39;, &#39;1998-12-01 06:45:00&#39;,
               &#39;1998-12-01 07:00:00&#39;, &#39;1998-12-01 07:15:00&#39;,
               &#39;1998-12-01 07:30:00&#39;, &#39;1998-12-01 07:45:00&#39;,
               &#39;1998-12-01 08:00:00&#39;, &#39;1998-12-01 08:15:00&#39;,
               &#39;1998-12-01 08:30:00&#39;, &#39;1998-12-01 08:45:00&#39;,
               &#39;1998-12-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239900 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15281000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15295700 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-12-01 00:00:00&#39;, &#39;1998-12-01 00:15:00&#39;,
               &#39;1998-12-01 00:30:00&#39;, &#39;1998-12-01 00:45:00&#39;,
               &#39;1998-12-01 01:00:00&#39;, &#39;1998-12-01 01:15:00&#39;,
               &#39;1998-12-01 01:30:00&#39;, &#39;1998-12-01 01:45:00&#39;,
               &#39;1998-12-01 02:00:00&#39;, &#39;1998-12-01 02:15:00&#39;,
               &#39;1998-12-01 02:30:00&#39;, &#39;1998-12-01 02:45:00&#39;,
               &#39;1998-12-01 03:00:00&#39;, &#39;1998-12-01 03:15:00&#39;,
               &#39;1998-12-01 03:30:00&#39;, &#39;1998-12-01 03:45:00&#39;,
               &#39;1998-12-01 04:00:00&#39;, &#39;1998-12-01 04:15:00&#39;,
               &#39;1998-12-01 04:30:00&#39;, &#39;1998-12-01 04:45:00&#39;,
               &#39;1998-12-01 05:00:00&#39;, &#39;1998-12-01 05:15:00&#39;,
               &#39;1998-12-01 05:30:00&#39;, &#39;1998-12-01 05:45:00&#39;,
               &#39;1998-12-01 06:00:00&#39;, &#39;1998-12-01 06:15:00&#39;,
               &#39;1998-12-01 06:30:00&#39;, &#39;1998-12-01 06:45:00&#39;,
               &#39;1998-12-01 07:00:00&#39;, &#39;1998-12-01 07:15:00&#39;,
               &#39;1998-12-01 07:30:00&#39;, &#39;1998-12-01 07:45:00&#39;,
               &#39;1998-12-01 08:00:00&#39;, &#39;1998-12-01 08:15:00&#39;,
               &#39;1998-12-01 08:30:00&#39;, &#39;1998-12-01 08:45:00&#39;,
               &#39;1998-12-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15239070 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-12-01 00:00:00&#39;, &#39;1998-12-01 00:15:00&#39;,
               &#39;1998-12-01 00:30:00&#39;, &#39;1998-12-01 00:45:00&#39;,
               &#39;1998-12-01 01:00:00&#39;, &#39;1998-12-01 01:15:00&#39;,
               &#39;1998-12-01 01:30:00&#39;, &#39;1998-12-01 01:45:00&#39;,
               &#39;1998-12-01 02:00:00&#39;, &#39;1998-12-01 02:15:00&#39;,
               ...
               &#39;1998-12-31 20:45:00&#39;, &#39;1998-12-31 21:00:00&#39;,
               &#39;1998-12-31 21:15:00&#39;, &#39;1998-12-31 21:30:00&#39;,
               &#39;1998-12-31 21:45:00&#39;, &#39;1998-12-31 22:00:00&#39;,
               &#39;1998-12-31 22:15:00&#39;, &#39;1998-12-31 22:30:00&#39;,
               &#39;1998-12-31 22:45:00&#39;, &#39;1998-12-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2877, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-12-21 12:15:00&#39;, &#39;1998-12-21 12:30:00&#39;,
               &#39;1998-12-21 12:45:00&#39;, &#39;1998-12-21 22:30:00&#39;,
               &#39;1998-12-21 22:45:00&#39;, &#39;1998-12-21 23:00:00&#39;,
               &#39;1998-12-22 01:00:00&#39;, &#39;1998-12-22 01:15:00&#39;,
               &#39;1998-12-22 01:30:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None).
processing final discharge data

Processing discharge for station 15275100 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
fill consecutive nan gaps of over 8 days with function &lt;function discharge_from_gage_or_mean at 0x7fe326134b80&gt;.
Dates replaced: DatetimeIndex([&#39;1998-12-03 09:00:00&#39;, &#39;1998-12-03 09:15:00&#39;,
               &#39;1998-12-03 09:30:00&#39;, &#39;1998-12-03 09:45:00&#39;,
               &#39;1998-12-03 10:00:00&#39;, &#39;1998-12-03 10:15:00&#39;,
               &#39;1998-12-03 10:30:00&#39;, &#39;1998-12-03 10:45:00&#39;,
               &#39;1998-12-03 11:00:00&#39;, &#39;1998-12-03 11:15:00&#39;,
               ...
               &#39;1998-12-31 20:45:00&#39;, &#39;1998-12-31 21:00:00&#39;,
               &#39;1998-12-31 21:15:00&#39;, &#39;1998-12-31 21:30:00&#39;,
               &#39;1998-12-31 21:45:00&#39;, &#39;1998-12-31 22:00:00&#39;,
               &#39;1998-12-31 22:15:00&#39;, &#39;1998-12-31 22:30:00&#39;,
               &#39;1998-12-31 22:45:00&#39;, &#39;1998-12-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=2745, freq=None).
fill consecutive nan gaps of under 8 days by interpolating.
Dates replaced: DatetimeIndex([&#39;1998-12-01 00:00:00&#39;, &#39;1998-12-01 00:15:00&#39;,
               &#39;1998-12-01 00:30:00&#39;, &#39;1998-12-01 00:45:00&#39;,
               &#39;1998-12-01 01:00:00&#39;, &#39;1998-12-01 01:15:00&#39;,
               &#39;1998-12-01 01:30:00&#39;, &#39;1998-12-01 01:45:00&#39;,
               &#39;1998-12-01 02:00:00&#39;, &#39;1998-12-01 02:15:00&#39;,
               &#39;1998-12-01 02:30:00&#39;, &#39;1998-12-01 02:45:00&#39;,
               &#39;1998-12-01 03:00:00&#39;, &#39;1998-12-01 03:15:00&#39;,
               &#39;1998-12-01 03:30:00&#39;, &#39;1998-12-01 03:45:00&#39;,
               &#39;1998-12-01 04:00:00&#39;, &#39;1998-12-01 04:15:00&#39;,
               &#39;1998-12-01 04:30:00&#39;, &#39;1998-12-01 04:45:00&#39;,
               &#39;1998-12-01 05:00:00&#39;, &#39;1998-12-01 05:15:00&#39;,
               &#39;1998-12-01 05:30:00&#39;, &#39;1998-12-01 05:45:00&#39;,
               &#39;1998-12-01 06:00:00&#39;, &#39;1998-12-01 06:15:00&#39;,
               &#39;1998-12-01 06:30:00&#39;, &#39;1998-12-01 06:45:00&#39;,
               &#39;1998-12-01 07:00:00&#39;, &#39;1998-12-01 07:15:00&#39;,
               &#39;1998-12-01 07:30:00&#39;, &#39;1998-12-01 07:45:00&#39;,
               &#39;1998-12-01 08:00:00&#39;, &#39;1998-12-01 08:15:00&#39;,
               &#39;1998-12-01 08:30:00&#39;, &#39;1998-12-01 08:45:00&#39;,
               &#39;1998-12-01 09:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;15T&#39;).
processing final discharge data

Processing discharge for station 15266300 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15284000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15292000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing discharge for station 15274600 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed discharge data.
Discharge dataset is empty. Check for gage data or use mean time series.
Accessed gage data.
Gage dataset is empty. Use mean time series.
calculating mean time series
processing final discharge data

Processing temp for station 15276000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15290000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15258000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239900 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
this station has temp data for several years but the stats don&#39;t contain a realistic mean so we have to calculate it ourselves
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15295700 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15239070 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15266300 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15284000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15292780 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data

Processing temp for station 15276000 from 1998-12-1T00 to 1998-12-31T23:00.
Accessed temp data.
Temp dataset is empty. Use mean time series.
calculating mean time series
processing final temp data
</pre></div>
</div>
</div>
</div>
<p>Plot output for sanity check</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">locs</span> <span class="o">=</span> <span class="s2">&quot;axiom.ciofs.river.1998*.nc&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">concat_dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;nested&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;river_time&quot;</span><span class="p">})</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fe236dd5a00&gt;
</pre></div>
</div>
<img alt="_images/7d5f38b5dd5282cf86c4bf71371dfbfc7100a5e3372d4a49a12fbb070c8b5051.png" src="_images/7d5f38b5dd5282cf86c4bf71371dfbfc7100a5e3372d4a49a12fbb070c8b5051.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="demonstrate-using-the-rating-curve">
<h1>Demonstrate using the rating curve<a class="headerlink" href="#demonstrate-using-the-rating-curve" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratingDataOrig</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;15295700&quot;</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ratingDataHigher</span> <span class="o">=</span> <span class="n">extrapolate_rating_curve</span><span class="p">(</span><span class="n">ratingDataOrig</span><span class="p">,</span> <span class="n">ratingDataOrig</span><span class="p">[</span><span class="s2">&quot;INDEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">)</span>
<span class="n">ratingDataLower</span> <span class="o">=</span> <span class="n">extrapolate_rating_curve</span><span class="p">(</span><span class="n">ratingDataOrig</span><span class="p">,</span> <span class="n">ratingDataOrig</span><span class="p">[</span><span class="s2">&quot;INDEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">ratingDataHigher</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;INDEP&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;DEP&quot;</span><span class="p">)</span>
<span class="n">ratingDataLower</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;INDEP&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;DEP&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ratingDataOrig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;INDEP&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;DEP&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="c1"># ax.set_ylim(-10, 100)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;INDEP&#39;&gt;
</pre></div>
</div>
<img alt="_images/1cee2fd815eac0e791083663d57ec644e0b9367e46095acaa488c916bcc58003.png" src="_images/1cee2fd815eac0e791083663d57ec644e0b9367e46095acaa488c916bcc58003.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">dftest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;INDEP&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;DEP&quot;</span><span class="p">)</span>
<span class="n">ratingData</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;INDEP&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;DEP&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;INDEP&#39;&gt;
</pre></div>
</div>
<img alt="_images/5735b0f933435345d871848e167732552481dd953aaa871fc9836d7d8e5ccc03.png" src="_images/5735b0f933435345d871848e167732552481dd953aaa871fc9836d7d8e5ccc03.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/0d8a82139ccb3c51d7d6bde10adad2cb87171b361317e16f50fa2d53d8a7768d.png" src="_images/0d8a82139ccb3c51d7d6bde10adad2cb87171b361317e16f50fa2d53d8a7768d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratingData</span><span class="p">[[</span><span class="s2">&quot;INDEP&quot;</span><span class="p">,</span> <span class="s2">&quot;DEP&quot;</span><span class="p">]],</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEP</th>
      <th>DEP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.42</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.43</td>
      <td>5.17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.44</td>
      <td>5.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.45</td>
      <td>5.53</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.46</td>
      <td>5.72</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>369</th>
      <td>7.11</td>
      <td>2417.14</td>
    </tr>
    <tr>
      <th>370</th>
      <td>7.12</td>
      <td>2437.66</td>
    </tr>
    <tr>
      <th>371</th>
      <td>7.13</td>
      <td>2458.30</td>
    </tr>
    <tr>
      <th>372</th>
      <td>7.14</td>
      <td>2479.09</td>
    </tr>
    <tr>
      <th>373</th>
      <td>7.15</td>
      <td>2500.00</td>
    </tr>
  </tbody>
</table>
<p>374 rows Ã— 2 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="check-the-two-nonzero-rivers-later-check-the-zero-rivers-too">
<h1>Check the two nonzero rivers (later check the zero rivers too)<a class="headerlink" href="#check-the-two-nonzero-rivers-later-check-the-zero-rivers-too" title="Permalink to this headline">#</a></h1>
<p>Should I always use gage data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">)</span>
<span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEP</th>
      <th>DEP</th>
      <th>STOR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.86</td>
      <td>1.90</td>
      <td>*</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.05</td>
      <td>104.90</td>
      <td>*</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.23</td>
      <td>125.85</td>
      <td>*</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.50</td>
      <td>151.09</td>
      <td>*</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.75</td>
      <td>172.07</td>
      <td>*</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.02</td>
      <td>198.54</td>
      <td>*</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5.91</td>
      <td>461.00</td>
      <td>*</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)</span>
<span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEP</th>
      <th>SHIFT</th>
      <th>DEP</th>
      <th>STOR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.75</td>
      <td>0.11</td>
      <td>1.90</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.76</td>
      <td>0.11</td>
      <td>2.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.77</td>
      <td>0.11</td>
      <td>2.23</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.78</td>
      <td>0.11</td>
      <td>2.41</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.79</td>
      <td>0.11</td>
      <td>2.60</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>412</th>
      <td>5.87</td>
      <td>0.00</td>
      <td>454.67</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>413</th>
      <td>5.88</td>
      <td>0.00</td>
      <td>456.25</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>414</th>
      <td>5.89</td>
      <td>0.00</td>
      <td>457.83</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>415</th>
      <td>5.90</td>
      <td>0.00</td>
      <td>459.42</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>416</th>
      <td>5.91</td>
      <td>0.00</td>
      <td>461.00</td>
      <td>*</td>
    </tr>
  </tbody>
</table>
<p>417 rows Ã— 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;corr&quot;</span><span class="p">)</span>
<span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEP</th>
      <th>CORR</th>
      <th>CORRINDEP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.75</td>
      <td>0.03</td>
      <td>1.78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.76</td>
      <td>0.03</td>
      <td>1.79</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.77</td>
      <td>0.03</td>
      <td>1.80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.78</td>
      <td>0.03</td>
      <td>1.81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.79</td>
      <td>0.03</td>
      <td>1.82</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>412</th>
      <td>5.87</td>
      <td>0.03</td>
      <td>5.90</td>
    </tr>
    <tr>
      <th>413</th>
      <td>5.88</td>
      <td>0.03</td>
      <td>5.91</td>
    </tr>
    <tr>
      <th>414</th>
      <td>5.89</td>
      <td>0.03</td>
      <td>5.92</td>
    </tr>
    <tr>
      <th>415</th>
      <td>5.90</td>
      <td>0.03</td>
      <td>5.93</td>
    </tr>
    <tr>
      <th>416</th>
      <td>5.91</td>
      <td>0.03</td>
      <td>5.94</td>
    </tr>
  </tbody>
</table>
<p>417 rows Ã— 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dischargeh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime
2022-12-14 18:00:00   -999999.0
2022-12-14 19:00:00   -999999.0
2022-12-14 20:00:00   -999999.0
2022-12-14 21:00:00   -999999.0
2022-12-14 22:00:00   -999999.0
                         ...   
2022-12-17 21:00:00   -999999.0
2022-12-17 22:00:00   -999999.0
2022-12-17 23:00:00   -999999.0
2022-12-18 00:00:00   -999999.0
2022-12-18 01:00:00   -999999.0
Freq: H, Name: 00065, Length: 80, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>
<span class="n">exsa</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;corr&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rating</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">exsa</span><span class="p">,</span> <span class="n">corr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rating</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;CORRINDEP&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">streamflow_as_function_of_gage_height</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span>

<span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dischargeh</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>


<span class="n">streamflow_estimate_for_gage_data</span> <span class="o">=</span> <span class="o">-</span><span class="n">streamflow_as_function_of_gage_height</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dischargeh</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="mf">.3048</span><span class="o">**</span><span class="mi">3</span>
<span class="c1"># -ratingData[0].set_index(&quot;INDEP&quot;)[&quot;DEP&quot;].loc[dischargeh.round(2)]*.3**3</span>

<span class="n">streamflow_estimate_for_gage_data</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">streamflow_estimate_for_gage_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe351bc88e0&gt;]
</pre></div>
</div>
<img alt="_images/f52c2cb422bc656651dcd652f7ea321a26591eda35c98fe50789a19bc4a5ef76.png" src="_images/f52c2cb422bc656651dcd652f7ea321a26591eda35c98fe50789a19bc4a5ef76.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)</span>
<span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dischargeh</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>
<span class="n">est</span> <span class="o">=</span> <span class="o">-</span><span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;INDEP&quot;</span><span class="p">)[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dischargeh</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="mf">.3048</span><span class="o">**</span><span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">est</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe3a1b24430&gt;]
</pre></div>
</div>
<img alt="_images/9b196181466b511d5e78a7cfa5a78eefcbebac7f92fa86e75256be66f9e39662.png" src="_images/9b196181466b511d5e78a7cfa5a78eefcbebac7f92fa86e75256be66f9e39662.png" />
</div>
</div>
<p>What would it look like to use discharge if available and otherwise gage data, but on a point by point basis?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span><span class="s2">&quot;00065&quot;</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">discharge_data</span> <span class="o">=</span> <span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">.3048</span><span class="o">**</span><span class="mi">3</span>

<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># create estimate using rating curve and gage height</span>
<span class="n">streamflow_estimate_for_gage_data</span> <span class="o">=</span> <span class="o">-</span><span class="n">ratingData</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;INDEP&quot;</span><span class="p">)[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="mf">.3048</span><span class="o">**</span><span class="mi">3</span>

<span class="c1"># combine. Will also need to combine for ice values and other scenarios.</span>
<span class="n">streamflow_estimate_for_gage_data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">discharge_data</span><span class="o">.</span><span class="n">index</span>
<span class="n">discharge_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">discharge_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span> <span class="o">=</span> <span class="n">streamflow_estimate_for_gage_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">discharge_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

<span class="c1"># average to hourly</span>
<span class="n">dischargeh</span> <span class="o">=</span> <span class="n">discharge_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>

<span class="c1"># est = -ratingData[0].set_index(&quot;INDEP&quot;)[&quot;DEP&quot;].loc[dischargeh.round(2)]*.3048**3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">dischargeh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe3629bd700&gt;]
</pre></div>
</div>
<img alt="_images/e236f2f0264ac7071720de89b23e4f57230be742aee37be597649e8c19e8a0b6.png" src="_images/e236f2f0264ac7071720de89b23e4f57230be742aee37be597649e8c19e8a0b6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">streamflow_estimate_for_gage_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">discharge_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">652</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">streamflow_estimate_for_gage_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">discharge_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/generic.py:5902,</span> in <span class="ni">NDFrame.__getattr__</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">5895</span> <span class="k">if</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">5896</span>     <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_names_set</span>
<span class="g g-Whitespace">   </span><span class="mi">5897</span>     <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>
<span class="g g-Whitespace">   </span><span class="mi">5898</span>     <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accessors</span>
<span class="g g-Whitespace">   </span><span class="mi">5899</span>     <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">_can_hold_identifiers_and_holds_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5900</span> <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">5901</span>     <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">5902</span> <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="ne">AttributeError</span>: &#39;Series&#39; object has no attribute &#39;set_index&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge_data</span><span class="p">,</span> <span class="n">streamflow_estimate_for_gage_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(datetime
 2022-12-14 18:00:00   -0.962773
 2022-12-14 18:15:00   -0.962773
 2022-12-14 18:30:00   -0.962773
 2022-12-14 18:45:00   -0.962773
 2022-12-14 19:00:00   -0.937288
                          ...   
 2022-12-18 00:00:00   -4.056388
 2022-12-18 00:15:00   -4.080174
 2022-12-18 00:30:00   -4.103677
 2022-12-18 00:45:00   -4.175036
 2022-12-18 01:00:00   -4.222325
 Name: 00060, Length: 317, dtype: float64,
 datetime
 2022-12-14 18:00:00   -0.963056
 2022-12-14 18:15:00   -0.963056
 2022-12-14 18:30:00   -0.963056
 2022-12-14 18:45:00   -0.963056
 2022-12-14 19:00:00   -0.937854
                          ...   
 2022-12-18 00:00:00   -4.056388
 2022-12-18 00:15:00   -4.080174
 2022-12-18 00:30:00   -4.103677
 2022-12-18 00:45:00   -4.175036
 2022-12-18 01:00:00   -4.222325
 Name: DEP, Length: 317, dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15295700&quot;</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)</span>
<span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dischargeh</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>
<span class="n">est</span> <span class="o">=</span> <span class="o">-</span><span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;INDEP&quot;</span><span class="p">)[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dischargeh</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="mf">.3048</span><span class="o">**</span><span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">est</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe39422b6d0&gt;]
</pre></div>
</div>
<img alt="_images/26ce9c7195c29ca4421b4ac5c988d3a787d3a46ef03e9201a90e38d1fa9fb694.png" src="_images/26ce9c7195c29ca4421b4ac5c988d3a787d3a46ef03e9201a90e38d1fa9fb694.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15239070&quot;</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)</span>
<span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dischargeh</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>
<span class="n">est</span> <span class="o">=</span> <span class="o">-</span><span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;INDEP&quot;</span><span class="p">)[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dischargeh</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="mf">.3</span><span class="o">**</span><span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">est</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">547</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">dischargeh</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">est</span> <span class="o">=</span> <span class="o">-</span><span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;INDEP&quot;</span><span class="p">)[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dischargeh</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">*</span><span class="mf">.3</span><span class="o">**</span><span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">],</span> <span class="n">est</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">30</span><span class="p">])</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/util/_decorators.py:331,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">_format_argument_list</span><span class="p">(</span><span class="n">allow_args</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/pandas/core/frame.py:6012,</span> in <span class="ni">DataFrame.set_index</span><span class="nt">(self, keys, drop, append, inplace, verify_integrity)</span>
<span class="g g-Whitespace">   </span><span class="mi">6009</span>                 <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6011</span> <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">6012</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None of </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> are in the columns&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6014</span> <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6015</span>     <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span>

<span class="ne">KeyError</span>: &quot;None of [&#39;INDEP&#39;] are in the columns&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_list_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;15239070&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15290000&quot;</span>
<span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)</span>
<span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEP</th>
      <th>SHIFT</th>
      <th>DEP</th>
      <th>STOR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.78</td>
      <td>0.18</td>
      <td>6.99</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.79</td>
      <td>0.18</td>
      <td>7.13</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.80</td>
      <td>0.18</td>
      <td>7.28</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.81</td>
      <td>0.18</td>
      <td>7.42</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.82</td>
      <td>0.18</td>
      <td>7.57</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>910</th>
      <td>9.88</td>
      <td>0.00</td>
      <td>7792.22</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>911</th>
      <td>9.89</td>
      <td>0.00</td>
      <td>7807.42</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>912</th>
      <td>9.90</td>
      <td>0.00</td>
      <td>7822.62</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>913</th>
      <td>9.91</td>
      <td>0.00</td>
      <td>7838.80</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>914</th>
      <td>9.92</td>
      <td>0.00</td>
      <td>7855.00</td>
      <td>*</td>
    </tr>
  </tbody>
</table>
<p>915 rows Ã— 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># See if I can match the operational rivers file example we have</span>

<span class="c1">## Read in existing rivers file to use</span>
<span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;nos.ciofs.river.20221216.t00z (1).nc&#39;</span>
<span class="c1"># loc = &quot;nos.ciofs.river.20230201.t00z.nc&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;river_time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">Z&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;river_time&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">Z&quot;</span>

<span class="c1"># start = &#39;2022-12-14T18:00Z&#39;</span>
<span class="c1"># end = &#39;2022-12-18T01:00Z&#39;</span>

<span class="c1"># copy to put new results in for comparison</span>
<span class="n">dsnew</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (river: 36, s_rho: 30, time: 80)
Coordinates:
  * river            (river) int32 1 2 3 4 5 6 7 8 9 ... 29 30 31 32 33 34 35 36
Dimensions without coordinates: s_rho, time
Data variables:
    river_names      (river) |S46 ...
    river_Xposition  (river) int32 ...
    river_Eposition  (river) int32 ...
    river_direction  (river) int32 ...
    river_flag       (river) int32 ...
    river_sign       (river) float32 ...
    river_Vshape     (s_rho, river) float32 ...
    river_time       (time) datetime64[ns] ...
    river_transport  (time, river) float32 ...
    river_temp       (time, s_rho, river) float32 ...
    river_salt       (time, s_rho, river) float32 ...
    river_pass       (time, s_rho, river) float32 ...
Attributes:
    type:             ROMS river forcing netCDF file
    title:            ciofs River forcing netCDF file
    data_source:      River discharge from USGS real time or daily mean
    Temp_source:      River T from USGS real time or daily mean, Salt=0
    model_grid_file:  GRID file: nos.ciofs.romsgrid.nc
    output_file:      River Forcing file: nos.ciofs.river.20221216.t00z.nc
    source_code:      Created using nos_ofs_create_river_ROMS.sh
    history:          Created at time 00:52  12/16/2022
    reference:        Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c391fb0f-e77b-49e1-a30a-98151743b6f8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c391fb0f-e77b-49e1-a30a-98151743b6f8' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>river</span>: 36</li><li><span>s_rho</span>: 30</li><li><span>time</span>: 80</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4fbfb6be-267d-4bed-854b-b61171e44d49' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4fbfb6be-267d-4bed-854b-b61171e44d49' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>river</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 31 32 33 34 35 36</div><input id='attrs-3e97417b-ea1b-4516-a967-224ba12f5527' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3e97417b-ea1b-4516-a967-224ba12f5527' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-787fa5ad-edcc-4891-acb3-c8b59a7cc570' class='xr-var-data-in' type='checkbox'><label for='data-787fa5ad-edcc-4891-acb3-c8b59a7cc570' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
      dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b02a0448-aedf-4145-89c5-9127831d9bf7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b02a0448-aedf-4145-89c5-9127831d9bf7' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>river_names</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>|S46</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1fd465a6-df75-4d9e-996a-0dc4371a2651' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1fd465a6-df75-4d9e-996a-0dc4371a2651' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d917949-7b82-4074-b548-028ddf31d6e3' class='xr-var-data-in' type='checkbox'><label for='data-8d917949-7b82-4074-b548-028ddf31d6e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River Names</dd><dt><span>units :</span></dt><dd>char*46</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=|S46]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Xposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-445a61d0-4805-4064-98e4-328a4828d439' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-445a61d0-4805-4064-98e4-328a4828d439' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fc7637e-ef30-422b-a797-0bcce3d7e605' class='xr-var-data-in' type='checkbox'><label for='data-5fc7637e-ef30-422b-a797-0bcce3d7e605' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river XI-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>723</dd><dt><span>field :</span></dt><dd>river_Xposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Eposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-23e5e281-72b4-4311-8604-18c7fd70ddc5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-23e5e281-72b4-4311-8604-18c7fd70ddc5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96341fb1-c195-45a1-b9c3-a1f987ed76e7' class='xr-var-data-in' type='checkbox'><label for='data-96341fb1-c195-45a1-b9c3-a1f987ed76e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river ETA-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>1043</dd><dt><span>field :</span></dt><dd>river_Eposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_direction</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6196741b-f600-47fa-b3f0-f374ea29d90c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6196741b-f600-47fa-b3f0-f374ea29d90c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da8d8b5f-7eda-44e3-ad1e-fe19ebbc0938' class='xr-var-data-in' type='checkbox'><label for='data-da8d8b5f-7eda-44e3-ad1e-fe19ebbc0938' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff direction</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_direction, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_flag</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2d591fd3-f21f-49f4-88c1-5e4e48dfcf30' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d591fd3-f21f-49f4-88c1-5e4e48dfcf30' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0d1282b-fa82-4b33-9889-02203d71e4a5' class='xr-var-data-in' type='checkbox'><label for='data-b0d1282b-fa82-4b33-9889-02203d71e4a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff tracer flag</dd><dt><span>option_0 :</span></dt><dd>all tracers are off</dd><dt><span>option_1 :</span></dt><dd>only temperature is on</dd><dt><span>option_2 :</span></dt><dd>only salinity is on</dd><dt><span>option_3 :</span></dt><dd>both temperature and salinity are on</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_flag, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_sign</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5217837e-ee53-4273-9968-382c0ff5b4b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5217837e-ee53-4273-9968-382c0ff5b4b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3503ff48-0adf-42f6-b9c9-cca73d1b4577' class='xr-var-data-in' type='checkbox'><label for='data-3503ff48-0adf-42f6-b9c9-cca73d1b4577' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River mass transport ambient sign</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_sign, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Vshape</span></div><div class='xr-var-dims'>(s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b9c814c3-3886-4ef1-9dfb-a6286dbabc16' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b9c814c3-3886-4ef1-9dfb-a6286dbabc16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17dbcb56-a18a-4c55-b0ee-160d0b69c074' class='xr-var-data-in' type='checkbox'><label for='data-17dbcb56-a18a-4c55-b0ee-160d0b69c074' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff mass transport vertical profile</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_Vshape, scalar</dd></dl></div><div class='xr-var-data'><pre>[1080 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-605c3749-07b9-47a4-b8a3-2fdf03bf6ea8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-605c3749-07b9-47a4-b8a3-2fdf03bf6ea8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0297a0d5-59d5-4bd2-bcfc-12e999b0509b' class='xr-var-data-in' type='checkbox'><label for='data-0297a0d5-59d5-4bd2-bcfc-12e999b0509b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff time</dd><dt><span>field :</span></dt><dd>river_time, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[80 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_transport</span></div><div class='xr-var-dims'>(time, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a9cbeeb5-1b3e-4f88-a641-d84632ad8fb9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a9cbeeb5-1b3e-4f88-a641-d84632ad8fb9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3dac6327-41ad-4439-87b3-3e786820bb0e' class='xr-var-data-in' type='checkbox'><label for='data-3dac6327-41ad-4439-87b3-3e786820bb0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff vertically integrated mass transport</dd><dt><span>units :</span></dt><dd>meter3 second-1</dd><dt><span>field :</span></dt><dd>river_transport, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[2880 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_temp</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5e23ea75-d35f-4f77-b32f-72a2bc196ec8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5e23ea75-d35f-4f77-b32f-72a2bc196ec8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f850df71-5c1c-4c52-82b6-9e536743fc0b' class='xr-var-data-in' type='checkbox'><label for='data-f850df71-5c1c-4c52-82b6-9e536743fc0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff potential temperature</dd><dt><span>units :</span></dt><dd>Celsius</dd><dt><span>field :</span></dt><dd>river_temp, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_salt</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2c4482ec-e5d8-4796-8b51-4a6b300eb809' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c4482ec-e5d8-4796-8b51-4a6b300eb809' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5745ecd7-9469-4dc0-b204-9ad212483999' class='xr-var-data-in' type='checkbox'><label for='data-5745ecd7-9469-4dc0-b204-9ad212483999' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff salinity</dd><dt><span>units :</span></dt><dd>PSU</dd><dt><span>field :</span></dt><dd>river_salt, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_pass</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-41ac3a07-5d7d-4929-bd02-d0d2080c22ef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-41ac3a07-5d7d-4929-bd02-d0d2080c22ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de7e2814-0f42-47c5-9cf0-9c76afc4d5b6' class='xr-var-data-in' type='checkbox'><label for='data-de7e2814-0f42-47c5-9cf0-9c76afc4d5b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River runoff passive tracer</dd><dt><span>units :</span></dt><dd>PPM</dd><dt><span>field :</span></dt><dd>river_pass, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-775e5ef0-45f8-4853-97ef-6a2ab7a674c0' class='xr-section-summary-in' type='checkbox'  ><label for='section-775e5ef0-45f8-4853-97ef-6a2ab7a674c0' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>river</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-85d575c8-a9f3-476c-8d1c-caed4bba732e' class='xr-index-data-in' type='checkbox'/><label for='index-85d575c8-a9f3-476c-8d1c-caed4bba732e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
            18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36],
           dtype=&#x27;int64&#x27;, name=&#x27;river&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c2d8b2c5-73d7-403f-9d79-ee0a90d18573' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c2d8b2c5-73d7-403f-9d79-ee0a90d18573' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>ROMS river forcing netCDF file</dd><dt><span>title :</span></dt><dd>ciofs River forcing netCDF file</dd><dt><span>data_source :</span></dt><dd>River discharge from USGS real time or daily mean</dd><dt><span>Temp_source :</span></dt><dd>River T from USGS real time or daily mean, Salt=0</dd><dt><span>model_grid_file :</span></dt><dd>GRID file: nos.ciofs.romsgrid.nc</dd><dt><span>output_file :</span></dt><dd>River Forcing file: nos.ciofs.river.20221216.t00z.nc</dd><dt><span>source_code :</span></dt><dd>Created using nos_ofs_create_river_ROMS.sh</dd><dt><span>history :</span></dt><dd>Created at time 00:52  12/16/2022</dd><dt><span>reference :</span></dt><dd>Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_list_file</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">stations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">))</span>
<span class="n">stations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;15276000&#39;,
 &#39;15290000&#39;,
 &#39;15271000&#39;,
 &#39;15239900&#39;,
 &#39;15281000&#39;,
 &#39;15295700&#39;,
 &#39;15239070&#39;,
 &#39;15275100&#39;,
 &#39;15266300&#39;,
 &#39;15284000&#39;,
 &#39;15292780&#39;,
 &#39;15274600&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="see-if-i-can-match-the-operational-rivers-file-example-we-have">
<h1>See if I can match the operational rivers file example we have<a class="headerlink" href="#see-if-i-can-match-the-operational-rivers-file-example-we-have" title="Permalink to this headline">#</a></h1>
<section id="read-in-existing-rivers-file-to-use">
<h2>Read in existing rivers file to use<a class="headerlink" href="#read-in-existing-rivers-file-to-use" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;nos.ciofs.river.20221216.t00z (1).nc&#39;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

<span class="c1"># copy to put new results in for comparison</span>
<span class="n">dsnew</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (river: 36, s_rho: 30, time: 80)
Coordinates:
  * river            (river) int32 1 2 3 4 5 6 7 8 9 ... 29 30 31 32 33 34 35 36
Dimensions without coordinates: s_rho, time
Data variables:
    river_names      (river) |S46 ...
    river_Xposition  (river) int32 ...
    river_Eposition  (river) int32 ...
    river_direction  (river) int32 ...
    river_flag       (river) int32 ...
    river_sign       (river) float32 ...
    river_Vshape     (s_rho, river) float32 ...
    river_time       (time) datetime64[ns] ...
    river_transport  (time, river) float32 ...
    river_temp       (time, s_rho, river) float32 ...
    river_salt       (time, s_rho, river) float32 ...
    river_pass       (time, s_rho, river) float32 ...
Attributes:
    type:             ROMS river forcing netCDF file
    title:            ciofs River forcing netCDF file
    data_source:      River discharge from USGS real time or daily mean
    Temp_source:      River T from USGS real time or daily mean, Salt=0
    model_grid_file:  GRID file: nos.ciofs.romsgrid.nc
    output_file:      River Forcing file: nos.ciofs.river.20221216.t00z.nc
    source_code:      Created using nos_ofs_create_river_ROMS.sh
    history:          Created at time 00:52  12/16/2022
    reference:        Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-09c48420-a859-4f4b-a7ce-f350882c8f19' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-09c48420-a859-4f4b-a7ce-f350882c8f19' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>river</span>: 36</li><li><span>s_rho</span>: 30</li><li><span>time</span>: 80</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-02500acd-b620-4e08-bc9f-718a5f8c7375' class='xr-section-summary-in' type='checkbox'  checked><label for='section-02500acd-b620-4e08-bc9f-718a5f8c7375' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>river</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 31 32 33 34 35 36</div><input id='attrs-136fa779-cc77-4d87-b918-b8e0b4fe8d3d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-136fa779-cc77-4d87-b918-b8e0b4fe8d3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-076181a8-7842-4697-8677-f1d136c9f076' class='xr-var-data-in' type='checkbox'><label for='data-076181a8-7842-4697-8677-f1d136c9f076' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
      dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b8618980-b732-4e42-bf6a-ee6b8c4d0e3c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b8618980-b732-4e42-bf6a-ee6b8c4d0e3c' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>river_names</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>|S46</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0e03172d-d2ce-4ebe-9a1e-3af715fa8b94' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e03172d-d2ce-4ebe-9a1e-3af715fa8b94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5c15074-e5bb-4446-86c3-435f7f776902' class='xr-var-data-in' type='checkbox'><label for='data-a5c15074-e5bb-4446-86c3-435f7f776902' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River Names</dd><dt><span>units :</span></dt><dd>char*46</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=|S46]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Xposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8f734637-5bf7-4248-a636-cf814a8cc946' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8f734637-5bf7-4248-a636-cf814a8cc946' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-358021a3-aafe-42b8-976f-46b084fa40de' class='xr-var-data-in' type='checkbox'><label for='data-358021a3-aafe-42b8-976f-46b084fa40de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river XI-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>723</dd><dt><span>field :</span></dt><dd>river_Xposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Eposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-325ddf65-5621-42f8-b1ba-ec3f97fcebb2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-325ddf65-5621-42f8-b1ba-ec3f97fcebb2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f80ca23-d1b7-428e-91a4-dfc73437a6e4' class='xr-var-data-in' type='checkbox'><label for='data-8f80ca23-d1b7-428e-91a4-dfc73437a6e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river ETA-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>1043</dd><dt><span>field :</span></dt><dd>river_Eposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_direction</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f323fe74-6d8d-4703-8821-3848118a5c83' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f323fe74-6d8d-4703-8821-3848118a5c83' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92b94f88-3501-4210-bf61-707c26b700a4' class='xr-var-data-in' type='checkbox'><label for='data-92b94f88-3501-4210-bf61-707c26b700a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff direction</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_direction, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_flag</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-248c4ba0-dfab-4d6e-bf82-b89f2dd12d87' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-248c4ba0-dfab-4d6e-bf82-b89f2dd12d87' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c52d58f9-c538-4135-8c6f-efe48dfe9d9e' class='xr-var-data-in' type='checkbox'><label for='data-c52d58f9-c538-4135-8c6f-efe48dfe9d9e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff tracer flag</dd><dt><span>option_0 :</span></dt><dd>all tracers are off</dd><dt><span>option_1 :</span></dt><dd>only temperature is on</dd><dt><span>option_2 :</span></dt><dd>only salinity is on</dd><dt><span>option_3 :</span></dt><dd>both temperature and salinity are on</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_flag, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_sign</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7d52a6fe-a8a7-4b6b-a8a6-ac5af7ee628a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7d52a6fe-a8a7-4b6b-a8a6-ac5af7ee628a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec7a7951-0253-48a6-8d7d-1f0a45d79b4f' class='xr-var-data-in' type='checkbox'><label for='data-ec7a7951-0253-48a6-8d7d-1f0a45d79b4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River mass transport ambient sign</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_sign, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Vshape</span></div><div class='xr-var-dims'>(s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5a801396-c9c9-419a-b2a7-a22eed801353' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a801396-c9c9-419a-b2a7-a22eed801353' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84178247-48d4-457f-8109-c56f413fbc88' class='xr-var-data-in' type='checkbox'><label for='data-84178247-48d4-457f-8109-c56f413fbc88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff mass transport vertical profile</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_Vshape, scalar</dd></dl></div><div class='xr-var-data'><pre>[1080 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ab2ce498-cd35-4b05-99d1-5275433e4342' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ab2ce498-cd35-4b05-99d1-5275433e4342' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b906552d-a3cf-44b0-bfe8-5fc67385b57c' class='xr-var-data-in' type='checkbox'><label for='data-b906552d-a3cf-44b0-bfe8-5fc67385b57c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff time</dd><dt><span>field :</span></dt><dd>river_time, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[80 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_transport</span></div><div class='xr-var-dims'>(time, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-245dcdd0-8eda-4d50-bb7f-a61b6e67f281' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-245dcdd0-8eda-4d50-bb7f-a61b6e67f281' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97087e2b-3e83-422a-9cf9-fe5456adf462' class='xr-var-data-in' type='checkbox'><label for='data-97087e2b-3e83-422a-9cf9-fe5456adf462' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff vertically integrated mass transport</dd><dt><span>units :</span></dt><dd>meter3 second-1</dd><dt><span>field :</span></dt><dd>river_transport, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[2880 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_temp</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b783d3a1-65d3-464f-a93c-c719c3e629f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b783d3a1-65d3-464f-a93c-c719c3e629f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb1ad2ca-904d-4138-803c-83d5b44fa9b9' class='xr-var-data-in' type='checkbox'><label for='data-bb1ad2ca-904d-4138-803c-83d5b44fa9b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff potential temperature</dd><dt><span>units :</span></dt><dd>Celsius</dd><dt><span>field :</span></dt><dd>river_temp, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_salt</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d1c968ad-ef8f-4398-a9db-feaff6d671ed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1c968ad-ef8f-4398-a9db-feaff6d671ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a02b8e48-a1c9-447d-aa61-cae015e305c8' class='xr-var-data-in' type='checkbox'><label for='data-a02b8e48-a1c9-447d-aa61-cae015e305c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff salinity</dd><dt><span>units :</span></dt><dd>PSU</dd><dt><span>field :</span></dt><dd>river_salt, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_pass</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0f5f2ff2-8bab-4892-ab84-ed2102733975' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0f5f2ff2-8bab-4892-ab84-ed2102733975' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06b369f9-77e0-42b0-977f-935a11caffdb' class='xr-var-data-in' type='checkbox'><label for='data-06b369f9-77e0-42b0-977f-935a11caffdb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River runoff passive tracer</dd><dt><span>units :</span></dt><dd>PPM</dd><dt><span>field :</span></dt><dd>river_pass, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b202c0f7-f712-4a2d-b04a-e1f341e89180' class='xr-section-summary-in' type='checkbox'  ><label for='section-b202c0f7-f712-4a2d-b04a-e1f341e89180' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>river</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a482e61d-7806-4634-94d8-56e7a71cb30b' class='xr-index-data-in' type='checkbox'/><label for='index-a482e61d-7806-4634-94d8-56e7a71cb30b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
            18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36],
           dtype=&#x27;int64&#x27;, name=&#x27;river&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b9c63c91-6faf-408b-b6d4-d5d00f6ab4a7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b9c63c91-6faf-408b-b6d4-d5d00f6ab4a7' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>ROMS river forcing netCDF file</dd><dt><span>title :</span></dt><dd>ciofs River forcing netCDF file</dd><dt><span>data_source :</span></dt><dd>River discharge from USGS real time or daily mean</dd><dt><span>Temp_source :</span></dt><dd>River T from USGS real time or daily mean, Salt=0</dd><dt><span>model_grid_file :</span></dt><dd>GRID file: nos.ciofs.romsgrid.nc</dd><dt><span>output_file :</span></dt><dd>River Forcing file: nos.ciofs.river.20221216.t00z.nc</dd><dt><span>source_code :</span></dt><dd>Created using nos_ofs_create_river_ROMS.sh</dd><dt><span>history :</span></dt><dd>Created at time 00:52  12/16/2022</dd><dt><span>reference :</span></dt><dd>Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_list_file</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">stations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">))</span>
<span class="n">stations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;15276000&#39;,
 &#39;15290000&#39;,
 &#39;15271000&#39;,
 &#39;15239900&#39;,
 &#39;15281000&#39;,
 &#39;15295700&#39;,
 &#39;15239070&#39;,
 &#39;15275100&#39;,
 &#39;15266300&#39;,
 &#39;15284000&#39;,
 &#39;15292780&#39;,
 &#39;15274600&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-river-data-from-usgs">
<h2>Get river data from USGS<a class="headerlink" href="#get-river-data-from-usgs" title="Permalink to this headline">#</a></h2>
<p>average to hourly</p>
<p>have to catch ice values</p>
<p>CIOFS dev report <a class="reference external" href="https://tidesandcurrents.noaa.gov/ofs/publications/CS_Techrpt_040_SA_CIOFS_2020.pdf">https://tidesandcurrents.noaa.gov/ofs/publications/CS_Techrpt_040_SA_CIOFS_2020.pdf</a> has two important notes:</p>
<ul class="simple">
<li><p>all water temperatures are used from Bradley river (15239070). This data is available back a decade. Before that, I will use the mean or median temperature values which I can also get from USGS.</p></li>
<li><p>the Susitna River gauge at Sunshine shut down in 2021. The language used in the report about this point is pretty confusing but I think the modeling group decided to use the same discharge rate for both Susitna river inputs (on-going station 15290000 and discontinued station 15292780), making it so that the combined total from the two rivers is twice one (which I think the report is trying to say).</p></li>
<li><p>They seem to bump temp values below 1 up to 1.</p></li>
<li><p>Also need to change ice values to 0 for discharge</p></li>
<li><p>Also need to add 0s in if data missing but instrument exists</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="s2">&quot;15275100&quot;</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">discharge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(                           00065 00065_cd   site_no
 datetime                                           
 2022-12-13 09:00:00-09:00   2.51        P  15275100
 2022-12-13 09:15:00-09:00   2.45        P  15275100
 2022-12-13 09:30:00-09:00   2.41        P  15275100
 2022-12-13 09:45:00-09:00   2.40        P  15275100
 2022-12-13 10:00:00-09:00   2.40        P  15275100
 ...                          ...      ...       ...
 2022-12-18 15:00:00-09:00   4.12        P  15275100
 2022-12-18 15:15:00-09:00   4.13        P  15275100
 2022-12-18 15:30:00-09:00   4.13        P  15275100
 2022-12-18 15:45:00-09:00   4.15        P  15275100
 2022-12-18 16:00:00-09:00   4.15        P  15275100
 
 [509 rows x 3 columns],
 &lt;dataretrieval.utils.Metadata at 0x7fe3b3d45eb0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/98f849d6dfdde381abf941125ab0ef69a2c92add4b10729e95aca73dbcb09066.png" src="_images/98f849d6dfdde381abf941125ab0ef69a2c92add4b10729e95aca73dbcb09066.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratingData</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_ratings</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;15275100&quot;</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;exsa&quot;</span><span class="p">)</span>
<span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEP</th>
      <th>SHIFT</th>
      <th>DEP</th>
      <th>STOR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.75</td>
      <td>0.11</td>
      <td>1.90</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.76</td>
      <td>0.11</td>
      <td>2.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.77</td>
      <td>0.11</td>
      <td>2.23</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.78</td>
      <td>0.11</td>
      <td>2.41</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.79</td>
      <td>0.11</td>
      <td>2.60</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>412</th>
      <td>5.87</td>
      <td>0.00</td>
      <td>454.67</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>413</th>
      <td>5.88</td>
      <td>0.00</td>
      <td>456.25</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>414</th>
      <td>5.89</td>
      <td>0.00</td>
      <td>457.83</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>415</th>
      <td>5.90</td>
      <td>0.00</td>
      <td>459.42</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>416</th>
      <td>5.91</td>
      <td>0.00</td>
      <td>461.00</td>
      <td>*</td>
    </tr>
  </tbody>
</table>
<p>417 rows Ã— 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;INDEP&quot;</span><span class="p">],</span> <span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;DEP&quot;</span><span class="p">],</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;gage height [ft]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;streamflow cubic feet per sec&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;streamflow cubic feet per sec&#39;)
</pre></div>
</div>
<img alt="_images/e2c416bfaec53a69acf9ddcd52da034f4275a3a8deb33ff518180d6f8c89056c.png" src="_images/e2c416bfaec53a69acf9ddcd52da034f4275a3a8deb33ff518180d6f8c89056c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime
2022-12-13 09:00:00-09:00    2.51
2022-12-13 09:15:00-09:00    2.45
2022-12-13 09:30:00-09:00    2.41
2022-12-13 09:45:00-09:00    2.40
2022-12-13 10:00:00-09:00    2.40
                             ... 
2022-12-18 15:00:00-09:00    4.12
2022-12-18 15:15:00-09:00    4.13
2022-12-18 15:30:00-09:00    4.13
2022-12-18 15:45:00-09:00    4.15
2022-12-18 16:00:00-09:00    4.15
Name: 00065, Length: 509, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;INDEP&quot;</span><span class="p">)[</span><span class="s2">&quot;DEP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">discharge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;00065&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INDEP
2.51     44.74
2.45     38.67
2.41     34.91
2.40     34.01
2.40     34.01
         ...  
4.12    210.42
4.13    211.62
4.13    211.62
4.15    214.03
4.15    214.03
Name: DEP, Length: 509, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># interpolate</span>
<span class="c1"># reindex DEP to </span>
<span class="n">ratingData</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;INDEP&quot;</span><span class="p">]</span><span class="c1">#[discharge[&quot;00065&quot;]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1.75
1      1.76
2      1.77
3      1.78
4      1.79
       ... 
412    5.87
413    5.88
414    5.89
415    5.90
416    5.91
Name: INDEP, Length: 417, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime
2022-12-13 09:00:00-09:00    2.51
2022-12-13 09:15:00-09:00    2.45
2022-12-13 09:30:00-09:00    2.41
2022-12-13 09:45:00-09:00    2.40
2022-12-13 10:00:00-09:00    2.40
                             ... 
2022-12-18 15:00:00-09:00    4.12
2022-12-18 15:15:00-09:00    4.13
2022-12-18 15:30:00-09:00    4.13
2022-12-18 15:45:00-09:00    4.15
2022-12-18 16:00:00-09:00    4.15
Name: 00065, Length: 509, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratingData</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;dataretrieval.utils.Metadata at 0x7fe3b3a4fbb0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>00020</th>
      <th>00020_cd</th>
      <th>site_no</th>
      <th>00060</th>
      <th>00060_cd</th>
      <th>00065</th>
      <th>00065_cd</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-12-13 09:00:00-09:00</th>
      <td>-8.1</td>
      <td>P</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.51</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-13 09:15:00-09:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.45</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-13 09:30:00-09:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.41</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-13 09:45:00-09:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.40</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-13 10:00:00-09:00</th>
      <td>-7.4</td>
      <td>P</td>
      <td>15275100</td>
      <td>34.0</td>
      <td>P</td>
      <td>2.40</td>
      <td>P</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-12-18 15:00:00-09:00</th>
      <td>-16.0</td>
      <td>P</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.12</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-18 15:15:00-09:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.13</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-18 15:30:00-09:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.13</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-18 15:45:00-09:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.15</td>
      <td>P</td>
    </tr>
    <tr>
      <th>2022-12-18 16:00:00-09:00</th>
      <td>-17.4</td>
      <td>P</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.15</td>
      <td>P</td>
    </tr>
  </tbody>
</table>
<p>509 rows Ã— 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="s2">&quot;15275100&quot;</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="p">(</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.3</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/45ab2e0a3c9caf13b1febb5d652e6f56b53339fb742f298d10ed75e65f3e9eac.png" src="_images/45ab2e0a3c9caf13b1febb5d652e6f56b53339fb742f298d10ed75e65f3e9eac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measurements1</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_discharge_measurements</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="s2">&quot;15275100&quot;</span><span class="p">)</span><span class="c1">#, start=start, end=end)</span>
<span class="n">measurements1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(    agency_cd   site_no measurement_nu       measurement_dt tz_cd  \
 0        USGS  15275100              1  1966-06-21 23:00:00  AKST   
 1        USGS  15275100              2  1966-08-26 23:00:00  AKST   
 2        USGS  15275100              3  1966-10-05 23:00:00  AKST   
 3        USGS  15275100              4  1966-11-13 23:00:00  AKST   
 4        USGS  15275100              5  1967-01-02 23:00:00  AKST   
 ..        ...       ...            ...                  ...   ...   
 606      USGS  15275100            606  2022-07-22 12:42:30  AKDT   
 607      USGS  15275100            607  2022-07-28 09:45:42  AKDT   
 608      USGS  15275100            608  2022-09-26 11:05:00  AKDT   
 609      USGS  15275100            609  2022-11-18 16:21:28  AKST   
 610      USGS  15275100            610  2023-01-30 13:04:14  AKST   
 
     q_meas_used_fg party_nm site_visit_coll_agency_cd  gage_height_va  \
 0              Yes  LSD/JDM                      USGS            1.79   
 1              Yes  D S/RLG                      USGS            1.64   
 2              Yes       LS                      USGS            1.72   
 3              Yes  RLG/LSD                      USGS             NaN   
 4              Yes  RLG/LSD                      USGS             NaN   
 ..             ...      ...                       ...             ...   
 606            Yes  BAD/SAK                      USGS            3.02   
 607            Yes  SAK/KJW                      USGS            2.51   
 608            Yes   SAKCVB                      USGS            2.70   
 609            Yes  SAK/AJM                      USGS            2.47   
 610            Yes  BAD/MER                      USGS            2.30   
 
      discharge_va measured_rating_diff  gage_va_change  gage_va_time  \
 0            32.4                 Good            0.00          0.50   
 1            25.2                 Good            0.00          0.30   
 2            29.6                 Good            0.01          0.40   
 3            14.5                 Poor             NaN           NaN   
 4            11.4                 Fair             NaN           NaN   
 ..            ...                  ...             ...           ...   
 606          98.0                 Fair            0.03          0.25   
 607          34.5                 Good            0.02          0.50   
 608          56.8                 Good            0.00          0.75   
 609          41.0                 Fair            0.00          0.75   
 610          25.8                 Good            0.00          1.00   
 
     control_type_cd discharge_cd  
 0       DebrisLight         NONE  
 1             Clear         NONE  
 2               NaN         NONE  
 3               NaN         NONE  
 4               NaN         NONE  
 ..              ...          ...  
 606     DebrisLight         NONE  
 607     DebrisLight         NONE  
 608     DebrisLight         NONE  
 609     DebrisLight         NONE  
 610           Clear         NONE  
 
 [611 rows x 15 columns],
 &lt;dataretrieval.utils.Metadata at 0x7fe3b39d3250&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measurements1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>agency_cd</th>
      <th>site_no</th>
      <th>measurement_nu</th>
      <th>measurement_dt</th>
      <th>tz_cd</th>
      <th>q_meas_used_fg</th>
      <th>party_nm</th>
      <th>site_visit_coll_agency_cd</th>
      <th>gage_height_va</th>
      <th>discharge_va</th>
      <th>measured_rating_diff</th>
      <th>gage_va_change</th>
      <th>gage_va_time</th>
      <th>control_type_cd</th>
      <th>discharge_cd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>1</td>
      <td>1966-06-21 23:00:00</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>LSD/JDM</td>
      <td>USGS</td>
      <td>1.79</td>
      <td>32.4</td>
      <td>Good</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>DebrisLight</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>2</td>
      <td>1966-08-26 23:00:00</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>D S/RLG</td>
      <td>USGS</td>
      <td>1.64</td>
      <td>25.2</td>
      <td>Good</td>
      <td>0.00</td>
      <td>0.30</td>
      <td>Clear</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>3</td>
      <td>1966-10-05 23:00:00</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>LS</td>
      <td>USGS</td>
      <td>1.72</td>
      <td>29.6</td>
      <td>Good</td>
      <td>0.01</td>
      <td>0.40</td>
      <td>NaN</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>4</td>
      <td>1966-11-13 23:00:00</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>RLG/LSD</td>
      <td>USGS</td>
      <td>NaN</td>
      <td>14.5</td>
      <td>Poor</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>5</td>
      <td>1967-01-02 23:00:00</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>RLG/LSD</td>
      <td>USGS</td>
      <td>NaN</td>
      <td>11.4</td>
      <td>Fair</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>606</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>606</td>
      <td>2022-07-22 12:42:30</td>
      <td>AKDT</td>
      <td>Yes</td>
      <td>BAD/SAK</td>
      <td>USGS</td>
      <td>3.02</td>
      <td>98.0</td>
      <td>Fair</td>
      <td>0.03</td>
      <td>0.25</td>
      <td>DebrisLight</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>607</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>607</td>
      <td>2022-07-28 09:45:42</td>
      <td>AKDT</td>
      <td>Yes</td>
      <td>SAK/KJW</td>
      <td>USGS</td>
      <td>2.51</td>
      <td>34.5</td>
      <td>Good</td>
      <td>0.02</td>
      <td>0.50</td>
      <td>DebrisLight</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>608</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>608</td>
      <td>2022-09-26 11:05:00</td>
      <td>AKDT</td>
      <td>Yes</td>
      <td>SAKCVB</td>
      <td>USGS</td>
      <td>2.70</td>
      <td>56.8</td>
      <td>Good</td>
      <td>0.00</td>
      <td>0.75</td>
      <td>DebrisLight</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>609</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>609</td>
      <td>2022-11-18 16:21:28</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>SAK/AJM</td>
      <td>USGS</td>
      <td>2.47</td>
      <td>41.0</td>
      <td>Fair</td>
      <td>0.00</td>
      <td>0.75</td>
      <td>DebrisLight</td>
      <td>NONE</td>
    </tr>
    <tr>
      <th>610</th>
      <td>USGS</td>
      <td>15275100</td>
      <td>610</td>
      <td>2023-01-30 13:04:14</td>
      <td>AKST</td>
      <td>Yes</td>
      <td>BAD/MER</td>
      <td>USGS</td>
      <td>2.30</td>
      <td>25.8</td>
      <td>Good</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>Clear</td>
      <td>NONE</td>
    </tr>
  </tbody>
</table>
<p>611 rows Ã— 15 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">stations</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="c1"># convert to UTC</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">set_levels</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># df.index.set_levels([df.index.levels[0], df.index.levels[1].tz_convert(&quot;America/Anchorage&quot;)], inplace=True)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">*</span> <span class="mf">0.3</span><span class="o">**</span><span class="mi">3</span>  <span class="c1"># convert cubic feet to cubic meter</span>

<span class="c1"># process discharge data some</span>
<span class="c1"># if discharge is -26999.973 or nan, set to 0</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">26999.973</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">dfh</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;00010&quot;</span><span class="p">,</span> <span class="s2">&quot;00060&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;site_no&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1H&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)</span>

<span class="c1"># limit to desired time range</span>
<span class="c1"># dfh = dfh.loc[(&quot;15239070&quot;, start_actual):(&quot;15295700&quot;,end_actual)]</span>
<span class="n">dfh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/mf/by34w_vj643fb7dvt5skt7p40000gn/T/ipykernel_54677/3849178722.py:3: FutureWarning: inplace is deprecated and will be removed in a future version.
  df.index.set_levels([df.index.levels[0], df.index.levels[1].tz_convert(&quot;UTC&quot;)], inplace=True)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>00010</th>
      <th>00060</th>
    </tr>
    <tr>
      <th>site_no</th>
      <th>datetime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">15239070</th>
      <th>2022-12-14 03:00:00+00:00</th>
      <td>0.000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2022-12-14 04:00:00+00:00</th>
      <td>0.000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2022-12-14 05:00:00+00:00</th>
      <td>0.000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2022-12-14 06:00:00+00:00</th>
      <td>0.000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2022-12-14 07:00:00+00:00</th>
      <td>0.000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">15295700</th>
      <th>2022-12-19 06:00:00+00:00</th>
      <td>0.850</td>
      <td>2.000025</td>
    </tr>
    <tr>
      <th>2022-12-19 07:00:00+00:00</th>
      <td>0.900</td>
      <td>1.907550</td>
    </tr>
    <tr>
      <th>2022-12-19 08:00:00+00:00</th>
      <td>1.000</td>
      <td>1.776600</td>
    </tr>
    <tr>
      <th>2022-12-19 09:00:00+00:00</th>
      <td>1.075</td>
      <td>1.744200</td>
    </tr>
    <tr>
      <th>2022-12-19 10:00:00+00:00</th>
      <td>1.100</td>
      <td>1.711800</td>
    </tr>
  </tbody>
</table>
<p>1280 rows Ã— 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">stations</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>

<span class="c1"># All stations, only discharge, with Z, then convert</span>
<span class="n">discharge_multisite</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;04024430&#39;</span><span class="p">,</span> <span class="s1">&#39;04024000&#39;</span><span class="p">],</span> <span class="n">parameterCd</span><span class="o">=</span><span class="n">parameterCode</span><span class="p">,</span>
                                  <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2013-10-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2013-10-01&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">set_levels</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">*</span> <span class="mf">0.3</span><span class="o">**</span><span class="mi">3</span> 
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">26999.973</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s2">&quot;00060&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">(</span><span class="o">-</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;15275100&quot;</span><span class="p">][:][</span><span class="s2">&quot;00060&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/mf/by34w_vj643fb7dvt5skt7p40000gn/T/ipykernel_54677/2447047859.py:7: FutureWarning: inplace is deprecated and will be removed in a future version.
  df.index.set_levels([df.index.levels[0], df.index.levels[1].tz_convert(&quot;UTC&quot;)], inplace=True)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/7dc29e7eae044bfe3bee760f106fa315c55eb0802c67668c514a0b32046d7f67.png" src="_images/7dc29e7eae044bfe3bee760f106fa315c55eb0802c67668c514a0b32046d7f67.png" />
</div>
</div>
<p>Make arrays for data for river forcing file</p>
<p>INCORPORATE NARROWER TIME WINDOW</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start_actual</span><span class="p">,</span> <span class="n">end_actual</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1H&quot;</span><span class="p">))</span>
<span class="n">nsrho</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">nrivers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">)</span>

<span class="n">river_transport</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ntimes</span><span class="p">,</span> <span class="n">nrivers</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Fill arrays</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge_multisite</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="s2">&quot;15239070&quot;</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00010&quot;</span><span class="p">,</span>
                                  <span class="n">start</span><span class="o">=</span><span class="n">start</span> <span class="o">+</span> <span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="o">+</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">957</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">discharge_multisite</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="s2">&quot;15239070&quot;</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00010&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                   <span class="n">start</span><span class="o">=</span><span class="n">start</span> <span class="o">+</span> <span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="o">+</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/dataretrieval/nwis.py:430,</span> in <span class="ni">get_iv</span><span class="nt">(start, end, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">428</span> <span class="n">start</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;startDT&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">429</span> <span class="n">end</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;endDT&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">430</span> <span class="k">return</span> <span class="n">_iv</span><span class="p">(</span><span class="n">startDT</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">endDT</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/dataretrieval/nwis.py:434,</span> in <span class="ni">_iv</span><span class="nt">(**kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span> <span class="k">def</span> <span class="nf">_iv</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">434</span>     <span class="n">response</span> <span class="o">=</span> <span class="n">query_waterservices</span><span class="p">(</span><span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span>     <span class="k">return</span> <span class="n">_read_json</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()),</span> <span class="n">_set_metadata</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/dataretrieval/nwis.py:293,</span> in <span class="ni">query_waterservices</span><span class="nt">(service, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rdb&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span> <span class="n">url</span> <span class="o">=</span> <span class="n">WATERSERVICE_URL</span> <span class="o">+</span> <span class="n">service</span>
<span class="ne">--&gt; </span><span class="mi">293</span> <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/myenv/lib/python3.8/site-packages/dataretrieval/utils.py:145,</span> in <span class="ni">query</span><span class="nt">(url, payload, delimiter)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">145</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bad Request, check that your parameters are correct. URL: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">147</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;No sites/data&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span>     <span class="k">raise</span> <span class="n">NoSitesError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>

<span class="ne">ValueError</span>: Bad Request, check that your parameters are correct. URL: https://waterservices.usgs.gov/nwis/iv?format=json&amp;startDT=2023-01-30T18%3A00%3A00.000000000ZZ&amp;endDT=2023-02-03T01%3A00%3A07.031249984ZZ&amp;sites=15239070&amp;parameterCd=00010
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge_multisite</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>00010</th>
      <th>00010_cd</th>
      <th>site_no</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-12-13 09:00:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-13 09:15:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-13 09:30:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-13 09:45:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-13 10:00:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-12-18 15:00:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-18 15:15:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-18 15:30:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-18 15:45:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
    <tr>
      <th>2022-12-18 16:00:00-09:00</th>
      <td>0.0</td>
      <td>P</td>
      <td>15239070</td>
    </tr>
  </tbody>
</table>
<p>509 rows Ã— 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Just broadcast temps from one river out. But also if temp&lt;1, set to 1.</span>

<span class="n">bradley_temp</span> <span class="o">=</span> <span class="s2">&quot;15239070&quot;</span>
<span class="n">river_temp</span> <span class="o">=</span> <span class="n">dfh</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bradley_temp</span><span class="p">][</span><span class="n">start_actual</span><span class="p">:</span><span class="n">end_actual</span><span class="p">][</span><span class="s2">&quot;00010&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">nsrho</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">nrivers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">river_temp</span><span class="p">[</span><span class="n">river_temp</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">station_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">station_list_file</span><span class="p">):</span>
    <span class="c1"># CHANGE THIS</span>
    <span class="k">if</span> <span class="n">station_file</span> <span class="o">==</span> <span class="s2">&quot;15292780&quot;</span><span class="p">:</span>  <span class="c1"># fill with 15290000</span>
        <span class="n">river_transport</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfh</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;15290000&quot;</span><span class="p">][</span><span class="n">start_actual</span><span class="p">:</span><span class="n">end_actual</span><span class="p">][</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="c1"># dfh.loc[&quot;15290000&quot;,:][&quot;00060&quot;]</span>
    <span class="k">elif</span> <span class="n">station_file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dfh</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">river_transport</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">river_transport</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfh</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">station_file</span><span class="p">][</span><span class="n">start_actual</span><span class="p">:</span><span class="n">end_actual</span><span class="p">][</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span><span class="c1"># dfh.loc[station_file,:][&quot;00060&quot;]</span>
    
    <span class="c1"># # divide by the number of cells river is represented by</span>
    <span class="c1"># river_transport[:,i] /= station_list_file.count(station_file)</span>
    
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">river_transport</span>
</pre></div>
</div>
</div>
</div>
<p>Compare their and my datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fe3735138e0&gt;
</pre></div>
</div>
<img alt="_images/f3306ac1500d73e14cd61f4d7ea1555161ec0b297c8a21ebbd2f96b0cc089405.png" src="_images/f3306ac1500d73e14cd61f4d7ea1555161ec0b297c8a21ebbd2f96b0cc089405.png" />
</div>
</div>
<p>There are only 2 non-zero rivers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fe37359c7f0&gt;
</pre></div>
</div>
<img alt="_images/df1b74f9ace5aa0757daf74d371e2a7e3f0e6a677fa3b6070b27b0e086a22dd5.png" src="_images/df1b74f9ace5aa0757daf74d371e2a7e3f0e6a677fa3b6070b27b0e086a22dd5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe382d1c7f0&gt;]
</pre></div>
</div>
<img alt="_images/aaf9c44d3d48c1e8b30ada5a0bb0b7f8100aa610d407cd1245c7c34f70751e78.png" src="_images/aaf9c44d3d48c1e8b30ada5a0bb0b7f8100aa610d407cd1245c7c34f70751e78.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_time&quot;</span><span class="p">][</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.datetime64(&#39;2022-12-15T13:59:52.968750016&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_list_file</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;15275100&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=</span><span class="mi">7</span>
<span class="c1"># ds[&quot;river_time&quot;].plot()</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe3745735b0&gt;]
</pre></div>
</div>
<img alt="_images/5750504dc8b805c2dd883ad3df6c6cc67f3dcdf816e417809dac4b48976e58a6.png" src="_images/5750504dc8b805c2dd883ad3df6c6cc67f3dcdf816e417809dac4b48976e58a6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.96      , -0.94      , -0.96      , -0.94      , -0.94      ,
       -0.96      , -0.96      , -0.94      , -0.96      , -0.96      ,
       -0.96      , -0.96      , -0.96      , -0.96      , -0.96      ,
       -0.99      , -0.99      , -1.01      , -1.04      , -1.04      ,
       -1.1       , -1.07      , -1.07      , -0.99      , -0.99      ,
       -0.96      , -0.96      , -0.96      , -0.96      , -0.94      ,
       -0.94047445, -0.9411083 , -0.9417384 , -0.94237226, -0.94300616,
       -0.9436363 , -0.94427013, -0.94490397, -0.9455341 , -0.94616795,
       -0.9468018 , -0.9474319 , -0.9480658 , -0.94869965, -0.9493298 ,
       -0.9499636 , -0.95059747, -0.9512276 , -0.95186144, -0.9524953 ,
       -0.9531254 , -0.9537593 , -0.95439315, -0.9550233 , -0.9556571 ,
       -0.95629096, -0.9569211 , -0.95755494, -0.9581888 , -0.9588189 ,
       -0.9594528 , -0.96008664, -0.9607168 , -0.9613506 , -0.96198446,
       -0.9626146 , -0.96324843, -0.9638823 , -0.96451247, -0.9651463 ,
       -0.96578014, -0.9664103 , -0.9670441 , -0.96767795, -0.9683081 ,
       -0.9689419 , -0.9695758 , -0.97020596, -0.9708398 , -0.97147363],
      dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsnew</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.918   , -0.90585 , -0.899775, -0.8937  , -0.440775, -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.      , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.2133  , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.      , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.209925, -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.      , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.207225, -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.      , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.205875, -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.      , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.204525, -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.      , -0.      ,
       -0.      , -0.      , -0.      , -0.      , -0.203175, -0.      ,
       -0.      , -0.      ], dtype=float32)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="how-to-fill-in-missing-station-data">
<h1>How to fill in missing station data<a class="headerlink" href="#how-to-fill-in-missing-station-data" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>15276000</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;15276000&#39;,
 &#39;15290000&#39;,
 &#39;15271000&#39;,
 &#39;15239900&#39;,
 &#39;15281000&#39;,
 &#39;15295700&#39;,
 &#39;15239070&#39;,
 &#39;15275100&#39;,
 &#39;15266300&#39;,
 &#39;15284000&#39;,
 &#39;15292780&#39;,
 &#39;15274600&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_list_file</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;15295700&#39;,
 &#39;15239070&#39;,
 &#39;15239900&#39;,
 &#39;15266300&#39;,
 &#39;15266300&#39;,
 &#39;15271000&#39;,
 &#39;15274600&#39;,
 &#39;15275100&#39;,
 &#39;15276000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15281000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15284000&#39;,
 &#39;15290000&#39;,
 &#39;15290000&#39;,
 &#39;15292780&#39;,
 &#39;15292780&#39;,
 &#39;15292780&#39;,
 &#39;15292780&#39;,
 &#39;15292780&#39;]
</pre></div>
</div>
</div>
</div>
<p>discharge 00060 equals -26999.973 in dfh if ice or nan
USGS dashboard shows geographic relationship between stations: <a class="reference external" href="https://dashboard.waterdata.usgs.gov/app/nwd/en/?region=lower48&amp;amp;aoi=default">https://dashboard.waterdata.usgs.gov/app/nwd/en/?region=lower48&amp;aoi=default</a></p>
<p>15266300 has water temps, transport is ice. discharge covers all years, temp started in 2014 (NEED REPLACEMENT)</p>
<p>15239070 has water temps and transport. discharge covers all years, temp started in 2010. (NEED REPLACEMENT)</p>
<p>15276000 has temp, transport is ice. discharge covers all years, temp started in 2014</p>
<p>15290000 has temp, transport is ice. discharge covers all years, temp started in 2014</p>
<p>15281000 data missing. Discharge started in 2001 (NEED REPLACEMENT), no temp
possible replacements
15284000 discharge available full time, temp started in 2015
15283700 discharge started in 1999, temp started in 2013
-check correlation of discharge between station and replacement station, use annual mean temp</p>
<p>15271000 temps are nan (use temp from 15258000) and transport is ice. discharge covers all years, temp never available.
replacement station 15258000, temp available starting in 2007</p>
<p>15274600 temps are missing (WHAT TO USE TO REPLACE?) and transport is ice. discharge covers all years, temp is never available.</p>
<p>15292780 is completely missing â€” stopped in 2021. Discharge available 2011-2021, temp available 2012 to 2015 so need a replacement outside those years</p>
<section id="id1">
<h2>15266300<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>Use annual mean for temp for missing data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15266300&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2015-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/fe86e66747246ed558c86b313715e914cad63203e604ee3a41bcbb95c1ccc247.png" src="_images/fe86e66747246ed558c86b313715e914cad63203e604ee3a41bcbb95c1ccc247.png" />
</div>
</div>
</section>
<section id="id2">
<h2>15239070<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the parameters needed to retrieve data</span>
<span class="n">siteNumber</span> <span class="o">=</span> <span class="s2">&quot;15239070&quot;</span>
<span class="n">parameterCode</span> <span class="o">=</span> <span class="s2">&quot;00010&quot;</span> <span class="c1"># &quot;00060&quot; # Discharge</span>

<span class="c1"># Retrieve the statistics</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">siteNumber</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="n">parameterCode</span><span class="p">,</span> <span class="n">statReportType</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
<span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">][[</span><span class="s2">&quot;mean_va&quot;</span><span class="p">,</span> <span class="s2">&quot;p50_va&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># USE MEAN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="_images/071d19509adba9134fd88ec933c6b42c4ea784528c6d5dfd91598fc08668e9e0.png" src="_images/071d19509adba9134fd88ec933c6b42c4ea784528c6d5dfd91598fc08668e9e0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15239070&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2011-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/29c48ab19350488b124156d7d939662070ed30c89ecc97732272808bcff67db8.png" src="_images/29c48ab19350488b124156d7d939662070ed30c89ecc97732272808bcff67db8.png" />
</div>
</div>
</section>
<section id="id3">
<h2>15276000<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15276000&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2015-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/8b239e91153357db7d51d4689a63b4bd8003cf0f2dcea200e4f4185d0211dc2d.png" src="_images/8b239e91153357db7d51d4689a63b4bd8003cf0f2dcea200e4f4185d0211dc2d.png" />
</div>
</div>
</section>
<section id="id4">
<h2>15290000<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15290000&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2015-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/311ae6477fce5f9badff879c38a6218b08ed6b19a329fff6016f57d33fc27aab.png" src="_images/311ae6477fce5f9badff879c38a6218b08ed6b19a329fff6016f57d33fc27aab.png" />
</div>
</div>
</section>
<section id="id5">
<h2>15281000<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h2>
<p>15281000 data missing. Discharge started in 2001 (NEED REPLACEMENT), no temp
possible replacements
15284000 discharge available full time, temp started in 2015
15283700 discharge started in 1999, temp started in 2013
-check correlation of discharge between station and replacement station, use annual mean temp</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15281000&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2002-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15284000&quot;</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;00060_Mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;2021&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;00060_Mean&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;2021&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="c1"># df.groupby(df.index.day_of_year).mean(&quot;numeric_only&quot;)[[&quot;00010_Maximum&quot;, &quot;00010_Minimum&quot;, &quot;00010_Mean&quot;]].plot()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/1db1dcd754d323adab1f15517e655abcf6eb5b08cdf48bfff881023a95e57599.png" src="_images/1db1dcd754d323adab1f15517e655abcf6eb5b08cdf48bfff881023a95e57599.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2016&quot;</span><span class="p">:]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2016&quot;</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/eb8e22f1e4e9810706fa1c84f668fca165cf9d0994ca8967c01522321080e709.png" src="_images/eb8e22f1e4e9810706fa1c84f668fca165cf9d0994ca8967c01522321080e709.png" />
</div>
</div>
</section>
<section id="id6">
<h2>15271000<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h2>
<p>15271000 temps are nan (use temp from 15258000) and transport is ice. discharge covers all years, temp never available.
replacement station 15258000, temp available starting in 2007</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># replacement station</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15258000&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2008-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/f4a905057512e1b265763f37a75e714f700f5abda924474f1d0352de66a91d85.png" src="_images/f4a905057512e1b265763f37a75e714f700f5abda924474f1d0352de66a91d85.png" />
</div>
</div>
</section>
<section id="id7">
<h2>15274600<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h2>
<p>15274600 temps are missing (WHAT TO USE TO REPLACE?) and transport is ice. discharge covers all years, temp is never available.
replacement station 15276000 has temp since 2014</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># replacement station</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15276000&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2015-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/8b239e91153357db7d51d4689a63b4bd8003cf0f2dcea200e4f4185d0211dc2d.png" src="_images/8b239e91153357db7d51d4689a63b4bd8003cf0f2dcea200e4f4185d0211dc2d.png" />
</div>
</div>
</section>
<section id="id8">
<h2>15292780<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h2>
<p>15292780 is completely missing â€” stopped in 2021. Discharge available 2011-2021, temp available 2012 to 2015 so need a replacement outside those years</p>
<p>Another station is available with discharge for all years and temp since 2013: 15292700</p>
<p>Another station is available with discharge for all years and no temp: 15292000</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15292780&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2012-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-12-31&quot;</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15292700&quot;</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;00060_Mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;00060_Mean&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="c1"># df.groupby(df.index.day_of_year).mean(&quot;numeric_only&quot;)[[&quot;00010_Maximum&quot;, &quot;00010_Minimum&quot;, &quot;00010_Mean&quot;]].plot()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/28a4080a7b75b9859ac44d9808289e355e61f08c6a9e003a2a20fa122033a7fb.png" src="_images/28a4080a7b75b9859ac44d9808289e355e61f08c6a9e003a2a20fa122033a7fb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># study to decide how to handle missing data</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15292780&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2012-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-12-31&quot;</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15292000&quot;</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;00060_Mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;00060_Mean&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">2.5</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="c1"># df.groupby(df.index.day_of_year).mean(&quot;numeric_only&quot;)[[&quot;00010_Maximum&quot;, &quot;00010_Minimum&quot;, &quot;00010_Mean&quot;]].plot()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/f441b6478e288daa8d4b048b4951895b573289a7f5e7764435603f8ea35b08e2.png" src="_images/f441b6478e288daa8d4b048b4951895b573289a7f5e7764435603f8ea35b08e2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># replacement station</span>
<span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15292700&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2014-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2022-12-31&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day_of_year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;numeric_only&quot;</span><span class="p">)[[</span><span class="s2">&quot;00010_Maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Minimum&quot;</span><span class="p">,</span> <span class="s2">&quot;00010_Mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/be251878c43ab6a985dc75b5e28b761459c451a5b5f800f22f01d65fb064cc84.png" src="_images/be251878c43ab6a985dc75b5e28b761459c451a5b5f800f22f01d65fb064cc84.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="how-often-is-gage-data-available-but-not-discharge-data">
<h1>How often is gage data available but not discharge data<a class="headerlink" href="#how-often-is-gage-data-available-but-not-discharge-data" title="Permalink to this headline">#</a></h1>
<p>Due to ice or other instrument malfunction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1998-1-1&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;2020-1-1&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15275100&quot;</span>
<span class="n">discharge3</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span><span class="s2">&quot;00065&quot;</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">discharge3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>00060</th>
      <th>00060_cd</th>
      <th>site_no</th>
      <th>00065</th>
      <th>00065_cd</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1998-10-01T00:00:00.000-08:00</th>
      <td>20.0</td>
      <td>A, [91]</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1998-10-01T00:15:00.000-08:00</th>
      <td>12.0</td>
      <td>A, [91]</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1998-10-01T00:30:00.000-08:00</th>
      <td>12.0</td>
      <td>A, [91]</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1998-10-01T00:45:00.000-08:00</th>
      <td>12.0</td>
      <td>A, [91]</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1998-10-01T01:00:00.000-08:00</th>
      <td>12.0</td>
      <td>A, [91]</td>
      <td>15275100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020-01-01T22:45:00.000-09:00</th>
      <td>28.7</td>
      <td>A</td>
      <td>15275100</td>
      <td>2.49</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-01-01T23:00:00.000-09:00</th>
      <td>28.7</td>
      <td>A</td>
      <td>15275100</td>
      <td>2.49</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-01-01T23:15:00.000-09:00</th>
      <td>28.2</td>
      <td>A</td>
      <td>15275100</td>
      <td>2.48</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-01-01T23:30:00.000-09:00</th>
      <td>27.7</td>
      <td>A</td>
      <td>15275100</td>
      <td>2.47</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-01-01T23:45:00.000-09:00</th>
      <td>26.7</td>
      <td>A</td>
      <td>15275100</td>
      <td>2.45</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>552627 rows Ã— 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge2</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span><span class="s2">&quot;00065&quot;</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge3</span><span class="p">[</span><span class="s2">&quot;2016&quot;</span><span class="p">:</span><span class="s2">&quot;2020&quot;</span><span class="p">][[</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span><span class="s2">&quot;00065&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">secondary_y</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/26ee16ffbb2117e8cee10cffa32172404b4970cd18d915a204ac1bfc432a4c69.png" src="_images/26ee16ffbb2117e8cee10cffa32172404b4970cd18d915a204ac1bfc432a4c69.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station</span> <span class="o">=</span> <span class="s2">&quot;15295700&quot;</span>
<span class="n">discharge</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">gage</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gage</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">],</span> <span class="n">discharge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;1998&quot;</span><span class="p">:</span><span class="s2">&quot;2000&quot;</span><span class="p">,</span><span class="s2">&quot;00060&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(datetime
 2007-10-01T01:00:00.000-08:00    1.51
 2007-10-01T01:15:00.000-08:00    1.49
 2007-10-01T01:30:00.000-08:00    1.50
 2007-10-01T01:45:00.000-08:00    1.49
 2007-10-01T02:00:00.000-08:00    1.48
                                  ... 
 2020-01-01T22:45:00.000-09:00    1.42
 2020-01-01T23:00:00.000-09:00    1.43
 2020-01-01T23:15:00.000-09:00    1.43
 2020-01-01T23:30:00.000-09:00    1.42
 2020-01-01T23:45:00.000-09:00    1.42
 Name: 00065, Length: 387896, dtype: float64,
 datetime
 1998-01-01T00:00:00.000-09:00     64.0
 1998-01-01T00:15:00.000-09:00     64.0
 1998-01-01T00:30:00.000-09:00     64.0
 1998-01-01T00:45:00.000-09:00     64.0
 1998-01-01T01:00:00.000-09:00     67.0
                                  ...  
 1999-12-31T22:45:00.000-09:00    126.0
 1999-12-31T23:00:00.000-09:00    124.0
 1999-12-31T23:15:00.000-09:00    124.0
 1999-12-31T23:30:00.000-09:00    124.0
 1999-12-31T23:45:00.000-09:00    126.0
 Name: 00060, Length: 69976, dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>



<span class="c1"># ax.set_xlim(pd.Timestamp(&quot;1998-1-1&quot;),pd.Timestamp(&quot;2020-1-1&quot;))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/556de92d6c162d09f5cfc14cbdd08a8edf791c271f136d6931220471fd8555ef.png" src="_images/556de92d6c162d09f5cfc14cbdd08a8edf791c271f136d6931220471fd8555ef.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gage</span><span class="p">[</span><span class="s2">&quot;00065&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/d3a0b969331b7e63c6d96b5494ab4ed7b3a61c5317fc575cae4c53ae2a60c47c.png" src="_images/d3a0b969331b7e63c6d96b5494ab4ed7b3a61c5317fc575cae4c53ae2a60c47c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge2</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_iv</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span><span class="s2">&quot;00065&quot;</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge2</span><span class="p">[</span><span class="s2">&quot;2017&quot;</span><span class="p">:</span><span class="s2">&quot;2020&quot;</span><span class="p">][[</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span><span class="s2">&quot;00065&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">secondary_y</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/e0696a3a724a6e5b8ce9d9e3d2deb21d88bacffcde39a19a7eb93aa893a30d4b.png" src="_images/e0696a3a724a6e5b8ce9d9e3d2deb21d88bacffcde39a19a7eb93aa893a30d4b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discharge2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;00060&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;00065&#39;&gt;
</pre></div>
</div>
<img alt="_images/1104ec1cbfcddf919124890c9ba4b5484a508e4ae3041b103148b4a97201c9ed.png" src="_images/1104ec1cbfcddf919124890c9ba4b5484a508e4ae3041b103148b4a97201c9ed.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="look-at-other-river-forcing-example-file-to-make-sure-assumptions-hold-up">
<h1>Look at other river forcing example file to make sure assumptions hold up<a class="headerlink" href="#look-at-other-river-forcing-example-file-to-make-sure-assumptions-hold-up" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;nos.ciofs.river.20230201.t00z.nc&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (river: 36, s_rho: 30, time: 80)
Coordinates:
  * river            (river) int32 1 2 3 4 5 6 7 8 9 ... 29 30 31 32 33 34 35 36
Dimensions without coordinates: s_rho, time
Data variables:
    river_names      (river) |S46 ...
    river_Xposition  (river) int32 ...
    river_Eposition  (river) int32 ...
    river_direction  (river) int32 ...
    river_flag       (river) int32 ...
    river_sign       (river) float32 ...
    river_Vshape     (s_rho, river) float32 ...
    river_time       (time) datetime64[ns] ...
    river_transport  (time, river) float32 ...
    river_temp       (time, s_rho, river) float32 ...
    river_salt       (time, s_rho, river) float32 ...
    river_pass       (time, s_rho, river) float32 ...
Attributes:
    type:             ROMS river forcing netCDF file
    title:            ciofs River forcing netCDF file
    data_source:      River discharge from USGS real time or daily mean
    Temp_source:      River T from USGS real time or daily mean, Salt=0
    model_grid_file:  GRID file: nos.ciofs.romsgrid.nc
    output_file:      River Forcing file: nos.ciofs.river.20230201.t00z.nc
    source_code:      Created using nos_ofs_create_river_ROMS.sh
    history:          Created at time 00:51  02/01/2023
    reference:        Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c1f5d551-84ca-40dd-afbf-3b46ecfe872b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c1f5d551-84ca-40dd-afbf-3b46ecfe872b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>river</span>: 36</li><li><span>s_rho</span>: 30</li><li><span>time</span>: 80</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7faa07c6-d6b4-4daf-bf24-13215fc3a68a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7faa07c6-d6b4-4daf-bf24-13215fc3a68a' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>river</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 31 32 33 34 35 36</div><input id='attrs-bc90ab1a-c647-4482-a2d2-d521c99d1368' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc90ab1a-c647-4482-a2d2-d521c99d1368' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98f9ae9e-c485-437b-bb52-72ede0f7b80e' class='xr-var-data-in' type='checkbox'><label for='data-98f9ae9e-c485-437b-bb52-72ede0f7b80e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
      dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-940b1378-228d-4015-b29e-3063dad9462e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-940b1378-228d-4015-b29e-3063dad9462e' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>river_names</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>|S46</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0a2b1ba3-1b79-4088-85cd-bfabaf694b04' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0a2b1ba3-1b79-4088-85cd-bfabaf694b04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d1e62e5-abeb-4028-ad5f-3de73c62bc7f' class='xr-var-data-in' type='checkbox'><label for='data-6d1e62e5-abeb-4028-ad5f-3de73c62bc7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River Names</dd><dt><span>units :</span></dt><dd>char*46</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=|S46]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Xposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-56fa8bd6-4d0d-4234-945d-b0dbbb30754e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-56fa8bd6-4d0d-4234-945d-b0dbbb30754e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d6038a4-7a7a-4b8b-abd8-788baeaf7750' class='xr-var-data-in' type='checkbox'><label for='data-3d6038a4-7a7a-4b8b-abd8-788baeaf7750' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river XI-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>723</dd><dt><span>field :</span></dt><dd>river_Xposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Eposition</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d22be035-7ea3-4ace-b78d-59f1ab83a4c4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d22be035-7ea3-4ace-b78d-59f1ab83a4c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-969e1134-6dc4-4804-bf33-29ac3ba8f757' class='xr-var-data-in' type='checkbox'><label for='data-969e1134-6dc4-4804-bf33-29ac3ba8f757' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river ETA-position at RHO-points</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>1043</dd><dt><span>field :</span></dt><dd>river_Eposition, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_direction</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-52e2e6e6-d02a-4482-b5d9-1d554de2e3bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-52e2e6e6-d02a-4482-b5d9-1d554de2e3bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70f77bd7-02d0-4014-a382-084f6c23921a' class='xr-var-data-in' type='checkbox'><label for='data-70f77bd7-02d0-4014-a382-084f6c23921a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff direction</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_direction, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_flag</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-31e1cf8b-3b76-487f-b966-ce56270682f8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-31e1cf8b-3b76-487f-b966-ce56270682f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a28c70a-b616-49b3-8bcd-b7274d079df2' class='xr-var-data-in' type='checkbox'><label for='data-3a28c70a-b616-49b3-8bcd-b7274d079df2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff tracer flag</dd><dt><span>option_0 :</span></dt><dd>all tracers are off</dd><dt><span>option_1 :</span></dt><dd>only temperature is on</dd><dt><span>option_2 :</span></dt><dd>only salinity is on</dd><dt><span>option_3 :</span></dt><dd>both temperature and salinity are on</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_flag, scalar</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_sign</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2e161833-d1ca-439d-8104-6655ae93967b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e161833-d1ca-439d-8104-6655ae93967b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f47feb17-750f-4624-92c5-7a0c62033d9a' class='xr-var-data-in' type='checkbox'><label for='data-f47feb17-750f-4624-92c5-7a0c62033d9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River mass transport ambient sign</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_sign, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[36 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_Vshape</span></div><div class='xr-var-dims'>(s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7b325daa-70a5-4ca8-a977-e48604476e3c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7b325daa-70a5-4ca8-a977-e48604476e3c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-287d3b72-c97f-48a9-b2aa-c0fb01718cde' class='xr-var-data-in' type='checkbox'><label for='data-287d3b72-c97f-48a9-b2aa-c0fb01718cde' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff mass transport vertical profile</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_Vshape, scalar</dd></dl></div><div class='xr-var-data'><pre>[1080 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8cbc4059-def3-4936-a793-fcfbf12dcd49' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8cbc4059-def3-4936-a793-fcfbf12dcd49' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6624a64f-215b-4508-8b1c-307f0fe59f68' class='xr-var-data-in' type='checkbox'><label for='data-6624a64f-215b-4508-8b1c-307f0fe59f68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff time</dd><dt><span>field :</span></dt><dd>river_time, scalar, series</dd></dl></div><div class='xr-var-data'><pre>[80 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_transport</span></div><div class='xr-var-dims'>(time, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0c621f6f-1ad3-46c6-850e-075bf81f983d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c621f6f-1ad3-46c6-850e-075bf81f983d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc33410e-6f9f-4397-8923-588d6f068fe0' class='xr-var-data-in' type='checkbox'><label for='data-bc33410e-6f9f-4397-8923-588d6f068fe0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff vertically integrated mass transport</dd><dt><span>units :</span></dt><dd>meter3 second-1</dd><dt><span>field :</span></dt><dd>river_transport, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[2880 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_temp</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d1d5e083-b1e4-4cc9-b924-4c5c5dee70af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1d5e083-b1e4-4cc9-b924-4c5c5dee70af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ae1f7c9-b530-4d52-ba37-23a5c9912e40' class='xr-var-data-in' type='checkbox'><label for='data-2ae1f7c9-b530-4d52-ba37-23a5c9912e40' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff potential temperature</dd><dt><span>units :</span></dt><dd>Celsius</dd><dt><span>field :</span></dt><dd>river_temp, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_salt</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5c6f0c1e-148f-454c-885a-c45c16f84fa4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5c6f0c1e-148f-454c-885a-c45c16f84fa4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-001a1c22-c2cb-4a4e-b219-77f8344cbb3f' class='xr-var-data-in' type='checkbox'><label for='data-001a1c22-c2cb-4a4e-b219-77f8344cbb3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff salinity</dd><dt><span>units :</span></dt><dd>PSU</dd><dt><span>field :</span></dt><dd>river_salt, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>river_pass</span></div><div class='xr-var-dims'>(time, s_rho, river)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2b046573-7790-43b3-ace2-665895459e06' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2b046573-7790-43b3-ace2-665895459e06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48891558-2755-45a6-a0d1-b34503ce449d' class='xr-var-data-in' type='checkbox'><label for='data-48891558-2755-45a6-a0d1-b34503ce449d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River runoff passive tracer</dd><dt><span>units :</span></dt><dd>PPM</dd><dt><span>field :</span></dt><dd>river_pass, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div><div class='xr-var-data'><pre>[86400 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7d0822b-3f44-4025-83db-2a7fc17c8a19' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7d0822b-3f44-4025-83db-2a7fc17c8a19' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>river</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-efc6fea1-9240-4daf-a36e-61ef0b15f16f' class='xr-index-data-in' type='checkbox'/><label for='index-efc6fea1-9240-4daf-a36e-61ef0b15f16f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
            18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36],
           dtype=&#x27;int64&#x27;, name=&#x27;river&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ec0b8597-fe01-475b-be5b-7f1f228cd278' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ec0b8597-fe01-475b-be5b-7f1f228cd278' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>type :</span></dt><dd>ROMS river forcing netCDF file</dd><dt><span>title :</span></dt><dd>ciofs River forcing netCDF file</dd><dt><span>data_source :</span></dt><dd>River discharge from USGS real time or daily mean</dd><dt><span>Temp_source :</span></dt><dd>River T from USGS real time or daily mean, Salt=0</dd><dt><span>model_grid_file :</span></dt><dd>GRID file: nos.ciofs.romsgrid.nc</dd><dt><span>output_file :</span></dt><dd>River Forcing file: nos.ciofs.river.20230201.t00z.nc</dd><dt><span>source_code :</span></dt><dd>Created using nos_ofs_create_river_ROMS.sh</dd><dt><span>history :</span></dt><dd>Created at time 00:51  02/01/2023</dd><dt><span>reference :</span></dt><dd>Created by Aijun Zhang, OD/CO-OPS/NOS/NOAA</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_transport&quot;</span><span class="p">][:,</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;river_transport&#x27; (time: 80)&gt;
array([-0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.], dtype=float32)
Coordinates:
    river    int32 21
Dimensions without coordinates: time
Attributes:
    long_name:  river runoff vertically integrated mass transport
    units:      meter3 second-1
    field:      river_transport, scalar, series
    time:       river_time</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'river_transport'</div><ul class='xr-dim-list'><li><span>time</span>: 80</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-43d00d0c-9dcb-4d33-8fb9-35933ce604b4' class='xr-array-in' type='checkbox' checked><label for='section-43d00d0c-9dcb-4d33-8fb9-35933ce604b4' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 ... -0.0 -0.0 -0.0 -0.0 -0.0 -0.0</span></div><div class='xr-array-data'><pre>array([-0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.,
       -0., -0., -0., -0., -0., -0., -0., -0., -0., -0.], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-6952f031-ab46-443e-b033-2fe315fe82c4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6952f031-ab46-443e-b033-2fe315fe82c4' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>river</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>21</div><input id='attrs-b2a78e03-93b6-4b2c-8e79-bb5b4fb1bf3d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2a78e03-93b6-4b2c-8e79-bb5b4fb1bf3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e132fce3-3477-4c16-b792-ce43800cc157' class='xr-var-data-in' type='checkbox'><label for='data-e132fce3-3477-4c16-b792-ce43800cc157' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array(21, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ea2abbbf-1d5a-4ac6-aff9-6f64b8ec5061' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ea2abbbf-1d5a-4ac6-aff9-6f64b8ec5061' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-ef5d71f9-1ea3-4bbb-b54f-148a9f604e26' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ef5d71f9-1ea3-4bbb-b54f-148a9f604e26' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff vertically integrated mass transport</dd><dt><span>units :</span></dt><dd>meter3 second-1</dd><dt><span>field :</span></dt><dd>river_transport, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_temp&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;river_temp&#x27; (time: 80)&gt;
array([1.300006, 1.300006, 1.300006, 1.400006, 1.400006, 1.500006, 1.500006,
       1.500006, 1.500006, 1.500006, 1.500006, 1.500006, 1.500006, 1.400006,
       1.400006, 1.300006, 1.300006, 1.200006, 1.100006, 1.100006, 1.100006,
       1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006,
       1.000006, 1.100006, 1.100006, 1.104731, 1.109429, 1.114154, 1.118879,
       1.123576, 1.128302, 1.133027, 1.137724, 1.142449, 1.147174, 1.151872,
       1.156597, 1.161322, 1.166019, 1.170745, 1.17547 , 1.180167, 1.184892,
       1.189617, 1.194315, 1.19904 , 1.203765, 1.208462, 1.213188, 1.217913,
       1.22261 , 1.227335, 1.23206 , 1.236758, 1.241483, 1.246208, 1.250906,
       1.255631, 1.260356, 1.265053, 1.269778, 1.274503, 1.279201, 1.283926,
       1.288651, 1.293349, 1.298074, 1.302799, 1.307496, 1.312221, 1.316947,
       1.321644, 1.326369, 1.331094], dtype=float32)
Coordinates:
    river    int32 36
Dimensions without coordinates: time
Attributes:
    long_name:  river runoff potential temperature
    units:      Celsius
    field:      river_temp, scalar, series
    time:       river_time</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'river_temp'</div><ul class='xr-dim-list'><li><span>time</span>: 80</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-10aaf776-015e-4034-a9e7-23501cb12a60' class='xr-array-in' type='checkbox' checked><label for='section-10aaf776-015e-4034-a9e7-23501cb12a60' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.3 1.3 1.3 1.4 1.4 1.5 1.5 ... 1.307 1.312 1.317 1.322 1.326 1.331</span></div><div class='xr-array-data'><pre>array([1.300006, 1.300006, 1.300006, 1.400006, 1.400006, 1.500006, 1.500006,
       1.500006, 1.500006, 1.500006, 1.500006, 1.500006, 1.500006, 1.400006,
       1.400006, 1.300006, 1.300006, 1.200006, 1.100006, 1.100006, 1.100006,
       1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006,
       1.000006, 1.100006, 1.100006, 1.104731, 1.109429, 1.114154, 1.118879,
       1.123576, 1.128302, 1.133027, 1.137724, 1.142449, 1.147174, 1.151872,
       1.156597, 1.161322, 1.166019, 1.170745, 1.17547 , 1.180167, 1.184892,
       1.189617, 1.194315, 1.19904 , 1.203765, 1.208462, 1.213188, 1.217913,
       1.22261 , 1.227335, 1.23206 , 1.236758, 1.241483, 1.246208, 1.250906,
       1.255631, 1.260356, 1.265053, 1.269778, 1.274503, 1.279201, 1.283926,
       1.288651, 1.293349, 1.298074, 1.302799, 1.307496, 1.312221, 1.316947,
       1.321644, 1.326369, 1.331094], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4c38ee98-5887-4eb9-bb57-0a6009e810b4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4c38ee98-5887-4eb9-bb57-0a6009e810b4' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>river</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>36</div><input id='attrs-8aa1b2d1-3d7f-4417-b2af-c79827592657' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8aa1b2d1-3d7f-4417-b2af-c79827592657' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-afd7a0c6-c0e4-4abd-8342-2776b5713561' class='xr-var-data-in' type='checkbox'><label for='data-afd7a0c6-c0e4-4abd-8342-2776b5713561' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array(36, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-187e93d7-6336-4bc9-8651-1036d963255d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-187e93d7-6336-4bc9-8651-1036d963255d' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-641df54a-36d7-4a6b-9a9a-657619a2f1e3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-641df54a-36d7-4a6b-9a9a-657619a2f1e3' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff potential temperature</dd><dt><span>units :</span></dt><dd>Celsius</dd><dt><span>field :</span></dt><dd>river_temp, scalar, series</dd><dt><span>time :</span></dt><dd>river_time</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;river_sign&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: 'â–º';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: 'â–¼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;river_sign&#x27; (river: 36)&gt;
[36 values with dtype=float32]
Coordinates:
  * river    (river) int32 1 2 3 4 5 6 7 8 9 10 ... 28 29 30 31 32 33 34 35 36
Attributes:
    long_name:  River mass transport ambient sign
    units:      nondimensional
    field:      river_sign, scalar, series</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'river_sign'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>river</span>: 36</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-1e695ddd-df12-488c-8020-ce96f77f14af' class='xr-array-in' type='checkbox' checked><label for='section-1e695ddd-df12-488c-8020-ce96f77f14af' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[36 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-5f5047d8-a0af-4a69-a892-9777dbca5390' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5f5047d8-a0af-4a69-a892-9777dbca5390' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>river</span></div><div class='xr-var-dims'>(river)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 31 32 33 34 35 36</div><input id='attrs-2467c6cd-3b5e-4c85-aaeb-96cec01d3078' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2467c6cd-3b5e-4c85-aaeb-96cec01d3078' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-091fa0e9-4061-4237-935e-8af1c6f50422' class='xr-var-data-in' type='checkbox'><label for='data-091fa0e9-4061-4237-935e-8af1c6f50422' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>river runoff identification number</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river, scalar</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
      dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ada4a815-d002-407f-9ffc-c0525fb76662' class='xr-section-summary-in' type='checkbox'  ><label for='section-ada4a815-d002-407f-9ffc-c0525fb76662' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>river</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e69ccb90-d2d1-4adc-a51f-947fdbb24021' class='xr-index-data-in' type='checkbox'/><label for='index-e69ccb90-d2d1-4adc-a51f-947fdbb24021' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
            18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36],
           dtype=&#x27;int64&#x27;, name=&#x27;river&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-003c3325-5cc1-4db7-8084-b7f34de94c96' class='xr-section-summary-in' type='checkbox'  checked><label for='section-003c3325-5cc1-4db7-8084-b7f34de94c96' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>River mass transport ambient sign</dd><dt><span>units :</span></dt><dd>nondimensional</dd><dt><span>field :</span></dt><dd>river_sign, scalar, series</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Example for why I am rolling-mean the gage data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-with-river-files">Compare with river files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#make-example-forcing-file-for-chang">Make example forcing file for Chang</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#make-monthly-forcing-files-for-1998-and-check-them">Make monthly forcing files for 1998 and check them</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrate-using-the-rating-curve">Demonstrate using the rating curve</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-two-nonzero-rivers-later-check-the-zero-rivers-too">Check the two nonzero rivers (later check the zero rivers too)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#see-if-i-can-match-the-operational-rivers-file-example-we-have">See if I can match the operational rivers file example we have</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-existing-rivers-file-to-use">Read in existing rivers file to use</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-river-data-from-usgs">Get river data from USGS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-fill-in-missing-station-data">How to fill in missing station data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">15266300</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">15239070</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">15276000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">15290000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">15281000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">15271000</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">15274600</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">15292780</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-often-is-gage-data-available-but-not-discharge-data">How often is gage data available but not discharge data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#look-at-other-river-forcing-example-file-to-make-sure-assumptions-hold-up">Look at other river forcing example file to make sure assumptions hold up</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kristen M. Thyng
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>